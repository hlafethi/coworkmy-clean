import{k as C,o as b,r as a,j as e,C as m,a as x,e as h,f as E,b as p,B as f,I as j,n as S,g as k}from"./index-Cce3lADS.js";import{A as L,a as P}from"./alert-DqRV0alT.js";function M(){const i=C(),[l]=b(),[r,g]=a.useState(""),[c,v]=a.useState(""),[d,u]=a.useState(!1),[o,t]=a.useState(""),[w,N]=a.useState("");a.useEffect(()=>{const s=l.get("token");if(!s){t("Lien de réinitialisation invalide ou expiré");return}N(s)},[l]);const y=async s=>{if(s.preventDefault(),t(""),r!==c){t("Les mots de passe ne correspondent pas");return}if(r.length<6){t("Le mot de passe doit contenir au moins 6 caractères");return}u(!0);try{const n=await k.post("/auth/reset-password",{token:w,password:r});if(!n.success)throw new Error(n.error);alert("Mot de passe mis à jour avec succès ! Vous pouvez maintenant vous connecter."),i("/auth/login")}catch(n){console.error("Erreur:",n),t("Erreur lors de la mise à jour : "+n.message)}finally{u(!1)}};return o&&!r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs(m,{className:"w-full max-w-md",children:[e.jsxs(x,{children:[e.jsx(h,{className:"text-2xl font-bold text-red-600",children:"Erreur"}),e.jsx(E,{className:"text-gray-600",children:o})]}),e.jsx(p,{children:e.jsx(f,{onClick:()=>i("/auth/forgot-password"),className:"w-full",children:"Demander un nouveau lien"})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs(m,{className:"w-full max-w-md",children:[e.jsx(x,{children:e.jsx(h,{className:"text-2xl font-bold text-gray-800",children:"Nouveau mot de passe"})}),e.jsx(p,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nouveau mot de passe"}),e.jsx(j,{type:"password",value:r,onChange:s=>g(s.target.value),required:!0,minLength:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Confirmer le mot de passe"}),e.jsx(j,{type:"password",value:c,onChange:s=>v(s.target.value),required:!0,minLength:6})]}),o&&e.jsx(L,{variant:"destructive",children:e.jsx(P,{children:o})}),e.jsx(f,{type:"submit",disabled:d,className:"w-full",children:d?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Mise à jour..."]}):"Mettre à jour le mot de passe"})]})})]})})}export{M as default};
