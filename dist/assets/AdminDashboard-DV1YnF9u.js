import{c as ie,r as x,j as e,P as cr,h as se,y as ng,z as ag,D as Ep,E as ig,X as or,G as Cp,O as Tp,H as Rp,J as Ap,S as gs,B as P,I,m as mn,k as og,K as lg,u as k,F as ir,M as cg,C as U,a as K,e as V,f as we,b as W,n as te,N as Nt,T as _e,Q as Nr,U as Er,V as Cr,W as Tr,Y as pe,g as B,l as Bn,x as fe,Z as $e,$ as ze,a0 as Ue,a1 as Be,a2 as He,a3 as kr,a4 as Dr,a5 as ce,a6 as ge,a7 as ug,t as kp,a8 as dg,a9 as We,aa as er,ab as Dp,ac as Xl,ad as mg,ae as hg,w as Rr,o as je,af as hn,ag as Jr,ah as pg,ai as Ur,d as Pp,aj as Tl,ak as fg,al as rs,R as A,q as vr,am as Mp,an as rt,ao as vg,s as tt,ap as gg,aq as Kc,ar as xg}from"./index-DjQDvwSR.js";import{u as yg}from"./use-mobile-BvhPLi8C.js";import{S as xe}from"./skeleton-D_pKuzH4.js";import{T as bg,a as jg,b as wg,c as _g}from"./tooltip-CyVMSdfj.js";import{L as Sg}from"./log-out-C0lE14kR.js";import{U as Et,B as Ng}from"./users-ft-IAgQg.js";import{C as gr}from"./calendar-BTbjTwdc.js";import{C as Op,E as Eg}from"./external-link-SKxx8wfR.js";import{C as Xs,a as Cg,d as Tg,u as Rg,f as Yc}from"./bookingService-B8p-taOX.js";import{S as pn,u as Ag}from"./settings-CoYPsFXm.js";import{A as Ge,b as st,a as Ke}from"./alert-DPW0vZ1w.js";import{A as Pr}from"./alert-circle-CLcitMK4.js";import{B as ts,A as kg,a as Dg,b as Pg}from"./avatar-f2MVXntd.js";import{C as Ct}from"./check-circle-BfIJNlWc.js";import{A as Qs,T as mr,D as Vc,U as Mg,P as L}from"./index-Bd0Vb2Sy.js";import{U as ot}from"./user-Drh04oF-.js";import{P as xt}from"./pen-square-D0A23_H3.js";import{M as Ip}from"./map-pin-e2Mj8Zsh.js";import{S as Og}from"./shield-Bcu378EH.js";import{a as Z,b as G,c as H,d as Y,e as ee,F as Ot,f as Ie}from"./form-veesOllV.js";import{R as qp,a as Sr,_ as lt,r as Ig,t as qg,f as Lg,l as Fg,s as $g,u as Lp}from"./use-toast-8Za1Tsgn.js";import{a as zg,u as yt}from"./index.esm-B955QOgp.js";import{a as It,o as ct,b as Ug,s as me,c as Bg,e as Hg,n as ar,d as Wg}from"./types-hJPI8LHl.js";import"./client-DHZYSnFT.js";const Gg=ie("ArchiveRestore",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]]),Xc=ie("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),Kg=ie("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),Yg=ie("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Vg=ie("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),Xg=ie("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Qc=ie("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Qg=ie("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Jg=ie("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),Zg=ie("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),ex=ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Os=ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Js=ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),nt=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Fp=ie("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]),rx=ie("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Zs=ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),tx=ie("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),$p=ie("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),zp=ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),sx=ie("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),nx=ie("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}]]),Up=ie("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ss=ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ax=ie("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),Ql=ie("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),ix=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ox=ie("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),lx=ie("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),cx=ie("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),Jl=ie("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Hn=ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),ux=ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Wn=ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var dx="Separator",Jc="horizontal",mx=["horizontal","vertical"],Bp=x.forwardRef((r,t)=>{const{decorative:s,orientation:n=Jc,...a}=r,i=hx(n)?n:Jc,l=s?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(cr.div,{"data-orientation":i,...l,...a,ref:t})});Bp.displayName=dx;function hx(r){return mx.includes(r)}var Hp=Bp;const en=x.forwardRef(({className:r,orientation:t="horizontal",decorative:s=!0,...n},a)=>e.jsx(Hp,{ref:a,decorative:s,orientation:t,className:se("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...n}));en.displayName=Hp.displayName;const px=ng,fx=ag,Wp=x.forwardRef(({className:r,...t},s)=>e.jsx(Tp,{className:se("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...t,ref:s}));Wp.displayName=Tp.displayName;const vx=Cp("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Gp=x.forwardRef(({side:r="right",className:t,children:s,...n},a)=>e.jsxs(fx,{children:[e.jsx(Wp,{}),e.jsxs(Ep,{ref:a,className:se(vx({side:r}),t),...n,children:[s,e.jsxs(ig,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary","aria-label":"Fermer le panneau",children:[e.jsx(or,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"sr-only",children:"Fermer"})]})]})]}));Gp.displayName=Ep.displayName;const gx=x.forwardRef(({className:r,...t},s)=>e.jsx(Rp,{ref:s,className:se("text-lg font-semibold text-foreground",r),...t}));gx.displayName=Rp.displayName;const xx=x.forwardRef(({className:r,...t},s)=>e.jsx(Ap,{ref:s,className:se("text-sm text-muted-foreground",r),...t}));xx.displayName=Ap.displayName;const yx="sidebar:state",bx=60*60*24*7,jx="16rem",wx="18rem",_x="3rem",Sx="b",Kp=x.createContext(null);function fn(){const r=x.useContext(Kp);if(!r)throw new Error("useSidebar must be used within a SidebarProvider.");return r}const Yp=x.forwardRef(({defaultOpen:r=!0,open:t,onOpenChange:s,className:n,style:a,children:i,...o},l)=>{const c=yg(),[u,d]=x.useState(!1),[h,m]=x.useState(r),p=t??h,f=x.useCallback(g=>{const _=typeof g=="function"?g(p):g;s?s(_):m(_),document.cookie=`${yx}=${_}; path=/; max-age=${bx}`},[s,p]),v=x.useCallback(()=>c?d(g=>!g):f(g=>!g),[c,f,d]);x.useEffect(()=>{const g=_=>{_.key===Sx&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),v())};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[v]);const y=p?"expanded":"collapsed",j=x.useMemo(()=>({state:y,open:p,setOpen:f,isMobile:c,openMobile:u,setOpenMobile:d,toggleSidebar:v}),[y,p,f,c,u,d,v]);return e.jsx(Kp.Provider,{value:j,children:e.jsx(bg,{delayDuration:0,children:e.jsx("div",{style:{"--sidebar-width":jx,"--sidebar-width-icon":_x,...a},className:se("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:l,...o,children:i})})})});Yp.displayName="SidebarProvider";const Vp=x.forwardRef(({side:r="left",variant:t="sidebar",collapsible:s="offcanvas",className:n,children:a,...i},o)=>{const{isMobile:l,state:c,openMobile:u,setOpenMobile:d}=fn();return s==="none"?e.jsx("div",{className:se("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:o,...i,children:a}):l?e.jsx(px,{open:u,onOpenChange:d,...i,children:e.jsx(Gp,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":wx},side:r,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):e.jsxs("div",{ref:o,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?s:"","data-variant":t,"data-side":r,children:[e.jsx("div",{className:se("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),e.jsx("div",{className:se("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",r==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...i,children:e.jsx("nav",{"data-sidebar":"sidebar","aria-label":"Navigation principale",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});Vp.displayName="Sidebar";const Xp=x.forwardRef(({className:r,onClick:t,...s},n)=>{const{toggleSidebar:a}=fn();return e.jsxs(P,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:se("h-7 w-7",r),onClick:i=>{t==null||t(i),a()},...s,children:[e.jsx(nx,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});Xp.displayName="SidebarTrigger";const Nx=x.forwardRef(({className:r,...t},s)=>{const{toggleSidebar:n}=fn();return e.jsx("button",{ref:s,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:se("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",r),...t})});Nx.displayName="SidebarRail";const Ex=x.forwardRef(({className:r,...t},s)=>e.jsx("main",{ref:s,className:se("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",r),...t}));Ex.displayName="SidebarInset";const Cx=x.forwardRef(({className:r,...t},s)=>e.jsx(I,{ref:s,"data-sidebar":"input",className:se("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",r),...t}));Cx.displayName="SidebarInput";const Qp=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"header",className:se("flex flex-col gap-2 p-2",r),...t}));Qp.displayName="SidebarHeader";const Jp=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"footer",className:se("flex flex-col gap-2 p-2",r),...t}));Jp.displayName="SidebarFooter";const Tx=x.forwardRef(({className:r,...t},s)=>e.jsx(en,{ref:s,"data-sidebar":"separator",className:se("mx-2 w-auto bg-sidebar-border",r),...t}));Tx.displayName="SidebarSeparator";const Zp=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"content",className:se("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",r),...t}));Zp.displayName="SidebarContent";const Rx=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"group",className:se("relative flex w-full min-w-0 flex-col p-2",r),...t}));Rx.displayName="SidebarGroup";const Ax=x.forwardRef(({className:r,asChild:t=!1,...s},n)=>{const a=t?gs:"div";return e.jsx(a,{ref:n,"data-sidebar":"group-label",className:se("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",r),...s})});Ax.displayName="SidebarGroupLabel";const kx=x.forwardRef(({className:r,asChild:t=!1,...s},n)=>{const a=t?gs:"button";return e.jsx(a,{ref:n,"data-sidebar":"group-action","aria-label":"Action du groupe",className:se("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",r),...s})});kx.displayName="SidebarGroupAction";const Dx=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"group-content",className:se("w-full text-sm",r),...t}));Dx.displayName="SidebarGroupContent";const ef=x.forwardRef(({className:r,...t},s)=>e.jsx("ul",{ref:s,"data-sidebar":"menu",className:se("flex w-full min-w-0 flex-col gap-1",r),...t}));ef.displayName="SidebarMenu";const Rl=x.forwardRef(({className:r,...t},s)=>e.jsx("li",{ref:s,"data-sidebar":"menu-item",className:se("group/menu-item relative",r),...t}));Rl.displayName="SidebarMenuItem";const Px=Cp("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),Al=x.forwardRef(({asChild:r=!1,isActive:t=!1,variant:s="default",size:n="default",tooltip:a,className:i,...o},l)=>{const c=r?gs:"button",{isMobile:u,state:d}=fn(),h=e.jsx(c,{ref:l,"data-sidebar":"menu-button","data-size":n,"data-active":t,className:se(Px({variant:s,size:n}),i),...o});return a?(typeof a=="string"&&(a={children:a}),e.jsxs(jg,{children:[e.jsx(wg,{asChild:!0,children:h}),e.jsx(_g,{side:"right",align:"center",hidden:d!=="collapsed"||u,...a})]})):h});Al.displayName="SidebarMenuButton";const Mx=x.forwardRef(({className:r,asChild:t=!1,showOnHover:s=!1,...n},a)=>{const i=t?gs:"button";return e.jsx(i,{ref:a,"data-sidebar":"menu-action","aria-label":"Action du menu",className:se("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",s&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",r),...n})});Mx.displayName="SidebarMenuAction";const Ox=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,"data-sidebar":"menu-badge",className:se("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r),...t}));Ox.displayName="SidebarMenuBadge";const Ix=x.forwardRef(({className:r,showIcon:t=!1,...s},n)=>{const a=x.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return e.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:se("rounded-md h-8 flex gap-2 px-2 items-center",r),...s,children:[t&&e.jsx(xe,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),e.jsx(xe,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});Ix.displayName="SidebarMenuSkeleton";const qx=x.forwardRef(({className:r,...t},s)=>e.jsx("ul",{ref:s,"data-sidebar":"menu-sub",className:se("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",r),...t}));qx.displayName="SidebarMenuSub";const Lx=x.forwardRef(({...r},t)=>e.jsx("li",{ref:t,...r}));Lx.displayName="SidebarMenuSubItem";const Fx=x.forwardRef(({asChild:r=!1,size:t="md",isActive:s,className:n,...a},i)=>{const o=r?gs:"a";return e.jsx(o,{ref:i,"data-sidebar":"menu-sub-button","data-size":t,"data-active":s,className:se("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...a})});Fx.displayName="SidebarMenuSubButton";const $x=({children:r,title:t})=>{const{user:s,loading:n,isAdmin:a,signOut:i}=mn(),o=og();if(n)return e.jsx("main",{className:"min-h-screen flex items-center justify-center",children:e.jsx(lg,{})});if(!s)return k.error("Veuillez vous connecter pour accéder à cette page"),o("/auth/login"),null;if(!a)return k.error("Vous n'avez pas les droits administrateur nécessaires"),o("/dashboard"),null;const l=async()=>{await i()};return e.jsx(Yp,{children:e.jsxs("div",{className:"flex min-h-screen w-full",children:[e.jsxs(Vp,{children:[e.jsx(Qp,{children:e.jsxs("div",{className:"px-3 py-2",children:[e.jsx("h2",{className:"text-xl font-bold text-primary",children:"Administration"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Gestion du coworking"})]})}),e.jsx(Zp,{}),e.jsx(Jp,{children:e.jsxs(ef,{children:[e.jsx(Rl,{children:e.jsx(Al,{onClick:()=>o("/dashboard"),tooltip:"Retour",children:e.jsx("span",{children:"Retour au compte"})})}),e.jsx(Rl,{children:e.jsxs(Al,{onClick:l,tooltip:"Déconnexion",children:[e.jsx(Sg,{}),e.jsx("span",{children:"Déconnexion"})]})})]})})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("header",{className:"p-4 bg-gray-50 border-b flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xp,{}),e.jsx("h1",{className:"text-xl font-bold",children:t})]})}),e.jsx("main",{className:"p-4",children:r})]})]})})},zx=({activeView:r,onViewChange:t})=>{const s=[{id:"overview",label:"Tableau de bord",icon:rx,color:"blue"},{id:"overview-dual",label:"Vue Dual",icon:tx,color:"emerald"},{id:"spaces",label:"Espaces",icon:Qg,color:"green"},{id:"users",label:"Utilisateurs",icon:Et,color:"purple"},{id:"bookings",label:"Réservations",icon:gr,color:"orange"},{id:"payments",label:"Paiements",icon:Jg,color:"yellow"},{id:"payment-config",label:"Configuration des paiements",icon:Op,color:"indigo"},{id:"timeslots",label:"Créneaux horaires",icon:Xs,color:"pink"},{id:"emails",label:"Emails",icon:zp,color:"teal"},{id:"database",label:"Base de données",icon:ex,color:"red"},{id:"legal-pages",label:"Pages légales",icon:ir,color:"gray"},{id:"cookie-settings",label:"Cookies",icon:Zg,color:"amber"},{id:"support",label:"Support",icon:cg,color:"cyan"},{id:"settings",label:"Paramètres",icon:pn,color:"slate"}];return e.jsx("nav",{className:"p-4",role:"navigation","aria-label":"Navigation principale de l'administration",children:e.jsx("ul",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",role:"list",children:s.map(({id:n,label:a,icon:i,color:o})=>{const l=c=>{const u={blue:c?"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100":"bg-blue-50/30 text-blue-600 border-blue-100 hover:bg-blue-50",green:c?"bg-green-50 text-green-700 border-green-200 hover:bg-green-100":"bg-green-50/30 text-green-600 border-green-100 hover:bg-green-50",purple:c?"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100":"bg-purple-50/30 text-purple-600 border-purple-100 hover:bg-purple-50",orange:c?"bg-orange-50 text-orange-700 border-orange-200 hover:bg-orange-100":"bg-orange-50/30 text-orange-600 border-orange-100 hover:bg-orange-50",yellow:c?"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100":"bg-yellow-50/30 text-yellow-600 border-yellow-100 hover:bg-yellow-50",indigo:c?"bg-indigo-50 text-indigo-700 border-indigo-200 hover:bg-indigo-100":"bg-indigo-50/30 text-indigo-600 border-indigo-100 hover:bg-indigo-50",pink:c?"bg-pink-50 text-pink-700 border-pink-200 hover:bg-pink-100":"bg-pink-50/30 text-pink-600 border-pink-100 hover:bg-pink-50",teal:c?"bg-teal-50 text-teal-700 border-teal-200 hover:bg-teal-100":"bg-teal-50/30 text-teal-600 border-teal-100 hover:bg-teal-50",red:c?"bg-red-50 text-red-700 border-red-200 hover:bg-red-100":"bg-red-50/30 text-red-600 border-red-100 hover:bg-red-50",gray:c?"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100":"bg-gray-50/30 text-gray-600 border-gray-100 hover:bg-gray-50",amber:c?"bg-amber-50 text-amber-700 border-amber-200 hover:bg-amber-100":"bg-amber-50/30 text-amber-600 border-amber-100 hover:bg-amber-50",cyan:c?"bg-cyan-50 text-cyan-700 border-cyan-200 hover:bg-cyan-100":"bg-cyan-50/30 text-cyan-600 border-cyan-100 hover:bg-cyan-50",emerald:c?"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100":"bg-emerald-50/30 text-emerald-600 border-emerald-100 hover:bg-emerald-50",slate:c?"bg-slate-50 text-slate-700 border-slate-200 hover:bg-slate-100":"bg-slate-50/30 text-slate-600 border-slate-100 hover:bg-slate-50"};return u[o]||u.blue};return e.jsx("li",{children:e.jsxs("button",{className:`flex flex-col items-center justify-center h-16 gap-1 p-2 text-center rounded-lg border transition-all duration-200 w-full ${l(r===n)}`,onClick:()=>t(n),"aria-current":r===n?"page":void 0,"aria-label":`Accéder à ${a}`,children:[e.jsx(i,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-medium text-center leading-tight",children:a})]})},n)})})})},Ux=({isDisabled:r=!1})=>{const[t,s]=x.useState(null),[n,a]=x.useState(!0),[i,o]=x.useState(!1);x.useEffect(()=>{(async()=>{try{console.log("🔄 Chargement des paramètres cookies...");const u=await B.get("/cookie-settings");u.success&&u.data?(console.log("✅ Paramètres cookies chargés:",u.data),s(u.data)):(console.log("📝 Aucun paramètre trouvé, utilisation des valeurs par défaut"),s({id:"default",title:"Paramètres de Cookies",description:"Gérez vos préférences de cookies",accept_button_text:"Accepter",reject_button_text:"Refuser"}))}catch(u){console.error("❌ Erreur lors du chargement des paramètres:",u),console.log("📝 Erreur API, utilisation des valeurs par défaut"),s({id:"default",title:"Paramètres de Cookies",description:"Gérez vos préférences de cookies",accept_button_text:"Accepter",reject_button_text:"Refuser"})}finally{a(!1)}})()},[]);const l=async c=>{if(c.preventDefault(),!(!t||r)){o(!0);try{console.log("💾 Sauvegarde des paramètres cookies...");const u=await B.post("/cookie-settings",t);if(!u.success)throw new Error(u.error||"Erreur lors de la sauvegarde");console.log("✅ Paramètres cookies sauvegardés"),localStorage.setItem("cookie-settings-cache",JSON.stringify(u.data)),window.dispatchEvent(new CustomEvent("cookie-settings-updated",{detail:u.data})),k.success("Paramètres des cookies enregistrés avec succès")}catch(u){console.error("❌ Erreur lors de la sauvegarde:",u),k.error("Impossible d'enregistrer les paramètres")}finally{o(!1)}}};return n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Chargement des paramètres..."})]})}):t?e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5"}),e.jsx(V,{children:"Configuration générale"})]}),e.jsx(we,{children:"Paramètres principaux de la bannière de cookies"})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Titre principal"}),e.jsx(I,{value:t.title??"",onChange:c=>s({...t,title:c.target.value}),disabled:r,placeholder:"Nous utilisons des cookies"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{checked:t.is_active??!1,onCheckedChange:c=>s({...t,is_active:c}),disabled:r}),e.jsx(te,{children:"Activer la bannière de cookies"})]})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Description"}),e.jsx(_e,{value:t.description??"",onChange:c=>s({...t,description:c.target.value}),disabled:r,rows:3,placeholder:"Description de l'utilisation des cookies..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Position de la bannière"}),e.jsxs(Nr,{value:t.banner_position,onValueChange:c=>s({...t,banner_position:c}),disabled:r,children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"top",children:"En haut"}),e.jsx(pe,{value:"bottom",children:"En bas"})]})]})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Type d'affichage"}),e.jsxs(Nr,{value:t.banner_layout,onValueChange:c=>s({...t,banner_layout:c}),disabled:r,children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"banner",children:"Bannière"}),e.jsx(pe,{value:"modal",children:"Modal"}),e.jsx(pe,{value:"sidebar",children:"Barre latérale"})]})]})]})]})]})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Boutons d'action"}),e.jsx(we,{children:"Personnalisez le texte des boutons"})]}),e.jsx(W,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:'Bouton "Accepter"'}),e.jsx(I,{value:t.accept_button_text??"",onChange:c=>s({...t,accept_button_text:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:'Bouton "Refuser"'}),e.jsx(I,{value:t.reject_button_text??"",onChange:c=>s({...t,reject_button_text:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:'Bouton "Paramètres"'}),e.jsx(I,{value:t.settings_button_text??"",onChange:c=>s({...t,settings_button_text:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:'Bouton "Sauvegarder"'}),e.jsx(I,{value:t.save_preferences_text??"",onChange:c=>s({...t,save_preferences_text:c.target.value}),disabled:r})]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Types de cookies"}),e.jsx(we,{children:"Configuration des différents types de cookies"})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-medium",children:"Cookies nécessaires (toujours activés)"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 pl-5",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Titre"}),e.jsx(I,{value:t.necessary_cookies_title??"",onChange:c=>s({...t,necessary_cookies_title:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Description"}),e.jsx(_e,{value:t.necessary_cookies_description??"",onChange:c=>s({...t,necessary_cookies_description:c.target.value}),disabled:r,rows:2})]})]})]}),e.jsx(en,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("h4",{className:"font-medium",children:"Cookies analytiques"})]}),e.jsx(Nt,{checked:t.analytics_cookies_enabled??!1,onCheckedChange:c=>s({...t,analytics_cookies_enabled:c}),disabled:r})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 pl-5",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Titre"}),e.jsx(I,{value:t.analytics_cookies_title??"",onChange:c=>s({...t,analytics_cookies_title:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Description"}),e.jsx(_e,{value:t.analytics_cookies_description??"",onChange:c=>s({...t,analytics_cookies_description:c.target.value}),disabled:r,rows:2})]})]})]}),e.jsx(en,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("h4",{className:"font-medium",children:"Cookies marketing"})]}),e.jsx(Nt,{checked:t.marketing_cookies_enabled??!1,onCheckedChange:c=>s({...t,marketing_cookies_enabled:c}),disabled:r})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 pl-5",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Titre"}),e.jsx(I,{value:t.marketing_cookies_title??"",onChange:c=>s({...t,marketing_cookies_title:c.target.value}),disabled:r})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Description"}),e.jsx(_e,{value:t.marketing_cookies_description??"",onChange:c=>s({...t,marketing_cookies_description:c.target.value}),disabled:r,rows:2})]})]})]})]})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Liens légaux"}),e.jsx(we,{children:"URLs vers vos pages légales"})]}),e.jsx(W,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"URL Politique de confidentialité"}),e.jsx(I,{value:t.privacy_policy_url??"",onChange:c=>s({...t,privacy_policy_url:c.target.value}),disabled:r,placeholder:"/privacy"})]}),e.jsxs("div",{children:[e.jsx(te,{children:"URL Politique des cookies"}),e.jsx(I,{value:t.cookie_policy_url??"",onChange:c=>s({...t,cookie_policy_url:c.target.value}),disabled:r,placeholder:"/cookies"})]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sx,{className:"h-5 w-5"}),e.jsx(V,{children:"Apparence"})]}),e.jsx(we,{children:"Personnalisez les couleurs de la bannière"})]}),e.jsx(W,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Couleur principale"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{type:"color",value:t.primary_color??"#3B82F6",onChange:c=>s({...t,primary_color:c.target.value}),disabled:r,className:"w-12 h-10 p-1"}),e.jsx(I,{value:t.primary_color??"",onChange:c=>s({...t,primary_color:c.target.value}),disabled:r,placeholder:"#3B82F6",className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Couleur secondaire"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{type:"color",value:t.secondary_color??"#6B7280",onChange:c=>s({...t,secondary_color:c.target.value}),disabled:r,className:"w-12 h-10 p-1"}),e.jsx(I,{value:t.secondary_color??"",onChange:c=>s({...t,secondary_color:c.target.value}),disabled:r,placeholder:"#6B7280",className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Arrière-plan"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{type:"color",value:t.background_color??"#FFFFFF",onChange:c=>s({...t,background_color:c.target.value}),disabled:r,className:"w-12 h-10 p-1"}),e.jsx(I,{value:t.background_color??"",onChange:c=>s({...t,background_color:c.target.value}),disabled:r,placeholder:"#FFFFFF",className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(te,{children:"Couleur du texte"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{type:"color",value:t.text_color??"#1F2937",onChange:c=>s({...t,text_color:c.target.value}),disabled:r,className:"w-12 h-10 p-1"}),e.jsx(I,{value:t.text_color??"",onChange:c=>s({...t,text_color:c.target.value}),disabled:r,placeholder:"#1F2937",className:"flex-1"})]})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(P,{type:"submit",disabled:i||r,className:"min-w-[200px]",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ql,{className:"w-4 h-4 mr-2"}),"Enregistrer les paramètres"]})})})]}):e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"Aucun paramètre trouvé"}),e.jsx(P,{className:"mt-4",onClick:()=>window.location.reload(),children:"Recharger"})]})})},Bx={total_users:0,active_users:0,total_spaces:0,available_spaces:0,total_bookings:0,active_bookings:0,total_revenue:0,monthly_revenue:0,popular_spaces:[],recent_bookings:[]},kl=(r="test")=>{const[t,s]=x.useState({data:null,loading:!0,error:null,lastUpdated:null}),n=x.useRef(0),a=3,i=x.useCallback(c=>{s(u=>({...u,...c}))},[]),o=x.useCallback(async()=>{try{n.current>0&&i({loading:!0,error:null}),Bn.log(`📊 Chargement des statistiques admin (mode: ${r})...`);const c=await B.get(`/admin/stats?mode=${r}`);if(!c.success)throw new Error(c.error||"Erreur lors du chargement des statistiques");i({data:c.data,loading:!1,error:null,lastUpdated:new Date}),n.current=0}catch(c){Bn.error("❌ Erreur lors du chargement des statistiques:",c);const u=c instanceof Error?c.message:"Erreur inconnue";n.current<a?(n.current++,Bn.log(`🔄 Tentative de reconnexion ${n.current}/${a}...`),setTimeout(()=>{o()},Math.pow(2,n.current)*1e3)):(i({error:u,loading:!1,data:Bx}),n.current=0)}},[i,r]);x.useEffect(()=>{o()},[o]);const l=x.useCallback(()=>{n.current=0,o()},[o]);return{...t,refreshStats:l}},Dl=({stats:r,loading:t=!1,error:s=null})=>{const n=()=>e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(V,{className:"text-lg font-semibold",children:e.jsx(xe,{className:"h-6 w-[200px]"})})}),e.jsx(W,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((o,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(xe,{className:"h-4 w-[150px]"}),e.jsx(xe,{className:"h-3 w-[100px]"})]}),e.jsx(xe,{className:"h-4 w-[80px]"})]},l))})})]}),a=()=>e.jsxs(Ge,{variant:"destructive",children:[e.jsx(Pr,{className:"h-4 w-4"}),e.jsx(st,{children:"Erreur"}),e.jsx(Ke,{children:s||"Une erreur est survenue lors du chargement des réservations récentes"})]}),i=()=>{const o=(r==null?void 0:r.recent_bookings)||[];return o.length===0?e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsx(V,{className:"text-sm font-semibold",children:"Récentes"})}),e.jsx(W,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucune réservation récente"})})]}):e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(V,{className:"text-lg font-semibold",children:"Réservations Récentes"})}),e.jsx(W,{children:e.jsx("div",{className:"space-y-4",children:o.map(l=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between border-b pb-2 last:border-b-0 last:pb-0",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[l.user_name,l.company?` (${l.company})`:""]})," a réservé ",e.jsx("span",{className:"font-semibold",children:l.space_name})," le ",e.jsx("span",{children:l.created_at})]}),e.jsx("div",{className:"text-right mt-1 md:mt-0",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${l.status==="confirmed"?"bg-green-100 text-green-800":l.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:l.status})})]},l.id))})})]})};return t?e.jsx(n,{}):s?e.jsx(a,{}):e.jsx(i,{})},Pl=({spaces:r,loading:t})=>t?e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"h-5 w-5"}),"Populaires"]})}),e.jsx(W,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(xe,{className:"h-4 w-[150px]"}),e.jsx(xe,{className:"h-3 w-[100px]"})]}),e.jsx(xe,{className:"h-4 w-[60px]"})]},n))})})]}):r.length===0?e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"h-5 w-5"}),"Populaires"]})}),e.jsx(W,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ts,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Aucun espace avec des réservations"})]})})]}):e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"h-5 w-5"}),"Espaces populaires"]})}),e.jsx(W,{children:e.jsx("div",{className:"space-y-4",children:r.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary text-primary-foreground rounded-full text-sm font-bold",children:n+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Espace de coworking"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Et,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:s.bookings_count}),e.jsx("span",{children:"réservations"})]})]},s.id))})})]}),Ml=({mode:r})=>{const[t,s]=x.useState([]),[n,a]=x.useState(!0);x.useEffect(()=>{const h=async()=>{a(!0);try{const p=await B.get(`/admin/alerts?mode=${r}`);if(p.success){const f=p.data.map(v=>({...v,timestamp:new Date(v.timestamp)}));s(f)}else console.error("Erreur récupération alertes:",p.error),s([])}catch(p){console.error("Erreur chargement alertes:",p),s([])}finally{a(!1)}};h();const m=setInterval(h,3e4);return()=>clearInterval(m)},[r]);const i=h=>{s(m=>m.map(p=>p.id===h?{...p,dismissed:!0}:p))},o=h=>{switch(h){case"error":return e.jsx(Pr,{className:"h-4 w-4 text-red-600"});case"warning":return e.jsx(Qs,{className:"h-4 w-4 text-yellow-600"});case"success":return e.jsx(Ct,{className:"h-4 w-4 text-green-600"});case"info":return e.jsx(Zs,{className:"h-4 w-4 text-blue-600"});default:return e.jsx(Zs,{className:"h-4 w-4 text-gray-600"})}},l=h=>{switch(h){case"error":return"destructive";case"warning":return"default";case"success":return"default";case"info":return"default";default:return"default"}},c=h=>{switch(h){case"error":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";case"success":return"bg-green-100 text-green-800";case"info":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},u=t.filter(h=>!h.dismissed),d=t.filter(h=>h.dismissed);return n?e.jsxs(U,{children:[e.jsx(K,{className:"pb-2",children:e.jsxs(V,{className:"flex items-center gap-2 text-sm",children:[e.jsx(Qc,{className:"h-4 w-4"}),"Alertes"]})}),e.jsx(W,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-3/4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-1/2 bg-gray-200 rounded"})]})})})]}):e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Qc,{className:"h-5 w-5"}),"Alertes"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(fe,{variant:"outline",children:[u.length," actives"]}),e.jsx(P,{variant:"outline",size:"sm",children:e.jsx(pn,{className:"h-3 w-3"})})]})]})}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-4",children:[u.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700",children:"Alertes actives"}),u.map(h=>e.jsx(Ge,{variant:l(h.type),children:e.jsxs("div",{className:"flex items-start gap-2",children:[o(h.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs(st,{className:"flex items-center gap-2",children:[h.title,e.jsx(fe,{className:c(h.type),children:h.type})]}),e.jsx(Ke,{className:"mt-1",children:h.message}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h.timestamp.toLocaleString("fr-FR")})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>i(h.id),className:"h-6 w-6 p-0",children:e.jsx(or,{className:"h-3 w-3"})})]})},h.id))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ct,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Aucune alerte active"})]}),d.length>0&&e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700",children:"Alertes supprimées"}),d.slice(0,3).map(h=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o(h.type),e.jsx("span",{className:"text-sm font-medium",children:h.title}),e.jsx(fe,{className:c(h.type),children:h.type})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.timestamp.toLocaleString("fr-FR")})]},h.id))]})]})})]})},Zc=()=>{const{data:r,loading:t,error:s}=kl("live"),n=i=>new Intl.NumberFormat("fr-FR").format(i),a=i=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(i);return t?e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((i,o)=>e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium",children:e.jsx(xe,{className:"h-4 w-[100px]"})}),e.jsx(xe,{className:"h-4 w-4"})]}),e.jsxs(W,{children:[e.jsx(xe,{className:"h-8 w-[60px]"}),e.jsx(xe,{className:"mt-2 h-4 w-[80px]"})]})]},o))})}):s?e.jsxs(Ge,{variant:"destructive",children:[e.jsx(Pr,{className:"h-4 w-4"}),e.jsx(st,{children:"Erreur"}),e.jsx(Ke,{children:s||"Une erreur est survenue lors du chargement du tableau de bord"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(U,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-blue-700",children:"Utilisateurs"}),e.jsx(Et,{className:"h-3 w-3 text-blue-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-blue-900",children:n((r==null?void 0:r.total_users)||0)}),e.jsxs("p",{className:"text-xs text-blue-600",children:[(r==null?void 0:r.active_users)||0," actifs"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-green-700",children:"Espaces"}),e.jsx(ts,{className:"h-3 w-3 text-green-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-green-900",children:n((r==null?void 0:r.total_spaces)||0)}),e.jsxs("p",{className:"text-xs text-green-600",children:[(r==null?void 0:r.available_spaces)||0," disponibles"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-purple-700",children:"Réservations"}),e.jsx(gr,{className:"h-3 w-3 text-purple-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-purple-900",children:n((r==null?void 0:r.total_bookings)||0)}),e.jsxs("p",{className:"text-xs text-purple-600",children:[(r==null?void 0:r.active_bookings)||0," actives"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-orange-700",children:"Revenus"}),e.jsx(Os,{className:"h-3 w-3 text-orange-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-orange-900",children:a((r==null?void 0:r.total_revenue)||0)}),e.jsxs("p",{className:"text-xs text-orange-600",children:[a((r==null?void 0:r.monthly_revenue)||0)," ce mois"]})]})]})]}),(r==null?void 0:r.stripe_customers)===0&&(r==null?void 0:r.stripe_products)===0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Mode Production :"})," Aucune donnée Stripe live trouvée. Les données s'afficheront automatiquement lorsque vous aurez des clients et produits en production."]})]})}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(U,{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 border-indigo-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-indigo-700",children:"Clients Stripe"}),e.jsx(Et,{className:"h-3 w-3 text-indigo-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-indigo-900",children:n((r==null?void 0:r.stripe_customers)||0)}),e.jsx("p",{className:"text-xs text-indigo-600",children:"Dans Stripe"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border-emerald-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-emerald-700",children:"Produits Stripe"}),e.jsx(ts,{className:"h-3 w-3 text-emerald-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-emerald-900",children:n((r==null?void 0:r.stripe_products)||0)}),e.jsx("p",{className:"text-xs text-emerald-600",children:"Catalogue"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-amber-700",children:"Revenus Nets"}),e.jsx(Os,{className:"h-3 w-3 text-amber-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-amber-900",children:a((r==null?void 0:r.net_revenue)||0)}),e.jsx("p",{className:"text-xs text-amber-600",children:"Après frais"})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-rose-50 to-rose-100 border-rose-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:[e.jsx(V,{className:"text-xs font-medium text-rose-700",children:"Revenus Bruts"}),e.jsx(Os,{className:"h-3 w-3 text-rose-600"})]}),e.jsxs(W,{className:"pt-0",children:[e.jsx("div",{className:"text-lg font-bold text-rose-900",children:a((r==null?void 0:r.total_revenue)||0)}),e.jsx("p",{className:"text-xs text-rose-600",children:"Avant frais"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(Ml,{mode:"live"}),e.jsx(Pl,{spaces:(r==null?void 0:r.popular_spaces)||[],loading:t}),e.jsx(Dl,{stats:r,loading:t,error:s})]})]})},Hx=()=>{const{data:r,loading:t,error:s}=kl("test"),{data:n,loading:a,error:i}=kl("live"),o=u=>new Intl.NumberFormat("fr-FR").format(u),l=u=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(u),c=(u,d,h,m)=>d?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((p,f)=>e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium",children:e.jsx(xe,{className:"h-4 w-[100px]"})}),e.jsx(xe,{className:"h-4 w-4"})]}),e.jsxs(W,{children:[e.jsx(xe,{className:"h-8 w-[60px]"}),e.jsx(xe,{className:"mt-2 h-4 w-[80px]"})]})]},f))}):h?e.jsxs(Ge,{variant:"destructive",children:[e.jsx(Pr,{className:"h-4 w-4"}),e.jsx(st,{children:"Erreur"}),e.jsx(Ke,{children:h||"Une erreur est survenue lors du chargement du tableau de bord"})]}):e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(U,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-blue-700",children:"Utilisateurs"}),e.jsx(Et,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(W,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:o((u==null?void 0:u.total_users)||0)}),e.jsxs("p",{className:"text-xs text-blue-600",children:[(u==null?void 0:u.active_users)||0," actifs"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-green-700",children:"Espaces"}),e.jsx(ts,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(W,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-900",children:o((u==null?void 0:u.total_spaces)||0)}),e.jsxs("p",{className:"text-xs text-green-600",children:[(u==null?void 0:u.available_spaces)||0," disponibles"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-purple-700",children:"Réservations"}),e.jsx(gr,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(W,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:o((u==null?void 0:u.total_bookings)||0)}),e.jsxs("p",{className:"text-xs text-purple-600",children:[(u==null?void 0:u.active_bookings)||0," actives"]})]})]}),e.jsxs(U,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-orange-700",children:"Revenus"}),e.jsx(Os,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(W,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-900",children:l((u==null?void 0:u.total_revenue)||0)}),e.jsxs("p",{className:"text-xs text-orange-600",children:[l((u==null?void 0:u.monthly_revenue)||0)," ce mois"]})]})]})]});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cx,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold text-blue-700",children:"Mode Test"}),e.jsx("div",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Développement"})]}),c(r,t,s),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(Ml,{mode:"test"}),e.jsx(Pl,{spaces:(r==null?void 0:r.popular_spaces)||[],loading:t}),e.jsx(Dl,{stats:r,loading:t,error:s})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-8"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ax,{className:"h-6 w-6 text-green-600"}),e.jsx("h2",{className:"text-2xl font-bold text-green-700",children:"Mode Production"}),e.jsx("div",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"Live"})]}),c(n,a,i),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(Ml,{mode:"live"}),e.jsx(Pl,{spaces:(n==null?void 0:n.popular_spaces)||[],loading:a}),e.jsx(Dl,{stats:n,loading:a,error:i})]})]})]})},Wx=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!0),a=async()=>{try{n(!0),console.log("Fetching users...");const c=await B.get("/users");if(c.success&&c.data){const u=Array.isArray(c.data)?c.data:[];t(u)}else t([])}catch(c){console.error("Erreur lors de la récupération des profils:",c),k.error("Impossible de récupérer les utilisateurs"),t([])}finally{n(!1)}},i=async c=>{if(!c)return k.error("ID utilisateur manquant"),null;try{const u=await B.get(`/users/${c}`);if(!u.success)throw new Error(u.error||"Erreur lors de la récupération");const d=u.data;return d?{id:d.id,user_id:d.user_id,email:d.email,first_name:d.first_name||"",last_name:d.last_name||"",phone:d.phone||"",company:d.company||"",created_at:d.created_at,updated_at:d.updated_at,address:d.address||"",address_street:d.address_street||"",address_city:d.address_city||"",address_postal_code:d.address_postal_code||"",address_country:d.address_country||"",birth_date:d.birth_date||"",profile_picture:d.profile_picture||"",avatar_url:d.avatar_url||"",logo_url:d.logo_url||"",presentation:d.presentation||"",company_name:d.company_name||"",full_name:d.full_name||"",phone_number:d.phone_number||""}:null}catch(u){return console.error("Erreur lors de la récupération du profil:",u),k.error("Impossible de récupérer les informations de l'utilisateur"),null}};return x.useEffect(()=>{a()},[]),{users:r,loading:s,fetchUsers:a,getUserById:i,updateUser:async(c,u)=>{try{const d=await B.updateUser(c,u);return d.success?(k.success("Utilisateur modifié avec succès"),await a(),!0):(k.error(d.error||"Erreur lors de la modification"),!1)}catch(d){return console.error("Erreur lors de la modification:",d),k.error("Erreur lors de la modification de l'utilisateur"),!1}},deleteUser:async c=>{try{const u=await B.deleteUser(c);return u.success?(k.success("Utilisateur supprimé avec succès"),await a(),!0):(k.error(u.error||"Erreur lors de la suppression"),!1)}catch(u){return console.error("Erreur lors de la suppression:",u),k.error("Erreur lors de la suppression de l'utilisateur"),!1}}}},Mr=x.forwardRef(({className:r,...t},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:se("w-full caption-bottom text-sm",r),...t})}));Mr.displayName="Table";const Or=x.forwardRef(({className:r,...t},s)=>e.jsx("thead",{ref:s,className:se("[&_tr]:border-b",r),...t}));Or.displayName="TableHeader";const Ir=x.forwardRef(({className:r,...t},s)=>e.jsx("tbody",{ref:s,className:se("[&_tr:last-child]:border-0",r),...t}));Ir.displayName="TableBody";const Gx=x.forwardRef(({className:r,...t},s)=>e.jsx("tfoot",{ref:s,className:se("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...t}));Gx.displayName="TableFooter";const Ee=x.forwardRef(({className:r,...t},s)=>e.jsx("tr",{ref:s,className:se("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...t}));Ee.displayName="TableRow";const Q=x.forwardRef(({className:r,...t},s)=>e.jsx("th",{ref:s,className:se("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...t}));Q.displayName="TableHead";const X=x.forwardRef(({className:r,...t},s)=>e.jsx("td",{ref:s,className:se("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...t}));X.displayName="TableCell";const Kx=x.forwardRef(({className:r,...t},s)=>e.jsx("caption",{ref:s,className:se("mt-4 text-sm text-muted-foreground",r),...t}));Kx.displayName="TableCaption";const Yx=({user:r,onViewDetails:t,onEdit:s,onDelete:n})=>{const a=i=>new Date(i).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(Ee,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-medium",children:[r.first_name," ",r.last_name]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Up,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:r.phone||"Non renseigné"})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:r.created_at?a(r.created_at):"Non renseigné"})]})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>t(r),children:"Voir détails"}),s&&e.jsx(P,{variant:"outline",size:"sm",onClick:()=>s(r),className:"text-blue-600 hover:text-blue-700",children:e.jsx(xt,{className:"h-4 w-4"})}),n&&e.jsx(P,{variant:"outline",size:"sm",onClick:()=>n(r),className:"text-red-600 hover:text-red-700",children:e.jsx(mr,{className:"h-4 w-4"})})]})})]})},Vx=({users:r,onViewDetails:t,onEdit:s,onDelete:n})=>e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Utilisateur"}),e.jsx(Q,{children:"Téléphone"}),e.jsx(Q,{children:"Date d'inscription"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:r.map(a=>e.jsx(Yx,{user:a,onViewDetails:t,onEdit:s,onDelete:n},a.id))})]}),Xx=({user:r})=>{const t=(s,n)=>{const a=(s==null?void 0:s.charAt(0))||"",i=(n==null?void 0:n.charAt(0))||"";return(a+i).toUpperCase()||"U"};return e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Informations personnelles"}),e.jsxs("div",{className:"bg-muted p-4 rounded-md space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(kg,{className:"h-12 w-12 border-2 border-white shadow-sm",children:[e.jsx(Dg,{src:r.avatar_url||r.profile_picture,alt:"Photo de profil",className:"object-cover",onError:s=>{console.warn("Erreur de chargement de l'avatar admin:",s)}}),e.jsx(Pg,{className:"text-sm font-semibold bg-gradient-to-br from-blue-500 to-purple-600 text-white",children:t(r.first_name,r.last_name)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Nom complet:"}),e.jsxs("span",{className:"text-sm",children:[r.first_name||""," ",r.last_name||""]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:r.avatar_url?"Photo de profil disponible":"Aucune photo de profil"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zp,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Email:"}),e.jsx("span",{className:"text-sm",children:r.email||"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Up,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Téléphone:"}),e.jsx("span",{className:"text-sm",children:r.phone||r.phone_number||"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ip,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Adresse:"}),e.jsx("span",{className:"text-sm",children:r.address_street||"Non renseignée"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ville:"}),e.jsx("span",{className:"text-sm",children:r.address_city||"Non renseignée"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Code postal:"}),e.jsx("span",{className:"text-sm",children:r.address_postal_code||"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Pays:"}),e.jsx("span",{className:"text-sm",children:r.address_country||"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Date de naissance:"}),e.jsx("span",{className:"text-sm",children:r.birth_date?new Date(r.birth_date).toLocaleDateString("fr-FR"):"Non renseignée"})]})]})]})},eu=({user:r})=>{const t=s=>new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Informations additionnelles"}),e.jsxs("div",{className:"bg-muted p-4 rounded-md space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ng,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Entreprise:"}),e.jsx("span",{className:"text-sm",children:r.company||"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Date d'inscription:"}),e.jsx("span",{className:"text-sm",children:r.created_at?t(r.created_at):"Non renseigné"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"ID Utilisateur:"}),e.jsx("span",{className:"text-xs font-mono",children:r.id})]})]})]})},ru={identity:"Pièce d'identité",address_proof:"Justificatif de domicile",income_proof:"Justificatif de revenus",insurance:"Assurance",contract:"Contrat",other:"Autre"},Qx=({userId:r,userName:t="Utilisateur",userCompany:s})=>{const[n,a]=x.useState([]),[i,o]=x.useState(!0),[l,c]=x.useState(null),[u,d]=x.useState(""),[h,m]=x.useState(!1),[p,f]=x.useState(0);x.useEffect(()=>{v()},[r,p]);const v=async()=>{try{console.log("🔍 Chargement des documents pour userId:",r),console.log("userId utilisé pour la requête:",r,typeof r);const S=await B.get(`/users/${r}/documents`);if(S.success&&S.data){console.log("📄 Tous les documents:",S.data);const C=S.data.map(D=>{const R={id:D.id,user_id:D.user_id,file_url:D.file_url||D.document_url||"",file_path:D.file_path,file_name:D.file_name||`Document ${D.document_type}`,file_size:D.file_size||0,file_type:D.file_type||"application/octet-stream",document_type:D.document_type,uploaded_at:D.uploaded_at,upload_date:D.upload_date,scan_status:"pending"};return console.log("🔍 Document transformé:",{id:R.id,file_name:R.file_name,file_path_exists:!!R.file_path,file_path_length:R.file_path?R.file_path.length:0,file_url_exists:!!R.file_url,upload_date:R.upload_date,document_type:R.document_type,buttons_enabled:!!(R.file_path||R.file_url)}),R});console.log("✅ Documents transformés:",C.length,"documents"),a(C)}else console.log("⚠️ Aucun document trouvé ou erreur API"),a([])}catch(S){console.error("❌ Erreur lors du chargement des documents:",S),k.error("Erreur lors du chargement des documents"),a([])}finally{o(!1)}},y=async S=>{try{if(S.file_path&&!S.file_path.startsWith("http")){const C=S.file_path,D=atob(C),R=new Array(D.length);for(let z=0;z<D.length;z++)R[z]=D.charCodeAt(z);const O=new Uint8Array(R),T=new Blob([O],{type:S.file_type}),q=URL.createObjectURL(T),$=window.document.createElement("a");$.href=q,$.download=S.file_name,window.document.body.appendChild($),$.click(),window.document.body.removeChild($),URL.revokeObjectURL(q),k.success("Document téléchargé");return}if(!S.file_url){k.error("URL du document non disponible");return}if(S.file_url.startsWith("http")){const D=await(await fetch(S.file_url)).blob(),R=URL.createObjectURL(D),O=window.document.createElement("a");O.href=R,O.download=S.file_name,window.document.body.appendChild(O),O.click(),window.document.body.removeChild(O),URL.revokeObjectURL(R)}else{const C=await fetch(S.file_url);if(!C.ok)throw new Error("Erreur lors du téléchargement du fichier");const D=await C.blob(),R=URL.createObjectURL(D),O=window.document.createElement("a");O.href=R,O.download=S.file_name,window.document.body.appendChild(O),O.click(),window.document.body.removeChild(O),URL.revokeObjectURL(R)}k.success("Document téléchargé")}catch(C){console.error("Erreur lors du téléchargement:",C),k.error("Erreur lors du téléchargement")}},j=async S=>{var C;try{let D="";if(S.file_path&&!S.file_path.startsWith("http")){const R=S.file_path;D=`data:${S.file_type||"application/octet-stream"};base64,${R}`}else if(S.file_url)S.file_url.startsWith("http"),D=S.file_url;else{k.error("URL du document non disponible");return}console.log("🔍 Debug document:",{fileName:S.file_name,fileType:S.file_type,fileUrl:S.file_url,filePath:S.file_path,signedUrl:D,isPdf:S.file_type.includes("pdf"),isImage:S.file_type.includes("image"),extension:(C=S.file_name.split(".").pop())==null?void 0:C.toLowerCase()}),c(S),d(D),m(!0)}catch(D){console.error("Erreur lors de l'ouverture du document:",D),k.error("Erreur lors de l'ouverture du document")}},g=()=>{console.log("🔄 Rafraîchissement forcé des documents..."),f(S=>S+1)},_=S=>S.includes("pdf")?e.jsx(ir,{className:"h-5 w-5 text-red-500"}):S.includes("image")?e.jsx(ir,{className:"h-5 w-5 text-blue-500"}):e.jsx(ir,{className:"h-5 w-5 text-gray-500"}),b=S=>{const C=ru[S]||"Autre",D={identity:"bg-blue-100 text-blue-800",address_proof:"bg-green-100 text-green-800",income_proof:"bg-yellow-100 text-yellow-800",insurance:"bg-purple-100 text-purple-800",contract:"bg-orange-100 text-orange-800",other:"bg-gray-100 text-gray-800"};return e.jsx(fe,{className:D[S]||D.other,children:C})},N=S=>{if(!S.scan_status)return e.jsxs(fe,{variant:"outline",className:"text-gray-600",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),"Non vérifié"]});switch(S.scan_status){case"clean":return e.jsxs(fe,{className:"bg-green-100 text-green-800",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),"Sécurisé"]});case"infected":return e.jsxs(fe,{className:"bg-red-100 text-red-800",children:[e.jsx(Qs,{className:"h-3 w-3 mr-1"}),"Menace détectée"]});case"error":return e.jsxs(fe,{className:"bg-yellow-100 text-yellow-800",children:[e.jsx(Qs,{className:"h-3 w-3 mr-1"}),"Erreur de scan"]});default:return e.jsxs(fe,{variant:"outline",className:"text-gray-600",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),"En cours"]})}},w=S=>{if(S===0)return"0 Bytes";const C=1024,D=["Bytes","KB","MB","GB"],R=Math.floor(Math.log(S)/Math.log(C));return parseFloat((S/Math.pow(C,R)).toFixed(2))+" "+D[R]},E=S=>{var T,q;if(S.file_type.includes("pdf"))return"pdf";if(S.file_type.includes("image"))return"image";const C=S.file_name,D=(T=C.split(".").pop())==null?void 0:T.toLowerCase(),R=S.file_url?(q=S.file_url.split(".").pop())==null?void 0:q.toLowerCase():null;console.log("🔍 Analyse type fichier:",{fileName:C,fileType:S.file_type,extension:D,urlExtension:R,fileUrl:S.file_url,filePath:S.file_path?"Présent":"Absent"});const O=[D,R].filter(Boolean);for(const $ of O){if($==="pdf")return"pdf";if(["jpg","jpeg","png","gif","webp","svg","bmp","tiff"].includes($))return"image";if(["doc","docx"].includes($))return"document";if(["xls","xlsx"].includes($))return"spreadsheet";if(["txt","rtf"].includes($))return"text"}return S.file_url&&(S.file_url.includes(".png")||S.file_url.includes(".jpg")||S.file_url.includes(".jpeg")||S.file_url.includes(".gif")||S.file_url.includes(".webp"))?"image":"other"};return console.log("🟢 Documents à afficher:",n),i?e.jsx(U,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Og,{className:"h-5 w-5"}),"Documents de ",t,s&&e.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",s,")"]})]}),e.jsx(P,{onClick:g,variant:"outline",size:"sm",className:"flex items-center gap-2",children:"🔄 Actualiser"})]})}),e.jsx(W,{children:n.length===0?e.jsx(Ge,{children:e.jsx(Ke,{children:"Aucun document uploadé par cet utilisateur."})}):e.jsx("div",{className:"space-y-4",children:n.map((S,C)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[_(S.file_type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:S.file_name}),b(S.document_type),N(S)]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsx("span",{children:w(S.file_size)}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Uploadé le ",new Date(S.upload_date||S.uploaded_at).toLocaleDateString("fr-FR",{timeZone:"Europe/Paris",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>j(S),className:"flex items-center gap-1",disabled:!S.file_path&&!S.file_url,children:[e.jsx(nt,{className:"h-4 w-4"}),"Voir"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>y(S),className:"flex items-center gap-1",disabled:!S.file_path&&!S.file_url,children:[e.jsx(Vc,{className:"h-4 w-4"}),"Télécharger"]})]})]},`${S.id}-${C}`))},`documents-list-${p}`)})]},`documents-${p}`),e.jsx($e,{open:h,onOpenChange:m,children:e.jsxs(ze,{className:"max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:l==null?void 0:l.file_name}),e.jsx(He,{children:(l==null?void 0:l.document_type)&&e.jsx(fe,{variant:"outline",className:"mt-2",children:ru[l.document_type]||"Autre"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:u&&l&&(()=>{const S=E(l);switch(console.log("🎨 Affichage document:",{fileName:l.file_name,fileType:l.file_type,docType:S,url:u}),S){case"pdf":return e.jsx("iframe",{src:u,className:"w-full h-[70vh] border rounded",title:l.file_name});case"image":return e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:u,alt:l.file_name,className:"max-w-full max-h-[70vh] object-contain rounded",onError:C=>{console.error("❌ Erreur chargement image:",C),k.error("Erreur lors du chargement de l'image")}})});default:return e.jsx("div",{className:"flex items-center justify-center h-[70vh] bg-gray-50 rounded",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ir,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Aperçu non disponible pour ce type de fichier"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Type: ",l.file_type," | Extension: ",l.file_name.split(".").pop()]}),e.jsxs(P,{variant:"outline",onClick:()=>y(l),className:"mt-4",children:[e.jsx(Vc,{className:"h-4 w-4 mr-2"}),"Télécharger pour voir"]})]})})}})()})]})})]})};function vn(r,t){const[s,n]=x.useState(()=>{try{const a=localStorage.getItem(`tab-${r}`);return a?JSON.parse(a):t}catch(a){return console.warn(`Erreur lors de la lecture de l'onglet ${r}:`,a),t}});return x.useEffect(()=>{try{localStorage.setItem(`tab-${r}`,JSON.stringify(s))}catch(a){console.warn(`Erreur lors de la sauvegarde de l'onglet ${r}:`,a)}},[s,r]),[s,n]}const Jx=({user:r,open:t,onOpenChange:s,loading:n=!1})=>{const[a,i]=vn("user-details","profile");return r?e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(ze,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ue,{children:[e.jsxs(Be,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),"Détails de l'utilisateur"]}),e.jsxs(He,{children:["Informations détaillées sur ",r.first_name," ",r.last_name,r.company&&` - ${r.company}`]})]}),e.jsx("div",{className:"py-4",children:n?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("p",{children:"Chargement des détails..."})}):e.jsxs(kr,{value:a,onValueChange:i,className:"w-full",children:[e.jsxs(Dr,{className:"grid w-full grid-cols-3",children:[e.jsxs(ce,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4"}),"Profil"]}),e.jsxs(ce,{value:"company",className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Entreprise"]}),e.jsxs(ce,{value:"documents",className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-4 w-4"}),"Documents"]})]}),e.jsx(ge,{value:"profile",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Xx,{user:r}),e.jsx(eu,{user:r})]})}),e.jsx(ge,{value:"company",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(eu,{user:r}),r.logo_url&&e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Logo de l'entreprise"}),e.jsx("img",{src:r.logo_url,alt:"Logo de l'entreprise",className:"h-24 w-auto object-contain",onError:o=>{o.currentTarget.style.display="none"}})]})]})}),e.jsx(ge,{value:"documents",className:"space-y-6 mt-6",children:e.jsx(Qx,{userId:r.id,userName:`${r.first_name} ${r.last_name}`,userCompany:r.company})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(P,{onClick:()=>s(!1),children:"Fermer"})})]})})]})}):null},Zx=({user:r,open:t,onOpenChange:s,onSave:n})=>{const[a,i]=x.useState({email:"",full_name:"",first_name:"",last_name:"",phone:"",company:"",city:"",is_admin:!1}),[o,l]=x.useState(!1);x.useEffect(()=>{r&&i({email:r.email||"",full_name:r.full_name||"",first_name:r.first_name||"",last_name:r.last_name||"",phone:r.phone||"",company:r.company||"",city:r.address_city||"",is_admin:!1})},[r]);const c=async()=>{if(r){l(!0);try{await n(r.id,a)&&s(!1)}finally{l(!1)}}},u=(d,h)=>{i(m=>({...m,[d]:h}))};return r?e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(ze,{className:"max-w-md",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Modifier l'utilisateur"}),e.jsxs(He,{children:["Modifiez les informations de ",r.first_name," ",r.last_name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(te,{htmlFor:"email",children:"Email"}),e.jsx(I,{id:"email",type:"email",value:a.email,onChange:d=>u("email",d.target.value),placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"full_name",children:"Nom complet"}),e.jsx(I,{id:"full_name",value:a.full_name,onChange:d=>u("full_name",d.target.value),placeholder:"Nom complet"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{htmlFor:"first_name",children:"Prénom"}),e.jsx(I,{id:"first_name",value:a.first_name,onChange:d=>u("first_name",d.target.value),placeholder:"Prénom"})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"last_name",children:"Nom"}),e.jsx(I,{id:"last_name",value:a.last_name,onChange:d=>u("last_name",d.target.value),placeholder:"Nom"})]})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"phone",children:"Téléphone"}),e.jsx(I,{id:"phone",value:a.phone,onChange:d=>u("phone",d.target.value),placeholder:"+33 1 23 45 67 89"})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"company",children:"Entreprise"}),e.jsx(I,{id:"company",value:a.company,onChange:d=>u("company",d.target.value),placeholder:"Nom de l'entreprise"})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"city",children:"Ville"}),e.jsx(I,{id:"city",value:a.city,onChange:d=>u("city",d.target.value),placeholder:"Ville"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nt,{id:"is_admin",checked:a.is_admin,onCheckedChange:d=>u("is_admin",d),disabled:!0}),e.jsx(te,{htmlFor:"is_admin",children:"Administrateur (non modifiable)"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{variant:"outline",onClick:()=>s(!1),children:"Annuler"}),e.jsx(P,{onClick:c,disabled:o,children:o?"Sauvegarde...":"Sauvegarder"})]})]})}):null},ey=({user:r,open:t,onOpenChange:s,onDelete:n})=>{const[a,i]=x.useState(!1),o=async()=>{if(r){i(!0);try{await n(r.id)&&s(!1)}finally{i(!1)}}};return r?e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(ze,{className:"max-w-md",children:[e.jsxs(Ue,{children:[e.jsxs(Be,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Qs,{className:"h-5 w-5"}),"Supprimer l'utilisateur"]}),e.jsx(He,{children:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est irréversible."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("p",{className:"font-medium",children:"Utilisateur à supprimer :"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nom :"})," ",r.first_name," ",r.last_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email :"})," ",r.email]}),r.company&&e.jsxs("p",{children:[e.jsx("strong",{children:"Entreprise :"})," ",r.company]})]})}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["⚠️ ",e.jsx("strong",{children:"Attention :"})," Toutes les données associées à cet utilisateur seront définitivement supprimées."]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{variant:"outline",onClick:()=>s(!1),children:"Annuler"}),e.jsx(P,{variant:"destructive",onClick:o,disabled:a,children:a?"Suppression...":"Supprimer définitivement"})]})]})}):null},ry=()=>{const{users:r,loading:t,getUserById:s,updateUser:n,deleteUser:a}=Wx(),[i,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[h,m]=x.useState(!1),p=async g=>{const _=await s(g.id);o(_||g),c(!0)},f=g=>{o(g),d(!0)},v=g=>{o(g),m(!0)},y=async(g,_)=>await n(g,_),j=async g=>await a(g);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des utilisateurs"})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(V,{children:"Liste des utilisateurs"})}),e.jsx(W,{children:t?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("p",{children:"Chargement des utilisateurs..."})}):r.length===0?e.jsx("p",{className:"text-center py-4",children:"Aucun utilisateur trouvé."}):e.jsx(Vx,{users:r,onViewDetails:p,onEdit:f,onDelete:v})})]}),e.jsx(Jx,{user:i,open:l,onOpenChange:c}),e.jsx(Zx,{user:i,open:u,onOpenChange:d,onSave:y}),e.jsx(ey,{user:i,open:h,onOpenChange:m,onDelete:j})]})};var rf=["PageUp","PageDown"],tf=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sf={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},qt="Slider",[Ol,ty,sy]=dg(qt),[nf,lE]=kp(qt,[sy]),[ny,gn]=nf(qt),af=x.forwardRef((r,t)=>{const{name:s,min:n=0,max:a=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[n],value:d,onValueChange:h=()=>{},onValueCommit:m=()=>{},inverted:p=!1,form:f,...v}=r,y=x.useRef(new Set),j=x.useRef(0),_=o==="horizontal"?ay:iy,[b=[],N]=ug({prop:d,defaultProp:u,onChange:R=>{var T;(T=[...y.current][j.current])==null||T.focus(),h(R)}}),w=x.useRef(b);function E(R){const O=dy(b,R);D(R,O)}function S(R){D(R,j.current)}function C(){const R=w.current[j.current];b[j.current]!==R&&m(b)}function D(R,O,{commit:T}={commit:!1}){const q=fy(i),$=vy(Math.round((R-n)/i)*i+n,q),z=Xl($,[n,a]);N((J=[])=>{const ne=cy(J,z,O);if(py(ne,c*i)){j.current=ne.indexOf(z);const le=String(ne)!==String(J);return le&&T&&m(ne),le?ne:J}else return J})}return e.jsx(ny,{scope:r.__scopeSlider,name:s,disabled:l,min:n,max:a,valueIndexToChangeRef:j,thumbs:y.current,values:b,orientation:o,form:f,children:e.jsx(Ol.Provider,{scope:r.__scopeSlider,children:e.jsx(Ol.Slot,{scope:r.__scopeSlider,children:e.jsx(_,{"aria-disabled":l,"data-disabled":l?"":void 0,...v,ref:t,onPointerDown:We(v.onPointerDown,()=>{l||(w.current=b)}),min:n,max:a,inverted:p,onSlideStart:l?void 0:E,onSlideMove:l?void 0:S,onSlideEnd:l?void 0:C,onHomeKeyDown:()=>!l&&D(n,0,{commit:!0}),onEndKeyDown:()=>!l&&D(a,b.length-1,{commit:!0}),onStepKeyDown:({event:R,direction:O})=>{if(!l){const $=rf.includes(R.key)||R.shiftKey&&tf.includes(R.key)?10:1,z=j.current,J=b[z],ne=i*$*O;D(J+ne,z,{commit:!0})}}})})})})});af.displayName=qt;var[of,lf]=nf(qt,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ay=x.forwardRef((r,t)=>{const{min:s,max:n,dir:a,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:u,...d}=r,[h,m]=x.useState(null),p=er(t,_=>m(_)),f=x.useRef(void 0),v=Dp(a),y=v==="ltr",j=y&&!i||!y&&i;function g(_){const b=f.current||h.getBoundingClientRect(),N=[0,b.width],E=Zl(N,j?[s,n]:[n,s]);return f.current=b,E(_-b.left)}return e.jsx(of,{scope:r.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:e.jsx(cf,{dir:v,"data-orientation":"horizontal",...d,ref:p,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const b=g(_.clientX);o==null||o(b)},onSlideMove:_=>{const b=g(_.clientX);l==null||l(b)},onSlideEnd:()=>{f.current=void 0,c==null||c()},onStepKeyDown:_=>{const N=sf[j?"from-left":"from-right"].includes(_.key);u==null||u({event:_,direction:N?-1:1})}})})}),iy=x.forwardRef((r,t)=>{const{min:s,max:n,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=r,d=x.useRef(null),h=er(t,d),m=x.useRef(void 0),p=!a;function f(v){const y=m.current||d.current.getBoundingClientRect(),j=[0,y.height],_=Zl(j,p?[n,s]:[s,n]);return m.current=y,_(v-y.top)}return e.jsx(of,{scope:r.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:e.jsx(cf,{"data-orientation":"vertical",...u,ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const y=f(v.clientY);i==null||i(y)},onSlideMove:v=>{const y=f(v.clientY);o==null||o(y)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:v=>{const j=sf[p?"from-bottom":"from-top"].includes(v.key);c==null||c({event:v,direction:j?-1:1})}})})}),cf=x.forwardRef((r,t)=>{const{__scopeSlider:s,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c,...u}=r,d=gn(qt,s);return e.jsx(cr.span,{...u,ref:t,onKeyDown:We(r.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):rf.concat(tf).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:We(r.onPointerDown,h=>{const m=h.target;m.setPointerCapture(h.pointerId),h.preventDefault(),d.thumbs.has(m)?m.focus():n(h)}),onPointerMove:We(r.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&a(h)}),onPointerUp:We(r.onPointerUp,h=>{const m=h.target;m.hasPointerCapture(h.pointerId)&&(m.releasePointerCapture(h.pointerId),i(h))})})}),uf="SliderTrack",df=x.forwardRef((r,t)=>{const{__scopeSlider:s,...n}=r,a=gn(uf,s);return e.jsx(cr.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...n,ref:t})});df.displayName=uf;var Il="SliderRange",mf=x.forwardRef((r,t)=>{const{__scopeSlider:s,...n}=r,a=gn(Il,s),i=lf(Il,s),o=x.useRef(null),l=er(t,o),c=a.values.length,u=a.values.map(m=>ff(m,a.min,a.max)),d=c>1?Math.min(...u):0,h=100-Math.max(...u);return e.jsx(cr.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...n,ref:l,style:{...r.style,[i.startEdge]:d+"%",[i.endEdge]:h+"%"}})});mf.displayName=Il;var ql="SliderThumb",hf=x.forwardRef((r,t)=>{const s=ty(r.__scopeSlider),[n,a]=x.useState(null),i=er(t,l=>a(l)),o=x.useMemo(()=>n?s().findIndex(l=>l.ref.current===n):-1,[s,n]);return e.jsx(oy,{...r,ref:i,index:o})}),oy=x.forwardRef((r,t)=>{const{__scopeSlider:s,index:n,name:a,...i}=r,o=gn(ql,s),l=lf(ql,s),[c,u]=x.useState(null),d=er(t,g=>u(g)),h=c?o.form||!!c.closest("form"):!0,m=mg(c),p=o.values[n],f=p===void 0?0:ff(p,o.min,o.max),v=uy(n,o.values.length),y=m==null?void 0:m[l.size],j=y?my(y,f,l.direction):0;return x.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${f}% + ${j}px)`},children:[e.jsx(Ol.ItemSlot,{scope:r.__scopeSlider,children:e.jsx(cr.span,{role:"slider","aria-label":r["aria-label"]||v,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:d,style:p===void 0?{display:"none"}:r.style,onFocus:We(r.onFocus,()=>{o.valueIndexToChangeRef.current=n})})}),h&&e.jsx(pf,{name:a??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:p},n)]})});hf.displayName=ql;var ly="RadioBubbleInput",pf=x.forwardRef(({__scopeSlider:r,value:t,...s},n)=>{const a=x.useRef(null),i=er(a,n),o=hg(t);return x.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&d){const h=new Event("input",{bubbles:!0});d.call(l,t),l.dispatchEvent(h)}},[o,t]),e.jsx(cr.input,{style:{display:"none"},...s,ref:i,defaultValue:t})});pf.displayName=ly;function cy(r=[],t,s){const n=[...r];return n[s]=t,n.sort((a,i)=>a-i)}function ff(r,t,s){const i=100/(s-t)*(r-t);return Xl(i,[0,100])}function uy(r,t){return t>2?`Value ${r+1} of ${t}`:t===2?["Minimum","Maximum"][r]:void 0}function dy(r,t){if(r.length===1)return 0;const s=r.map(a=>Math.abs(a-t)),n=Math.min(...s);return s.indexOf(n)}function my(r,t,s){const n=r/2,i=Zl([0,50],[0,n]);return(n-i(t)*s)*s}function hy(r){return r.slice(0,-1).map((t,s)=>r[s+1]-t)}function py(r,t){if(t>0){const s=hy(r);return Math.min(...s)>=t}return!0}function Zl(r,t){return s=>{if(r[0]===r[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(r[1]-r[0]);return t[0]+n*(s-r[0])}}function fy(r){return(String(r).split(".")[1]||"").length}function vy(r,t){const s=Math.pow(10,t);return Math.round(r*s)/s}var vf=af,gy=df,xy=mf,yy=hf;const xn=x.forwardRef(({className:r,...t},s)=>e.jsxs(vf,{ref:s,className:se("relative flex w-full touch-none select-none items-center",r),...t,children:[e.jsx(gy,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(xy,{className:"absolute h-full bg-primary"})}),e.jsx(yy,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));xn.displayName=vf.displayName;const by=({control:r})=>e.jsx(Z,{control:r,name:"capacity",render:({field:t})=>e.jsxs(G,{children:[e.jsxs(H,{children:["Capacité: ",t.value," personnes"]}),e.jsx(Y,{children:e.jsx(xn,{min:1,max:50,step:1,value:[t.value],onValueChange:s=>{t.onChange(s[0])}})}),e.jsx(ee,{})]})}),jy=({control:r,onPricingTypeChange:t,defaultValue:s="hourly"})=>e.jsx(Z,{control:r,name:"pricing_type",render:()=>e.jsxs(G,{className:"space-y-3",children:[e.jsx(H,{children:"Type de tarification"}),e.jsx(Y,{children:e.jsxs(qp,{onValueChange:n=>t(n),defaultValue:s,className:"flex flex-col space-y-1",children:[e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"hourly"})}),e.jsx(H,{className:"font-normal",children:"Tarif horaire"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"daily"})}),e.jsx(H,{className:"font-normal",children:"Tarif journalier"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"monthly"})}),e.jsx(H,{className:"font-normal",children:"Tarif mensuel"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"yearly"})}),e.jsx(H,{className:"font-normal",children:"Tarif annuel"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"half_day"})}),e.jsx(H,{className:"font-normal",children:"Tarif demi-journée"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"quarter"})}),e.jsx(H,{className:"font-normal",children:"Tarif trimestriel"})]}),e.jsxs(G,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(Y,{children:e.jsx(Sr,{value:"custom"})}),e.jsx(H,{className:"font-normal",children:"Tarif personnalisé"})]})]})}),e.jsx(ee,{})]})}),As=({control:r,pricingType:t,onTimeSlotsChange:s})=>{const[n,a]=x.useState([]),i=()=>{const u={id:Date.now().toString(),startTime:"09:00",endTime:"17:00",label:""},d=[...n,u];a(d),s==null||s(d)},o=u=>{const d=n.filter(h=>h.id!==u);a(d),s==null||s(d)},l=(u,d,h)=>{const m=n.map(p=>p.id===u?{...p,[d]:h}:p);a(m),s==null||s(m)},c=()=>{let u=[];switch(t){case"hourly":u=[{id:"1",startTime:"09:00",endTime:"10:00",label:"09:00 - 10:00"},{id:"2",startTime:"10:00",endTime:"11:00",label:"10:00 - 11:00"},{id:"3",startTime:"11:00",endTime:"12:00",label:"11:00 - 12:00"},{id:"4",startTime:"14:00",endTime:"15:00",label:"14:00 - 15:00"},{id:"5",startTime:"15:00",endTime:"16:00",label:"15:00 - 16:00"},{id:"6",startTime:"16:00",endTime:"17:00",label:"16:00 - 17:00"}];break;case"half_day":u=[{id:"morning",startTime:"09:00",endTime:"13:00",label:"Matin (9h-13h)"},{id:"afternoon",startTime:"14:00",endTime:"18:00",label:"Après-midi (14h-18h)"}];break;case"daily":u=[{id:"full-day",startTime:"09:00",endTime:"18:00",label:"Journée complète (9h-18h)"}];break;case"monthly":case"quarter":case"yearly":u=[{id:"full-period",startTime:"00:00",endTime:"23:59",label:"Période complète"}];break;case"custom":u=[{id:"custom-1",startTime:"09:00",endTime:"17:00",label:"Période personnalisée"}];break}a(u)};return x.useEffect(()=>{n.length===0&&c()},[t]),t==="hourly"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(H,{children:"Créneaux horaires disponibles"}),e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:i,children:[e.jsx(Rr,{className:"h-4 w-4 mr-2"}),"Ajouter un créneau"]})]}),n.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[e.jsx(I,{type:"time",value:u.startTime,onChange:d=>l(u.id,"startTime",d.target.value),placeholder:"Début"}),e.jsx(I,{type:"time",value:u.endTime,onChange:d=>l(u.id,"endTime",d.target.value),placeholder:"Fin"}),e.jsx(I,{value:u.label,onChange:d=>l(u.id,"label",d.target.value),placeholder:"Libellé (ex: 9h-10h)"})]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>o(u.id),children:e.jsx(mr,{className:"h-4 w-4"})})]},u.id))]}):t==="half_day"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{children:"Créneaux demi-journée"}),n.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[e.jsx(I,{type:"time",value:u.startTime,onChange:d=>l(u.id,"startTime",d.target.value),placeholder:"Début"}),e.jsx(I,{type:"time",value:u.endTime,onChange:d=>l(u.id,"endTime",d.target.value),placeholder:"Fin"}),e.jsx(I,{value:u.label,onChange:d=>l(u.id,"label",d.target.value),placeholder:"Libellé"})]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>o(u.id),children:e.jsx(mr,{className:"h-4 w-4"})})]},u.id))]}):t==="daily"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{children:"Créneaux journaliers"}),n.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[e.jsx(I,{type:"time",value:u.startTime,onChange:d=>l(u.id,"startTime",d.target.value),placeholder:"Début"}),e.jsx(I,{type:"time",value:u.endTime,onChange:d=>l(u.id,"endTime",d.target.value),placeholder:"Fin"}),e.jsx(I,{value:u.label,onChange:d=>l(u.id,"label",d.target.value),placeholder:"Libellé"})]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>o(u.id),children:e.jsx(mr,{className:"h-4 w-4"})})]},u.id))]}):t==="custom"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(H,{children:"Créneaux personnalisés"}),e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:i,children:[e.jsx(Rr,{className:"h-4 w-4 mr-2"}),"Ajouter un créneau"]})]}),n.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[e.jsx(I,{type:"time",value:u.startTime,onChange:d=>l(u.id,"startTime",d.target.value),placeholder:"Début"}),e.jsx(I,{type:"time",value:u.endTime,onChange:d=>l(u.id,"endTime",d.target.value),placeholder:"Fin"}),e.jsx(I,{value:u.label,onChange:d=>l(u.id,"label",d.target.value),placeholder:"Libellé"})]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>o(u.id),children:e.jsx(mr,{className:"h-4 w-4"})})]},u.id))]}):null},Qr=({control:r,name:t,label:s,step:n=.5})=>e.jsx(Z,{control:r,name:t,render:({field:a})=>{const i=isNaN(a.value)||a.value===void 0?0:a.value,o=i*1.2;return e.jsxs(G,{children:[e.jsx(H,{children:s}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{children:e.jsx(I,{type:"number",min:0,step:n,value:i,onChange:l=>a.onChange(parseFloat(l.target.value))})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Prix TTC: ",o.toLocaleString("fr-FR",{minimumFractionDigits:2})," €"]})]}),e.jsx(ee,{})]})}}),wy=({control:r,pricingType:t,onTimeSlotsChange:s})=>t==="hourly"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qr,{control:r,name:"hourly_price",label:"Prix horaire HT (€)",step:.5}),e.jsx(As,{control:r,pricingType:t,onTimeSlotsChange:s})]}):t==="daily"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qr,{control:r,name:"daily_price",label:"Prix journalier HT (€)",step:1}),e.jsx(As,{control:r,pricingType:t,onTimeSlotsChange:s})]}):t==="monthly"?e.jsx(Qr,{control:r,name:"monthly_price",label:"Prix mensuel HT (€)",step:10}):t==="half_day"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Qr,{control:r,name:"half_day_price",label:"Prix demi-journée HT (€)",step:.5}),e.jsx(As,{control:r,pricingType:t,onTimeSlotsChange:s})]}):t==="quarter"?e.jsx(Qr,{control:r,name:"quarter_price",label:"Prix trimestriel HT (€)",step:1}):t==="yearly"?e.jsx(Qr,{control:r,name:"yearly_price",label:"Prix annuel HT (€)",step:100}):t==="custom"?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{control:r,name:"custom_label",render:({field:n})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nom de la période"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Par semaine, par événement, etc.",...n})}),e.jsx(ee,{})]})}),e.jsx(Qr,{control:r,name:"custom_price",label:"Prix personnalisé HT (€)",step:1}),e.jsx(As,{control:r,pricingType:t,onTimeSlotsChange:s})]}):null,_y=({control:r})=>e.jsx(Z,{control:r,name:"is_active",render:({field:t})=>e.jsxs(G,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(H,{children:"Disponible"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"L'espace sera visible et disponible à la réservation"})]}),e.jsx(Y,{children:e.jsx(Nt,{checked:t.value,onCheckedChange:t.onChange})})]})}),Sy=({onImageChange:r,imagePreview:t,isUploading:s=!1})=>{const[n,a]=x.useState(!1),i=c=>{c.preventDefault(),c.stopPropagation(),c.type==="dragenter"||c.type==="dragover"?a(!0):c.type==="dragleave"&&a(!1)},o=c=>{if(c.preventDefault(),c.stopPropagation(),a(!1),c.dataTransfer.files&&c.dataTransfer.files[0]){const u=document.getElementById("imageUpload");if(u){u.files=c.dataTransfer.files;const d=new Event("change",{bubbles:!0});u.dispatchEvent(d)}}},l=()=>{const c=document.getElementById("imageUpload");c&&(c.value="");const u=new Event("change",{bubbles:!0});c&&c.dispatchEvent(u)};return e.jsx(G,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`
            relative border-2 border-dashed rounded-lg p-6 text-center transition-colors
            ${n?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}
            ${s?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,onDragEnter:i,onDragLeave:i,onDragOver:i,onDrop:o,children:[e.jsx("input",{id:"imageUpload",type:"file",accept:"image/*",onChange:r,disabled:s,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed"}),e.jsx("div",{className:"flex flex-col items-center gap-2",children:s?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Upload en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Mg,{className:"h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Glissez-déposez une image ici ou cliquez pour sélectionner"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG, WebP • Max 5MB"})]})})]}),t&&e.jsxs("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border",children:[e.jsx("img",{src:t,alt:"Prévisualisation de l'espace",className:"w-full h-full object-cover"}),e.jsx(P,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:l,disabled:s,children:e.jsx(or,{className:"h-4 w-4"})})]})]})})},Ny=(r=null)=>{const[t,s]=x.useState(null),[n,a]=x.useState(r),[i,o]=x.useState(!1),l=d=>{var p;const h=(p=d.target.files)==null?void 0:p[0];if(!h)return;if(h.size>5*1024*1024){k.error("L'image ne doit pas dépasser 5MB");return}s(h);const m=URL.createObjectURL(h);a(m)},c=async d=>{try{o(!0);const h=await u(d),m=await new Promise((p,f)=>{const v=new FileReader;v.onload=()=>{typeof v.result=="string"?p(v.result):f(new Error("Erreur lors de la conversion de l'image"))},v.onerror=()=>f(new Error("Erreur lors de la lecture du fichier")),v.readAsDataURL(h)});return a(m),m}catch(h){throw console.error("Erreur lors de l'upload de l'image:",h),k.error("Impossible d'uploader l'image"),h}finally{o(!1)}},u=d=>new Promise(h=>{const m=document.createElement("canvas"),p=m.getContext("2d"),f=new Image;f.onload=()=>{let{width:j,height:g}=f;j>g?j>800&&(g=g*800/j,j=800):g>600&&(j=j*600/g,g=600),m.width=j,m.height=g,p==null||p.drawImage(f,0,0,j,g),m.toBlob(_=>{if(_){const b=new File([_],d.name,{type:"image/jpeg",lastModified:Date.now()});h(b)}else h(d)},"image/jpeg",.8)},f.src=URL.createObjectURL(d)});return{selectedImage:t,imagePreview:n,isUploading:i,handleImageChange:l,uploadImage:c}},Ey=({form:r})=>{const{control:t,setValue:s,trigger:n}=r,[a,i]=x.useState(!1),{imagePreview:o,uploadImage:l}=Ny(),c=zg({control:t,name:"image_url"}),u=async d=>{var m;const h=(m=d.target.files)==null?void 0:m[0];if(h){i(!0);try{const p=await l(h);s("image_url",p),n("image_url")}catch(p){console.error("Erreur lors de l'upload de l'image:",p)}finally{i(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{control:t,name:"name",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nom de l'espace"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Salle de réunion 1",...d})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:t,name:"description",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Description"}),e.jsx(Y,{children:e.jsx(_e,{placeholder:"Description de l'espace...",...d,value:d.value||"",onChange:h=>{const m=h.target.value;d.onChange(m),m.trim()===""&&m!==""&&d.onChange("")}})}),e.jsx(ee,{}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Laissez vide si vous n'avez pas de description spécifique."})]})}),e.jsx(Z,{control:t,name:"image_url",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Image de l'espace"}),e.jsx(Y,{children:e.jsx(Sy,{onImageChange:u,imagePreview:o||c,isUploading:a})}),e.jsx(ee,{})]})})]})},Cy=ct({id:me().optional(),name:me().min(2,{message:"Le nom doit contenir au moins 2 caractères."}),description:me().optional(),capacity:ar().min(1,{message:"La capacité doit être d'au moins 1 personne."}),hourly_price:ar().min(0,{message:"Le prix horaire ne peut pas être négatif."}),daily_price:ar().min(0,{message:"Le prix journalier ne peut pas être négatif."}),half_day_price:ar().min(0,{message:"Le prix demi-journée ne peut pas être négatif."}),monthly_price:ar().min(0,{message:"Le prix mensuel ne peut pas être négatif."}),quarter_price:ar().min(0,{message:"Le prix trimestriel ne peut pas être négatif."}),yearly_price:ar().min(0,{message:"Le prix annuel ne peut pas être négatif."}),custom_price:ar().min(0,{message:"Le prix ne peut pas être négatif."}),custom_label:me().optional(),pricing_type:Hg(["hourly","daily","half_day","monthly","quarter","yearly","custom"]),is_active:Bg().default(!0),image_url:me().optional(),time_slots:Ug(ct({id:me(),startTime:me(),endTime:me(),label:me()})).optional()}).refine(r=>{switch(r.pricing_type){case"hourly":return r.hourly_price>0||{message:"Le prix horaire doit être supérieur à 0"};case"daily":return r.daily_price>0||{message:"Le prix journalier doit être supérieur à 0"};case"half_day":return r.half_day_price>0||{message:"Le prix demi-journée doit être supérieur à 0"};case"monthly":return r.monthly_price>0||{message:"Le prix mensuel doit être supérieur à 0"};case"quarter":return r.quarter_price>0||{message:"Le prix trimestriel doit être supérieur à 0"};case"yearly":return r.yearly_price>0||{message:"Le prix annuel doit être supérieur à 0"};case"custom":return r.custom_price>0||{message:"Le prix personnalisé doit être supérieur à 0"};default:return!0}},{message:"Le prix correspondant au type de tarification doit être supérieur à 0",path:["pricing_type"]}),Ty=({defaultValues:r,onSubmit:t,onSuccess:s})=>{const n=yt({resolver:It(Cy),defaultValues:{id:(r==null?void 0:r.id)??"",name:(r==null?void 0:r.name)??"",description:(r==null?void 0:r.description)??"",capacity:(r==null?void 0:r.capacity)??1,hourly_price:(r==null?void 0:r.hourly_price)??0,daily_price:(r==null?void 0:r.daily_price)??0,half_day_price:(r==null?void 0:r.half_day_price)??0,monthly_price:(r==null?void 0:r.monthly_price)??0,quarter_price:(r==null?void 0:r.quarter_price)??0,yearly_price:(r==null?void 0:r.yearly_price)??0,custom_price:(r==null?void 0:r.custom_price)??0,custom_label:(r==null?void 0:r.custom_label)??"",pricing_type:(r==null?void 0:r.pricing_type)??"hourly",is_active:(r==null?void 0:r.is_active)??!0,image_url:(r==null?void 0:r.image_url)??"",time_slots:(r==null?void 0:r.time_slots)??[]}});x.useEffect(()=>{r?n.reset({id:r.id??"",name:r.name??"",description:r.description??"",capacity:r.capacity??1,hourly_price:r.hourly_price??0,daily_price:r.daily_price??0,half_day_price:r.half_day_price??0,monthly_price:r.monthly_price??0,quarter_price:r.quarter_price??0,yearly_price:r.yearly_price??0,custom_price:r.custom_price??0,custom_label:r.custom_label??"",pricing_type:r.pricing_type??"hourly",is_active:r.is_active??!0,image_url:r.image_url??"",time_slots:r.time_slots??[]}):n.reset({id:"",name:"",description:"",capacity:1,hourly_price:0,daily_price:0,half_day_price:0,monthly_price:0,quarter_price:0,yearly_price:0,custom_price:0,custom_label:"",pricing_type:"hourly",is_active:!0,image_url:"",time_slots:[]})},[r,n]);const a=async i=>{try{await t(i),n.reset(),s&&s()}catch(o){console.error("Error submitting space form:",o),k.error("Une erreur est survenue lors de l'enregistrement de l'espace")}};return{form:n,handleSubmit:n.handleSubmit(a)}};function Ry({defaultValues:r,onSubmit:t,onCancel:s,isSubmitting:n}){const{form:a,handleSubmit:i}=Ty({defaultValues:r,onSubmit:t}),[o,l]=x.useState((r==null?void 0:r.pricing_type)||"hourly"),[c,u]=x.useState([]),d=m=>{l(m),a.setValue("pricing_type",m)},h=m=>{u(m),a.setValue("time_slots",m)};return a?e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(V,{children:"Informations de l'espace"})}),e.jsx(W,{children:e.jsx(Ot,{...a,children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx(Ey,{form:a}),e.jsx(by,{control:a.control}),e.jsx(jy,{control:a.control,onPricingTypeChange:d,defaultValue:o}),e.jsx(wy,{control:a.control,pricingType:o,onTimeSlotsChange:h}),e.jsx(_y,{control:a.control}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[s&&e.jsx(P,{type:"button",variant:"outline",onClick:s,children:"Annuler"}),e.jsx(P,{type:"submit",disabled:n,children:n?"Enregistrement...":"Enregistrer"})]})]})})})]}):(console.error("[SpaceForm] form est null ou undefined !",a),e.jsx("div",{className:"text-red-500",children:"Erreur critique du formulaire. Veuillez recharger la page."}))}function Ay(r,t){return x.useReducer((s,n)=>t[s][n]??s,r)}var ec="ScrollArea",[gf,cE]=kp(ec),[ky,rr]=gf(ec),xf=x.forwardRef((r,t)=>{const{__scopeScrollArea:s,type:n="hover",dir:a,scrollHideDelay:i=600,...o}=r,[l,c]=x.useState(null),[u,d]=x.useState(null),[h,m]=x.useState(null),[p,f]=x.useState(null),[v,y]=x.useState(null),[j,g]=x.useState(0),[_,b]=x.useState(0),[N,w]=x.useState(!1),[E,S]=x.useState(!1),C=er(t,R=>c(R)),D=Dp(a);return e.jsx(ky,{scope:s,type:n,dir:D,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:m,scrollbarX:p,onScrollbarXChange:f,scrollbarXEnabled:N,onScrollbarXEnabledChange:w,scrollbarY:v,onScrollbarYChange:y,scrollbarYEnabled:E,onScrollbarYEnabledChange:S,onCornerWidthChange:g,onCornerHeightChange:b,children:e.jsx(cr.div,{dir:D,...o,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":_+"px",...r.style}})})});xf.displayName=ec;var yf="ScrollAreaViewport",bf=x.forwardRef((r,t)=>{const{__scopeScrollArea:s,children:n,nonce:a,...i}=r,o=rr(yf,s),l=x.useRef(null),c=er(t,l,o.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(cr.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...r.style},children:e.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});bf.displayName=yf;var xr="ScrollAreaScrollbar",rc=x.forwardRef((r,t)=>{const{forceMount:s,...n}=r,a=rr(xr,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=r.orientation==="horizontal";return x.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?e.jsx(Dy,{...n,ref:t,forceMount:s}):a.type==="scroll"?e.jsx(Py,{...n,ref:t,forceMount:s}):a.type==="auto"?e.jsx(jf,{...n,ref:t,forceMount:s}):a.type==="always"?e.jsx(tc,{...n,ref:t}):null});rc.displayName=xr;var Dy=x.forwardRef((r,t)=>{const{forceMount:s,...n}=r,a=rr(xr,r.__scopeScrollArea),[i,o]=x.useState(!1);return x.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(hn,{present:s||i,children:e.jsx(jf,{"data-state":i?"visible":"hidden",...n,ref:t})})}),Py=x.forwardRef((r,t)=>{const{forceMount:s,...n}=r,a=rr(xr,r.__scopeScrollArea),i=r.orientation==="horizontal",o=bn(()=>c("SCROLL_END"),100),[l,c]=Ay("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,a.scrollHideDelay,c]),x.useEffect(()=>{const u=a.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const m=()=>{const p=u[d];h!==p&&(c("SCROLL"),o()),h=p};return u.addEventListener("scroll",m),()=>u.removeEventListener("scroll",m)}},[a.viewport,i,c,o]),e.jsx(hn,{present:s||l!=="hidden",children:e.jsx(tc,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:We(r.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:We(r.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),jf=x.forwardRef((r,t)=>{const s=rr(xr,r.__scopeScrollArea),{forceMount:n,...a}=r,[i,o]=x.useState(!1),l=r.orientation==="horizontal",c=bn(()=>{if(s.viewport){const u=s.viewport.offsetWidth<s.viewport.scrollWidth,d=s.viewport.offsetHeight<s.viewport.scrollHeight;o(l?u:d)}},10);return Tt(s.viewport,c),Tt(s.content,c),e.jsx(hn,{present:n||i,children:e.jsx(tc,{"data-state":i?"visible":"hidden",...a,ref:t})})}),tc=x.forwardRef((r,t)=>{const{orientation:s="vertical",...n}=r,a=rr(xr,r.__scopeScrollArea),i=x.useRef(null),o=x.useRef(0),[l,c]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=Ef(l.viewport,l.content),d={...n,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m};function h(m,p){return Fy(m,o.current,l,p)}return s==="horizontal"?e.jsx(My,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollLeft,p=tu(m,l,a.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=h(m,a.dir))}}):s==="vertical"?e.jsx(Oy,{...d,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollTop,p=tu(m,l);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=h(m))}}):null}),My=x.forwardRef((r,t)=>{const{sizes:s,onSizesChange:n,...a}=r,i=rr(xr,r.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),u=er(t,c,i.onScrollbarXChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(_f,{"data-orientation":"horizontal",...a,ref:u,sizes:s,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":yn(s)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const m=i.viewport.scrollLeft+d.deltaX;r.onWheelScroll(m),Tf(m,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:tn(o.paddingLeft),paddingEnd:tn(o.paddingRight)}})}})}),Oy=x.forwardRef((r,t)=>{const{sizes:s,onSizesChange:n,...a}=r,i=rr(xr,r.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),u=er(t,c,i.onScrollbarYChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(_f,{"data-orientation":"vertical",...a,ref:u,sizes:s,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":yn(s)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const m=i.viewport.scrollTop+d.deltaY;r.onWheelScroll(m),Tf(m,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:tn(o.paddingTop),paddingEnd:tn(o.paddingBottom)}})}})}),[Iy,wf]=gf(xr),_f=x.forwardRef((r,t)=>{const{__scopeScrollArea:s,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...m}=r,p=rr(xr,s),[f,v]=x.useState(null),y=er(t,C=>v(C)),j=x.useRef(null),g=x.useRef(""),_=p.viewport,b=n.content-n.viewport,N=Jr(d),w=Jr(c),E=bn(h,10);function S(C){if(j.current){const D=C.clientX-j.current.left,R=C.clientY-j.current.top;u({x:D,y:R})}}return x.useEffect(()=>{const C=D=>{const R=D.target;(f==null?void 0:f.contains(R))&&N(D,b)};return document.addEventListener("wheel",C,{passive:!1}),()=>document.removeEventListener("wheel",C,{passive:!1})},[_,f,b,N]),x.useEffect(w,[n,w]),Tt(f,E),Tt(p.content,E),e.jsx(Iy,{scope:s,scrollbar:f,hasThumb:a,onThumbChange:Jr(i),onThumbPointerUp:Jr(o),onThumbPositionChange:w,onThumbPointerDown:Jr(l),children:e.jsx(cr.div,{...m,ref:y,style:{position:"absolute",...m.style},onPointerDown:We(r.onPointerDown,C=>{C.button===0&&(C.target.setPointerCapture(C.pointerId),j.current=f.getBoundingClientRect(),g.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),S(C))}),onPointerMove:We(r.onPointerMove,S),onPointerUp:We(r.onPointerUp,C=>{const D=C.target;D.hasPointerCapture(C.pointerId)&&D.releasePointerCapture(C.pointerId),document.body.style.webkitUserSelect=g.current,p.viewport&&(p.viewport.style.scrollBehavior=""),j.current=null})})})}),rn="ScrollAreaThumb",Sf=x.forwardRef((r,t)=>{const{forceMount:s,...n}=r,a=wf(rn,r.__scopeScrollArea);return e.jsx(hn,{present:s||a.hasThumb,children:e.jsx(qy,{ref:t,...n})})}),qy=x.forwardRef((r,t)=>{const{__scopeScrollArea:s,style:n,...a}=r,i=rr(rn,s),o=wf(rn,s),{onThumbPositionChange:l}=o,c=er(t,h=>o.onThumbChange(h)),u=x.useRef(void 0),d=bn(()=>{u.current&&(u.current(),u.current=void 0)},100);return x.useEffect(()=>{const h=i.viewport;if(h){const m=()=>{if(d(),!u.current){const p=$y(h,l);u.current=p,l()}};return l(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[i.viewport,d,l]),e.jsx(cr.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:We(r.onPointerDownCapture,h=>{const p=h.target.getBoundingClientRect(),f=h.clientX-p.left,v=h.clientY-p.top;o.onThumbPointerDown({x:f,y:v})}),onPointerUp:We(r.onPointerUp,o.onThumbPointerUp)})});Sf.displayName=rn;var sc="ScrollAreaCorner",Nf=x.forwardRef((r,t)=>{const s=rr(sc,r.__scopeScrollArea),n=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&n?e.jsx(Ly,{...r,ref:t}):null});Nf.displayName=sc;var Ly=x.forwardRef((r,t)=>{const{__scopeScrollArea:s,...n}=r,a=rr(sc,s),[i,o]=x.useState(0),[l,c]=x.useState(0),u=!!(i&&l);return Tt(a.scrollbarX,()=>{var h;const d=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(d),c(d)}),Tt(a.scrollbarY,()=>{var h;const d=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(d),o(d)}),u?e.jsx(cr.div,{...n,ref:t,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function tn(r){return r?parseInt(r,10):0}function Ef(r,t){const s=r/t;return isNaN(s)?0:s}function yn(r){const t=Ef(r.viewport,r.content),s=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-s)*t;return Math.max(n,18)}function Fy(r,t,s,n="ltr"){const a=yn(s),i=a/2,o=t||i,l=a-o,c=s.scrollbar.paddingStart+o,u=s.scrollbar.size-s.scrollbar.paddingEnd-l,d=s.content-s.viewport,h=n==="ltr"?[0,d]:[d*-1,0];return Cf([c,u],h)(r)}function tu(r,t,s="ltr"){const n=yn(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=s==="ltr"?[0,o]:[o*-1,0],u=Xl(r,c);return Cf([0,o],[0,l])(u)}function Cf(r,t){return s=>{if(r[0]===r[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(r[1]-r[0]);return t[0]+n*(s-r[0])}}function Tf(r,t){return r>0&&r<t}var $y=(r,t=()=>{})=>{let s={left:r.scrollLeft,top:r.scrollTop},n=0;return function a(){const i={left:r.scrollLeft,top:r.scrollTop},o=s.left!==i.left,l=s.top!==i.top;(o||l)&&t(),s=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function bn(r,t){const s=Jr(r),n=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),x.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(s,t)},[s,t])}function Tt(r,t){const s=Jr(t);pg(()=>{let n=0;if(r){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(s)});return a.observe(r),()=>{window.cancelAnimationFrame(n),a.unobserve(r)}}},[r,s])}var Rf=xf,zy=bf,Uy=Nf;const Af=x.forwardRef(({className:r,children:t,...s},n)=>e.jsxs(Rf,{ref:n,className:se("relative overflow-hidden",r),...s,children:[e.jsx(zy,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(kf,{}),e.jsx(Uy,{})]}));Af.displayName=Rf.displayName;const kf=x.forwardRef(({className:r,orientation:t="vertical",...s},n)=>e.jsx(rc,{ref:n,orientation:t,className:se("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...s,children:e.jsx(Sf,{className:"relative flex-1 rounded-full bg-border"})}));kf.displayName=rc.displayName;const su=({open:r,onOpenChange:t,onSuccess:s,space:n,mode:a})=>{const[i,o]=x.useState(!1),{user:l}=mn(),c=a==="edit",u=()=>{i||t(!1)},d=async m=>(console.log("⚠️ Synchronisation Stripe désactivée - clés non configurées"),{success:!0,message:"Synchronisation Stripe désactivée"}),h=async m=>{var p;try{if(o(!0),!l)throw new Error("Authentification requise");let f=m.image_url;c&&(!m.image_url||m.image_url==="")&&(f=(n==null?void 0:n.image_url)||null);const v={name:m.name,description:m.description||null,capacity:m.capacity,hourly_price:m.hourly_price,daily_price:m.daily_price,half_day_price:m.half_day_price||0,quarter_price:m.quarter_price||0,monthly_price:m.monthly_price||0,yearly_price:m.yearly_price||0,custom_price:m.custom_price||0,custom_label:m.custom_label||null,is_active:m.is_active,pricing_type:m.pricing_type,image_url:f,price_per_hour:m.hourly_price,created_by:l==null?void 0:l.id};let y,j;if(c&&(n!=null&&n.id)){const g=await B.put(`/spaces/${n.id}`,v);if(!g.success)throw new Error(g.error||"Erreur lors de la mise à jour");j=n.id}else{const g=await B.post("/spaces",v);if(!g.success)throw new Error(g.error||"Erreur lors de la création");if(!((p=g.data)!=null&&p.id))throw new Error("ID de l'espace non retourné par l'API");j=g.data.id}if(j)try{console.log("🚀 Synchronisation automatique avec Stripe..."),await d(j),k.success("Synchronisation avec Stripe réussie !")}catch(g){console.error("⚠️ Erreur lors de la synchronisation Stripe:",g),k.warning("Espace sauvegardé mais erreur Stripe. Vérifiez les logs.")}k.success(c?"Espace mis à jour avec succès":"Espace ajouté avec succès"),u(),s()}catch(f){console.error("Erreur:",f);let v=c?"Impossible de mettre à jour l'espace":"Impossible d'ajouter l'espace";(f==null?void 0:f.code)==="23505"?v="Un espace avec ce nom existe déjà.":f!=null&&f.message&&(v=f.message),k.error(v)}finally{o(!1)}};return e.jsx($e,{open:r,onOpenChange:u,children:e.jsxs(ze,{className:"sm:max-w-[650px] max-h-[90vh] flex flex-col",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:c?"Modifier l'espace":"Ajouter un nouvel espace"}),e.jsxs(He,{children:[c?"Modifiez les informations de l'espace existant.":"Remplissez le formulaire pour ajouter un nouvel espace.",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"L'espace sera automatiquement synchronisé avec le catalogue Stripe."})]})]}),e.jsx(Af,{className:"flex-1 overflow-y-auto pr-4",children:e.jsx(Ry,{defaultValues:n,onSubmit:h,onCancel:u,isSubmitting:i})})]})})};var Is={exports:{}},By=Is.exports,nu;function Hy(){return nu||(nu=1,function(r,t){(function(s,n){n()})(By,function(){function s(u,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function n(u,d,h){var m=new XMLHttpRequest;m.open("GET",u),m.responseType="blob",m.onload=function(){c(m.response,d,h)},m.onerror=function(){console.error("could not download file")},m.send()}function a(u){var d=new XMLHttpRequest;d.open("HEAD",u,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(d)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ur=="object"&&Ur.global===Ur?Ur:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(u,d,h){var m=o.URL||o.webkitURL,p=document.createElement("a");d=d||u.name||"download",p.download=d,p.rel="noopener",typeof u=="string"?(p.href=u,p.origin===location.origin?i(p):a(p.href)?n(u,d,h):i(p,p.target="_blank")):(p.href=m.createObjectURL(u),setTimeout(function(){m.revokeObjectURL(p.href)},4e4),setTimeout(function(){i(p)},0))}:"msSaveOrOpenBlob"in navigator?function(u,d,h){if(d=d||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(s(u,h),d);else if(a(u))n(u,d,h);else{var m=document.createElement("a");m.href=u,m.target="_blank",setTimeout(function(){i(m)})}}:function(u,d,h,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof u=="string")return n(u,d,h);var p=u.type==="application/octet-stream",f=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||p&&f||l)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var _=y.result;_=v?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=_:location=_,m=null},y.readAsDataURL(u)}else{var j=o.URL||o.webkitURL,g=j.createObjectURL(u);m?m.location=g:location.href=g,m=null,setTimeout(function(){j.revokeObjectURL(g)},4e4)}});o.saveAs=c.saveAs=c,r.exports=c})}(Is)),Is.exports}var Df=Hy();const Wy=({spaces:r,onEditSpace:t,onSpacesRefresh:s})=>{const[n,a]=x.useState(null),i=async(u,d)=>{try{a(u);const h=await B.put(`/spaces/${u}`,{is_active:!d});if(!h.success)throw new Error(h.error||"Erreur lors de la mise à jour");k.success(`Espace ${d?"désactivé":"activé"} avec succès`),s()}catch(h){console.error("Error updating space status:",h),k.error("Impossible de mettre à jour l'espace")}finally{a(null)}},o=async u=>{try{a(u);const{error:d}=await supabase.from("stripe_sync_queue").delete().eq("space_id",u);d&&console.warn("Erreur lors du nettoyage de la queue Stripe:",d);const{error:h}=await supabase.from("spaces").delete().eq("id",u);if(h)throw h;k.success("Espace supprimé avec succès"),s()}catch(d){console.error("Error deleting space:",d),(d==null?void 0:d.code)==="23502"?k.error("Impossible de supprimer l'espace : contrainte de base de données"):(d==null?void 0:d.code)==="23503"?k.error("Impossible de supprimer l'espace : références existantes"):k.error("Impossible de supprimer l'espace")}finally{a(null)}},l=u=>{const d=u.pricing_type??"hourly";let h=0,m="";switch(d){case"hourly":h=u.hourly_price,m="/h";break;case"daily":h=u.daily_price,m="/jour";break;case"half_day":h=u.half_day_price||0,m="/demi-j";break;case"monthly":h=u.monthly_price||0,m="/mois";break;case"quarter":h=u.quarter_price||0,m="/trim";break;case"yearly":h=u.yearly_price||0,m="/an";break;case"custom":h=u.custom_price||0,m=u.custom_label?` (${u.custom_label})`:"";break;default:h=u.hourly_price,m="/h"}const p=h*1.2;return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm",children:["HT: ",h.toLocaleString("fr-FR")," €",m]}),e.jsxs("span",{className:"text-sm font-medium",children:["TTC: ",p.toLocaleString("fr-FR")," €",m]})]})},c=u=>{const d=["Product Name","Description","Amount","Currency","Interval","Interval Count","Billing Scheme"],h=u.map(f=>[f.name,f.description||"",f.pricing_type==="hourly"?f.hourly_price:f.pricing_type==="daily"?f.daily_price:f.pricing_type==="half_day"?f.half_day_price:f.pricing_type==="monthly"?f.monthly_price:f.pricing_type==="quarter"?f.quarter_price:f.pricing_type==="yearly"?f.yearly_price:f.custom_price||0,"eur",f.pricing_type==="hourly"||f.pricing_type==="daily"||f.pricing_type==="half_day"?"day":f.pricing_type==="monthly"?"month":f.pricing_type==="quarter"?"quarter":f.pricing_type==="yearly"?"year":"day",1,"per_unit"]),m=[d,...h].map(f=>f.join(",")).join(`
`),p=new Blob([m],{type:"text/csv;charset=utf-8;"});Df.saveAs(p,"export-stripe-espaces.csv")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-end mb-4 gap-2",children:[e.jsx("button",{className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90",onClick:()=>c(r),children:"Exporter CSV Stripe"}),e.jsx("button",{className:"px-4 py-2 bg-green-700 text-white rounded hover:bg-green-800 disabled:opacity-60",disabled:n==="stripe-sync",onClick:async()=>{a("stripe-sync");try{const u=r.map(f=>({space_id:f.id,event_type:"MANUAL_SYNC",payload:{space_id:f.id,space_name:f.name,pricing_type:f.pricing_type,manual_sync:!0},status:"pending"})),{error:d}=await supabase.from("stripe_sync_queue").upsert(u,{onConflict:["space_id","event_type"]});if(d)throw new Error(d.message);const{data:{session:h},error:m}=await supabase.auth.getSession();if(m||!(h!=null&&h.access_token))throw new Error("Session utilisateur non disponible");const p=await fetch("https://exffryodynkyizbeesbt.functions.supabase.co/stripe-sync-queue",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h.access_token}`}});if(!p.ok){const f=await p.text();throw new Error(`Erreur HTTP ${p.status}: ${f}`)}k.success("Synchronisation Stripe lancée pour tous les espaces !"),s()}catch(u){k.error(u.message||"Erreur lors de la synchronisation Stripe")}finally{a(null)}},children:n==="stripe-sync"?"Synchronisation…":"Tout synchroniser"})]}),e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Nom"}),e.jsx(Q,{children:"Capacité"}),e.jsx(Q,{children:"Tarification"}),e.jsx(Q,{children:"Statut"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:r.map(u=>e.jsxs(Ee,{children:[e.jsx(X,{className:"font-medium",children:u.name}),e.jsxs(X,{children:[u.capacity," personnes"]}),e.jsx(X,{children:l(u)}),e.jsx(X,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${u.is_active?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:u.is_active?"Actif":"Inactif"})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>t(u),disabled:n===u.id,children:e.jsx(xt,{size:16})}),e.jsx(P,{variant:u.is_active?"destructive":"default",size:"sm",onClick:()=>i(u.id,u.is_active),disabled:n===u.id,children:n===u.id?"En cours...":u.is_active?e.jsx(Jl,{size:16}):"Activer"}),e.jsx(P,{variant:"destructive",size:"sm",onClick:()=>o(u.id),disabled:n===u.id,title:"Supprimer l'espace",children:"Supprimer"})]})})]},u.id))})]})]})},Gy=({space:r,onEdit:t,onToggleStatus:s,onDelete:n,isProcessing:a})=>{const[i,o]=x.useState(!1),l=async()=>{o(!0);try{const d=await B.get(`/spaces/${r.id}`);if(!d.success)throw new Error(d.error||"Erreur lors de la récupération de l'espace");k.success(`Synchronisation réussie pour "${r.name}"`)}catch(d){k.error("Erreur lors de la synchronisation : "+d.message)}finally{o(!1)}},c=()=>{const d=r.pricing_type??"hourly";let h=0,m="";switch(d){case"hourly":h=r.hourly_price,m="/h";break;case"daily":h=r.daily_price,m="/jour";break;case"half_day":h=r.half_day_price||0,m="/demi-j";break;case"monthly":h=r.monthly_price||0,m="/mois";break;case"quarter":h=r.quarter_price||0,m="/trim";break;case"yearly":h=r.yearly_price||0,m="/an";break;case"custom":h=r.custom_price||0,m=r.custom_label?` (${r.custom_label})`:"";break;default:h=r.hourly_price,m="/h"}const p=h*1.2;return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm",children:["HT: ",h.toLocaleString("fr-FR")," €",m]}),e.jsxs("span",{className:"text-sm font-medium",children:["TTC: ",p.toLocaleString("fr-FR")," €",m]})]})},u=()=>{switch(r.pricing_type){case"hourly":return"Horaire";case"daily":return"Journalier";case"half_day":return"Demi-journée";case"monthly":return"Mensuel";case"quarter":return"Trimestriel";case"yearly":return"Annuel";case"custom":return r.custom_label||"Personnalisé";default:return"Horaire"}};return e.jsxs(U,{className:`overflow-hidden ${r.is_active?"":"opacity-70"}`,children:[r.image_url?e.jsx("div",{className:"h-40 overflow-hidden",children:e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover",onError:d=>{var h;console.error("Erreur chargement image:",r.name,(h=r.image_url)==null?void 0:h.substring(0,100)),d.currentTarget.style.display="none"},onLoad:()=>{console.log("Image chargée avec succès:",r.name)}})}):e.jsx("div",{className:"h-40 bg-gray-50 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"Aucune image"})}),e.jsx(K,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(V,{className:"text-lg",children:r.name}),e.jsx(fe,{variant:r.is_active?"default":"destructive",className:r.is_active?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200",children:r.is_active?"Actif":"Inactif"})]})}),e.jsxs(W,{className:"space-y-3 pb-2",children:[r.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:r.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Et,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:[r.capacity," personnes"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Xs,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:u()})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(lx,{className:"h-4 w-4 text-gray-500"}),c()]})})]}),e.jsxs(Pp,{className:"pt-2 flex justify-between gap-1",children:[e.jsxs(P,{variant:"outline",size:"sm",className:"flex-1 text-xs px-2",onClick:()=>t(r),disabled:a,children:[e.jsx(xt,{className:"h-3 w-3 mr-1"}),"Modifier"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{variant:r.is_active?"destructive":"default",size:"sm",className:"text-xs px-2",onClick:()=>s(r.id,r.is_active),disabled:a,title:r.is_active?"Désactiver l'espace":"Activer l'espace",children:a?e.jsx(je,{className:"h-3 w-3 animate-spin"}):r.is_active?e.jsx(or,{className:"h-3 w-3"}):e.jsx(Tl,{className:"h-3 w-3"})}),e.jsx(P,{variant:"destructive",size:"sm",className:"text-xs px-2",onClick:()=>n(r.id),disabled:a,title:"Supprimer l'espace",children:e.jsx(Jl,{className:"h-3 w-3"})}),e.jsx(P,{variant:"secondary",size:"sm",className:"text-xs px-2",onClick:l,disabled:i,title:"Synchroniser avec Stripe",children:i?e.jsx(je,{className:"h-3 w-3 animate-spin"}):e.jsx(ss,{className:"h-3 w-3"})})]})]})]})},Ky=({spaces:r,loading:t,onEditSpace:s,onSpacesRefresh:n})=>{const[a,i]=x.useState(null),o=async(c,u)=>{try{i(c);const d=await B.put(`/spaces/${c}`,{is_active:!u});if(!d.success)throw new Error(d.error||"Erreur lors de la mise à jour");k.success(`Espace ${u?"désactivé":"activé"} avec succès`),n()}catch(d){console.error("Error updating space status:",d),k.error("Impossible de mettre à jour l'espace")}finally{i(null)}},l=async c=>{var u,d;try{i(c);const h=await B.delete(`/spaces/${c}`);if(!h.success)throw new Error(h.error||"Erreur lors de la suppression");k.success("Espace supprimé avec succès"),n()}catch(h){console.error("Error deleting space:",h),(u=h==null?void 0:h.message)!=null&&u.includes("contrainte")?k.error("Impossible de supprimer l'espace : contrainte de base de données"):(d=h==null?void 0:h.message)!=null&&d.includes("références")?k.error("Impossible de supprimer l'espace : références existantes"):k.error("Impossible de supprimer l'espace")}finally{i(null)}};return t?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((c,u)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx(xe,{className:"h-40 w-full"}),e.jsx(xe,{className:"h-4 w-3/4"}),e.jsx(xe,{className:"h-4 w-1/2"})]},u))}):r.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Aucun espace trouvé"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(c=>e.jsx(Gy,{space:c,onEdit:s,onToggleStatus:o,onDelete:l,isProcessing:a===c.id},c.id))})},Yy=({loading:r})=>r?e.jsx("p",{className:"text-center py-4",children:"Chargement des espaces..."}):e.jsx("p",{className:"text-center py-4",children:"Aucun espace trouvé."}),Vy=({onAddSpace:r})=>{const[t,s]=x.useState(!1),n=async()=>{s(!0);try{const{data:a,error:i}=await fg.functions.invoke("stripe-sync-queue",{body:{action:"sync_all",timestamp:new Date().toISOString()}});if(i)throw console.error("Erreur Supabase:",i),new Error(`Erreur Supabase: ${i.message}`);console.log("Résultat synchronisation:",a),k.success("Synchronisation Stripe de tous les espaces lancée !")}catch(a){console.error("Erreur complète:",a),k.error("Erreur lors de la synchronisation globale Stripe : "+a.message)}finally{s(!1)}};return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des espaces"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{className:"flex items-center gap-2",onClick:n,disabled:t,variant:"secondary",children:[t?e.jsx(ss,{className:"h-4 w-4 animate-spin"}):e.jsx(ss,{className:"h-4 w-4"}),e.jsx("span",{children:"Tout synchroniser"})]}),e.jsxs(P,{className:"flex items-center gap-2",onClick:r,children:[e.jsx(Rr,{size:16}),e.jsx("span",{children:"Ajouter un espace"})]})]})]})},Xy=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,h]=x.useState(0),[m,p]=x.useState("active"),f=async()=>{try{n(!0),console.log("Fetching spaces...");const N=await B.get("/spaces");if(N.success&&N.data){const w=Array.isArray(N.data)?N.data:[];console.log("Spaces fetched raw data:",w);const E=w==null?void 0:w.map(S=>(console.log(`Space ${S.name} pricing_type:`,S.pricing_type),{...S,pricing_type:S.pricing_type||"hourly",hourly_price:Number(S.hourly_price)||0,daily_price:Number(S.daily_price)||0,half_day_price:Number(S.half_day_price)||0,monthly_price:Number(S.monthly_price)||0,quarter_price:Number(S.quarter_price)||0,yearly_price:Number(S.yearly_price)||0,custom_price:Number(S.custom_price)||0,custom_label:S.custom_label||""}));console.log("Processed spaces data:",E),t(E)}else console.log("No spaces data available"),t([])}catch(N){console.error("Error fetching spaces:",N),k.error("Impossible de récupérer les espaces")}finally{n(!1)}},v=r.filter(N=>{switch(m){case"active":return N.is_active;case"inactive":return!N.is_active;case"all":default:return!0}}),y=()=>{console.log("Triggering refresh of spaces list"),h(N=>N+1)};return x.useEffect(()=>{f()},[d]),{spaces:v,allSpaces:r,loading:s,addDialogOpen:a,setAddDialogOpen:i,editDialogOpen:o,setEditDialogOpen:l,selectedSpace:c,setSelectedSpace:u,filter:m,setFilter:p,handleEditClick:N=>{console.log("Editing space:",N),u({id:N.id,name:N.name,description:N.description,capacity:N.capacity,hourly_price:Number(N.hourly_price)||0,daily_price:Number(N.daily_price)||0,half_day_price:Number(N.half_day_price)||0,monthly_price:Number(N.monthly_price)||0,quarter_price:Number(N.quarter_price)||0,yearly_price:Number(N.yearly_price)||0,custom_price:Number(N.custom_price)||0,custom_label:N.custom_label||"",pricing_type:N.pricing_type||"hourly",amenities:N.amenities||[],image_url:N.image_url,is_active:N.is_active}),l(!0)},handleAddClick:()=>{console.log("Adding new space"),u({name:"",description:"",capacity:1,hourly_price:0,daily_price:0,half_day_price:0,monthly_price:0,quarter_price:0,yearly_price:0,custom_price:0,custom_label:"",pricing_type:"hourly",amenities:[],is_active:!0}),i(!0)},handleDeleteClick:async N=>{try{console.log("Deleting space:",N);const w=await B.delete(`/spaces/${N}`);if(w.success)k.success("Espace supprimé avec succès"),y();else throw new Error(w.error||"Erreur lors de la suppression")}catch(w){console.error("Error deleting space:",w),k.error("Impossible de supprimer l'espace")}},handleDialogClose:()=>{i(!1),l(!1),u(null)},triggerRefresh:y}},Qy=({filter:r,setFilter:t,allSpaces:s})=>{const n=s.filter(o=>o.is_active).length,a=s.filter(o=>!o.is_active).length,i=s.length;return e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Filtrer :"}),e.jsxs(P,{variant:r==="all"?"default":"outline",size:"sm",onClick:()=>t("all"),className:"flex items-center gap-2",children:["Tous",e.jsx(fe,{variant:"secondary",className:"ml-1",children:i})]}),e.jsxs(P,{variant:r==="active"?"default":"outline",size:"sm",onClick:()=>t("active"),className:"flex items-center gap-2",children:["Actifs",e.jsx(fe,{variant:"secondary",className:"ml-1",children:n})]}),e.jsxs(P,{variant:r==="inactive"?"default":"outline",size:"sm",onClick:()=>t("inactive"),className:"flex items-center gap-2",children:["Inactifs",e.jsx(fe,{variant:"secondary",className:"ml-1",children:a})]})]})};function Jy({className:r}){const[t,s]=x.useState(!1),[n,a]=x.useState([]),[i,o]=x.useState(null),l=m=>{a(p=>[m,...p.slice(0,9)])},c=async()=>{s(!0);try{const m=await B.get("/stripe/test-connection");m.success?(o({success:!0,message:m.data.message,connected:m.data.connected,products_count:m.data.products_count}),l({success:!0,message:`Connexion Stripe: ${m.data.message}`,details:{connected:m.data.connected,products_count:m.data.products_count,message:m.data.message},timestamp:new Date().toLocaleString("fr-FR")})):l({success:!1,message:`Erreur Stripe: ${m.error||"Inconnue"}`,details:m,timestamp:new Date().toLocaleString("fr-FR")})}catch(m){l({success:!1,message:`Erreur: ${m instanceof Error?m.message:String(m)}`,timestamp:new Date().toLocaleString("fr-FR")})}finally{s(!1)}},u=async()=>{s(!0);try{const m=await B.post("/stripe/sync-all");m.success?l({success:!0,message:`Synchronisation Stripe: ${m.data.success_count}/${m.data.total_spaces} espaces synchronisés`,details:{total_spaces:m.data.total_spaces,success_count:m.data.success_count,error_count:m.data.error_count,skipped_count:m.data.skipped_count,results:m.data.results.slice(0,5)},timestamp:new Date().toLocaleString("fr-FR")}):l({success:!1,message:`Erreur synchronisation: ${m.error||"Inconnue"}`,details:m,timestamp:new Date().toLocaleString("fr-FR")})}catch(m){l({success:!1,message:`Erreur: ${m instanceof Error?m.message:String(m)}`,timestamp:new Date().toLocaleString("fr-FR")})}finally{s(!1)}},d=async()=>{s(!0);try{const m=await B.get("/spaces");if(!m.success){l({success:!1,message:`Erreur récupération espaces: ${m.error}`,timestamp:new Date().toLocaleString("fr-FR")});return}const f=m.data.filter(j=>j.is_active);if(f.length===0){l({success:!1,message:"Aucun espace actif trouvé",timestamp:new Date().toLocaleString("fr-FR")});return}const v=f[0],y=await B.post(`/stripe/sync-space/${v.id}`);y.success?l({success:!0,message:`Synchronisation Stripe espace "${v.name}": OK`,details:{space_id:y.data.space_id,stripe_product_id:y.data.stripe_product_id,prices:y.data.prices,mode:y.data.mode},timestamp:new Date().toLocaleString("fr-FR")}):l({success:!1,message:`Erreur synchronisation: ${y.error||"Inconnue"}`,details:y,timestamp:new Date().toLocaleString("fr-FR")})}catch(m){l({success:!1,message:`Erreur: ${m instanceof Error?m.message:String(m)}`,timestamp:new Date().toLocaleString("fr-FR")})}finally{s(!1)}},h=async()=>{s(!0);try{const m=await B.get("/stripe/sync-status");m.success?l({success:!0,message:`Statut Stripe: ${m.data.synced}/${m.data.total} espaces synchronisés (Mode: ${m.data.mode})`,details:{total:m.data.total,active:m.data.active,synced:m.data.synced,unsynced:m.data.unsynced,mode:m.data.mode,spaces:m.data.spaces.slice(0,5)},timestamp:new Date().toLocaleString("fr-FR")}):l({success:!1,message:`Erreur vérification statut: ${m.error||"Inconnue"}`,details:m,timestamp:new Date().toLocaleString("fr-FR")})}catch(m){l({success:!1,message:`Erreur: ${m instanceof Error?m.message:String(m)}`,timestamp:new Date().toLocaleString("fr-FR")})}finally{s(!1)}};return e.jsxs(U,{className:r,children:[e.jsxs(K,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Wn,{className:"h-5 w-5"}),"Débogage Stripe"]}),e.jsx(we,{children:"Outils de diagnostic et de synchronisation Stripe"})]}),e.jsxs(W,{className:"space-y-4",children:[i&&e.jsxs(Ge,{className:i.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:[e.jsx(Ct,{className:`h-4 w-4 ${i.success?"text-green-600":"text-red-600"}`}),e.jsxs(Ke,{children:[e.jsx("strong",{children:"Connexion Stripe:"})," ",i.success?"OK":"ÉCHEC",i.account&&e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(Mode: ",i.account.charges_enabled?"Live":"Test",")"]}),!i.success&&i.error&&e.jsxs("div",{className:"mt-1 text-sm text-red-600",children:["Erreur: ",i.error]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(P,{onClick:c,disabled:t,variant:"outline",size:"sm",children:[t?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsx(ss,{className:"h-4 w-4"}),"Test Connexion"]}),e.jsxs(P,{onClick:d,disabled:t,variant:"outline",size:"sm",children:[t?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsx(Wn,{className:"h-4 w-4"}),"Sync 1 Espace"]}),e.jsxs(P,{onClick:u,disabled:t,variant:"outline",size:"sm",children:[t?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsx(Wn,{className:"h-4 w-4"}),"Sync Tous"]}),e.jsxs(P,{onClick:h,disabled:t,variant:"outline",size:"sm",children:[t?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsx(Pr,{className:"h-4 w-4"}),"Statut"]})]}),n.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Résultats récents:"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:n.map((m,p)=>e.jsxs("div",{className:`p-3 rounded-lg border ${m.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[m.success?e.jsx(Ct,{className:"h-4 w-4 text-green-600"}):e.jsx(ux,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium",children:m.message})]}),e.jsx(fe,{variant:"outline",className:"text-xs",children:m.timestamp})]}),m.details&&m.details.error_message&&e.jsxs("div",{className:"mt-2 text-xs text-red-700 bg-red-100 rounded p-2",children:[e.jsx("strong",{children:"Erreur Stripe :"})," ",m.details.error_message]}),m.details&&m.details.details&&m.details.details.error_message&&e.jsxs("div",{className:"mt-2 text-xs text-red-700 bg-red-100 rounded p-2",children:[e.jsx("strong",{children:"Erreur Stripe :"})," ",m.details.details.error_message]}),m.details&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-gray-600 cursor-pointer",children:"Détails"}),e.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(m.details,null,2)})]})]},p))})]})]})]})}const Zy=()=>{const[r,t]=x.useState("grid"),{spaces:s,allSpaces:n,loading:a,addDialogOpen:i,setAddDialogOpen:o,editDialogOpen:l,setEditDialogOpen:c,selectedSpace:u,filter:d,setFilter:h,triggerRefresh:m,handleEditClick:p}=Xy(),[f,v]=x.useState(!1),y=()=>{f||(v(!0),console.log("Space operation successful, refreshing spaces..."),m(),setTimeout(()=>v(!1),1e3))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Jy,{}),e.jsx(Vy,{onAddSpace:()=>o(!0)}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(V,{children:"Liste des espaces"}),e.jsx(we,{children:"Gérez vos espaces de coworking"})]}),e.jsx(kr,{value:r,onValueChange:j=>t(j),className:"w-auto",children:e.jsxs(Dr,{children:[e.jsxs(ce,{value:"grid",className:"flex items-center gap-1",children:[e.jsx(Fp,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Grille"})]}),e.jsxs(ce,{value:"table",className:"flex items-center gap-1",children:[e.jsx($p,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Tableau"})]})]})})]})}),e.jsxs(W,{children:[e.jsx(Qy,{filter:d,setFilter:h,allSpaces:n}),a||s.length===0?e.jsx(Yy,{loading:a}):r==="grid"?e.jsx(Ky,{spaces:s,loading:a,onEditSpace:p,onSpacesRefresh:m}):e.jsx(Wy,{spaces:s,onEditSpace:p,onSpacesRefresh:m})]})]}),e.jsx(su,{mode:"add",open:i,onOpenChange:o,onSuccess:y}),u&&e.jsx(su,{mode:"edit",open:l,onOpenChange:c,onSuccess:y,space:u})]})},nc=({status:r})=>{switch(r){case"confirmed":return e.jsx("span",{className:"px-2 py-1 rounded bg-green-50 text-green-700 text-xs font-medium border border-green-200",children:"Confirmée"});case"cancelled":return e.jsx("span",{className:"px-2 py-1 rounded bg-red-50 text-red-700 text-xs font-medium border border-red-200",children:"Annulée"});case"completed":return e.jsx("span",{className:"px-2 py-1 rounded bg-blue-50 text-blue-700 text-xs font-medium border border-blue-200",children:"Terminée"});default:return e.jsx("span",{className:"px-2 py-1 rounded bg-yellow-50 text-yellow-700 text-xs font-medium border border-yellow-200",children:"En attente"})}},eb=({userName:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:r})]}),rb=({spaceName:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ip,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:r})]}),tb=({startTime:r,endTime:t})=>{const s=n=>new Date(n).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs",children:["Début: ",s(r)]}),e.jsxs("span",{className:"text-xs",children:["Fin: ",s(t)]})]})]})},Pf=({bookingId:r,status:t,onUpdateStatus:s,onDelete:n})=>e.jsxs("div",{className:"flex justify-end gap-2",children:[t==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{variant:"default",size:"sm",onClick:()=>s(r,"confirmed"),children:[e.jsx(Tl,{size:16,className:"mr-1"}),"Confirmer"]}),e.jsxs(P,{variant:"destructive",size:"sm",onClick:()=>s(r,"cancelled"),children:[e.jsx(or,{size:16,className:"mr-1"}),"Annuler"]})]}),t==="confirmed"&&e.jsxs(P,{variant:"destructive",size:"sm",onClick:()=>s(r,"cancelled"),children:[e.jsx(or,{size:16,className:"mr-1"}),"Annuler"]}),t==="cancelled"&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>s(r,"confirmed"),children:[e.jsx(Tl,{size:16,className:"mr-1"}),"Réactiver"]}),e.jsxs(P,{variant:"destructive",size:"sm",onClick:()=>{n&&window.confirm("Supprimer définitivement cette réservation ?")&&n(r)},children:[e.jsx(or,{size:16,className:"mr-1"}),"Supprimer"]})]})]}),sb=({booking:r,onUpdateStatus:t,onDelete:s})=>e.jsxs(Ee,{children:[e.jsx(X,{children:e.jsx(eb,{userName:r.user_name||"Utilisateur inconnu"})}),e.jsx(X,{children:e.jsx(rb,{spaceName:r.space_name||"Espace inconnu"})}),e.jsx(X,{children:e.jsx(tb,{startTime:r.start_time,endTime:r.end_time})}),e.jsx(X,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm",children:["HT: ",r.total_price_ht.toLocaleString("fr-FR")," €"]}),e.jsxs("span",{className:"text-sm font-medium",children:["TTC: ",r.total_price_ttc.toLocaleString("fr-FR")," €"]})]})}),e.jsx(X,{children:e.jsx(nc,{status:r.status})}),e.jsx(X,{className:"text-right",children:e.jsx(Pf,{bookingId:r.id,status:r.status,onUpdateStatus:t,onDelete:s})})]}),nb=({bookings:r,loading:t,onUpdateStatus:s,onDelete:n})=>t?e.jsx("p",{className:"text-center py-4",children:"Chargement des réservations..."}):r.length===0?e.jsx("p",{className:"text-center py-4",children:"Aucune réservation trouvée."}):e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Utilisateur"}),e.jsx(Q,{children:"Espace"}),e.jsx(Q,{children:"Dates"}),e.jsx(Q,{children:"Prix"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:r.map(a=>e.jsx(sb,{booking:a,onUpdateStatus:s,onDelete:n},a.id))})]}),ab=({refreshing:r,onRefresh:t})=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des réservations"}),e.jsxs(P,{onClick:t,disabled:r,variant:"outline",children:[e.jsx(ss,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),r?"Actualisation...":"Actualiser"]})]});function ib(){const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(null),c=x.useRef(!0),u=async()=>{if(c.current)try{console.log("🔄 Chargement des réservations dans useBookings hook..."),n(!0),l(null);const p=await Cg();if(!c.current)return;p.length===0?console.log("ℹ️ Aucune réservation trouvée"):(console.log(`✅ Chargement réussi: ${p.length} réservations trouvées`),console.log("📋 Exemples de réservations:",p.slice(0,2))),t(p)}catch(p){if(!c.current)return;console.error("❌ Erreur lors du chargement des réservations:",p),l((p==null?void 0:p.message)||"Une erreur est survenue lors du chargement des réservations"),k.error("Impossible de charger les réservations. Veuillez réessayer.")}finally{c.current&&(n(!1),i(!1))}};return x.useEffect(()=>(c.current=!0,console.log("🔌 Initialisation du hook useBookings..."),u(),()=>{console.log("🧹 Nettoyage du hook useBookings..."),c.current=!1}),[]),{bookings:r,loading:s,refreshing:a,error:o,handleUpdateStatus:async(p,f)=>{if(c.current){i(!0),console.log(`🔄 Mise à jour du statut de la réservation: ${p} vers ${f}`);try{await Rg(p,f)?(await u(),k.success("Statut de la réservation mis à jour avec succès")):(k.error("Échec de la mise à jour du statut de la réservation"),i(!1))}catch(v){console.error("❌ Erreur lors de la mise à jour du statut:",v),k.error("Erreur lors de la mise à jour du statut"),i(!1)}}},handleRefresh:()=>{c.current&&(console.log("🔄 Actualisation manuelle demandée"),i(!0),u())},handleDeleteBooking:async p=>{if(c.current){i(!0);try{await Tg(p)&&await u()}catch(f){console.error("❌ Erreur lors de la suppression:",f),k.error("Erreur lors de la suppression de la réservation"),i(!1)}}}}}const ob=({booking:r,onUpdateStatus:t})=>{const s=a=>{switch(a){case"hourly":return"Tarification horaire";case"daily":return"Tarification journalière";case"half_day":return"Tarification demi-journée";case"quarter":return"Tarification trimestrielle";case"monthly":return"Tarification mensuelle";case"yearly":return"Tarification annuelle";case"custom":return"Tarification personnalisée";default:return"Tarification inconnue"}},n=(a,i,o)=>{const l=new Date(a),c=new Date(i),u=c.getTime()-l.getTime(),d=Math.ceil(u/(1e3*60*60*24)),h=Math.ceil(u/(1e3*60*60));switch(o){case"hourly":return h<24?`${h} heure(s)`:`${d} jour(s)`;case"daily":return`${d} jour(s)`;case"monthly":const m=l.getFullYear(),p=l.getMonth(),f=c.getFullYear(),v=c.getMonth();return`${(f-m)*12+(v-p)} mois`;case"quarter":const j=Math.floor(d/30);return`${Math.ceil(j/3)} trimestre(s)`;case"yearly":return`${Math.floor(d/365)} an(s)`;default:return d===1?"1 jour":d<30?`${d} jours`:d<365?`${Math.ceil(d/30)} mois`:`${Math.ceil(d/365)} an(s)`}};return e.jsxs(U,{className:"flex flex-col h-full",children:[e.jsx(K,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:r.space_name||"Espace inconnu"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.user_name||(r.first_name&&r.last_name?`${r.first_name} ${r.last_name}`:null)||r.user_email||`Utilisateur #${r.user_id}`})]}),e.jsx(nc,{status:r.status})]})}),e.jsx(W,{className:"flex-grow pb-2",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"space-y-1 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Type:"}),e.jsx("span",{className:"text-sm ml-2",children:s(r.space_pricing_type||"hourly")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Durée:"}),e.jsx("span",{className:"text-sm ml-2",children:n(r.start_time,r.end_time,r.space_pricing_type)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Période:"}),e.jsxs("span",{className:"text-sm ml-2",children:["Du ",Yc(r.start_time)," au ",Yc(r.end_time)]})]})]}),e.jsxs("div",{className:"mt-auto",children:[e.jsx("div",{className:"border-t pt-3 mb-3",children:(()=>{const a=r.total_price_ttc,i=Math.round(a/1.2*100)/100,o=a-i;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Prix HT:"}),e.jsxs("span",{className:"text-sm",children:[i.toLocaleString("fr-FR")," €"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"TVA (20%):"}),e.jsxs("span",{className:"text-sm",children:[o.toLocaleString("fr-FR")," €"]})]}),e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Total TTC:"}),e.jsxs("span",{children:[a.toLocaleString("fr-FR")," €"]})]})]})})()}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(Pf,{bookingId:r.id,status:r.status,onUpdateStatus:t})})]})]})})]})},lb=({bookings:r,loading:t,onUpdateStatus:s})=>t?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((n,a)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx(xe,{className:"h-40 w-full"}),e.jsx(xe,{className:"h-4 w-3/4"}),e.jsx(xe,{className:"h-4 w-1/2"})]},a))}):r.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Aucune réservation trouvée"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(n=>e.jsx(ob,{booking:n,onUpdateStatus:s},n.id))});function cb(r,t){if(lt(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var n=s.call(r,t);if(lt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Mf(r){var t=cb(r,"string");return lt(t)=="symbol"?t:t+""}function Zr(r,t,s){return(t=Mf(t))in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function au(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),s.push.apply(s,n)}return s}function ue(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?au(Object(s),!0).forEach(function(n){Zr(r,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):au(Object(s)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(s,n))})}return r}function jn(r,t){if(r==null)return{};var s={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(t.indexOf(n)!==-1)continue;s[n]=r[n]}return s}function fr(r,t){if(r==null)return{};var s,n,a=jn(r,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)===-1&&{}.propertyIsEnumerable.call(r,s)&&(a[s]=r[s])}return a}function Se(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function iu(r,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Mf(n.key),n)}}function Ne(r,t,s){return t&&iu(r.prototype,t),s&&iu(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}function sn(r){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sn(r)}function Of(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Of=function(){return!!r})()}function ub(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function db(r,t){if(t&&(lt(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ub(r)}function ke(r,t,s){return t=sn(t),db(r,Of()?Reflect.construct(t,s||[],sn(r).constructor):t.apply(r,s))}function nn(r,t){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,n){return s.__proto__=n,s},nn(r,t)}function De(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&nn(r,t)}function If(r){if(Array.isArray(r))return r}function mb(r,t){var s=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s!=null){var n,a,i,o,l=[],c=!0,u=!1;try{if(i=(s=s.call(r)).next,t!==0)for(;!(c=(n=i.call(s)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function Ll(r,t){(t==null||t>r.length)&&(t=r.length);for(var s=0,n=Array(t);s<t;s++)n[s]=r[s];return n}function ac(r,t){if(r){if(typeof r=="string")return Ll(r,t);var s={}.toString.call(r).slice(8,-1);return s==="Object"&&r.constructor&&(s=r.constructor.name),s==="Map"||s==="Set"?Array.from(r):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Ll(r,t):void 0}}function qf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ut(r,t){return If(r)||mb(r,t)||ac(r,t)||qf()}function Lf(r){var t,s,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r))for(t=0;t<r.length;t++)r[t]&&(s=Lf(r[t]))&&(n&&(n+=" "),n+=s);else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function be(){for(var r,t,s=0,n="";s<arguments.length;)(r=arguments[s++])&&(t=Lf(r))&&(n&&(n+=" "),n+=t);return n}function ye(){return ye=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(r[n]=s[n])}return r},ye.apply(null,arguments)}var hb=function(){};function pb(r,t){var s={};return Object.keys(r).forEach(function(n){s[qs(n)]=hb}),s}function ou(r,t){return r[t]!==void 0}function qs(r){return"default"+r.charAt(0).toUpperCase()+r.substr(1)}function fb(r){return!!r&&(typeof r!="function"||r.prototype&&r.prototype.isReactComponent)}function vb(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,nn(r,t)}function Ff(){var r=this.constructor.getDerivedStateFromProps(this.props,this.state);r!=null&&this.setState(r)}function $f(r){function t(s){var n=this.constructor.getDerivedStateFromProps(r,s);return n??null}this.setState(t.bind(this))}function zf(r,t){try{var s=this.props,n=this.state;this.props=r,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(s,n)}finally{this.props=s,this.state=n}}Ff.__suppressDeprecationWarning=!0;$f.__suppressDeprecationWarning=!0;zf.__suppressDeprecationWarning=!0;function gb(r){var t=r.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof r.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return r;var s=null,n=null,a=null;if(typeof t.componentWillMount=="function"?s="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(s="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),s!==null||n!==null||a!==null){var i=r.displayName||r.name,o=typeof r.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+o+" but also contains the following legacy lifecycles:"+(s!==null?`
  `+s:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof r.getDerivedStateFromProps=="function"&&(t.componentWillMount=Ff,t.componentWillReceiveProps=$f),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=zf;var l=t.componentDidUpdate;t.componentDidUpdate=function(u,d,h){var m=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:h;l.call(this,u,d,m)}}return r}var xb="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function Uf(r,t,s){s===void 0&&(s=[]);var n=r.displayName||r.name||"Component",a=fb(r),i=Object.keys(t),o=i.map(qs);a||!s.length||rs(!1);var l=function(u){vb(d,u);function d(){for(var m,p=arguments.length,f=new Array(p),v=0;v<p;v++)f[v]=arguments[v];m=u.call.apply(u,[this].concat(f))||this,m.handlers=Object.create(null),i.forEach(function(j){var g=t[j],_=function(N){if(m.props[g]){var w;m._notifying=!0;for(var E=arguments.length,S=new Array(E>1?E-1:0),C=1;C<E;C++)S[C-1]=arguments[C];(w=m.props)[g].apply(w,[N].concat(S)),m._notifying=!1}m.unmounted||m.setState(function(D){var R,O=D.values;return{values:ye(Object.create(null),O,(R={},R[j]=N,R))}})};m.handlers[g]=_}),s.length&&(m.attachRef=function(j){m.inner=j});var y=Object.create(null);return i.forEach(function(j){y[j]=m.props[qs(j)]}),m.state={values:y,prevProps:{}},m}var h=d.prototype;return h.shouldComponentUpdate=function(){return!this._notifying},d.getDerivedStateFromProps=function(p,f){var v=f.values,y=f.prevProps,j={values:ye(Object.create(null),v),prevProps:{}};return i.forEach(function(g){j.prevProps[g]=p[g],!ou(p,g)&&ou(y,g)&&(j.values[g]=p[qs(g)])}),j},h.componentWillUnmount=function(){this.unmounted=!0},h.render=function(){var p=this,f=this.props,v=f.innerRef,y=jn(f,["innerRef"]);o.forEach(function(g){delete y[g]});var j={};return i.forEach(function(g){var _=p.props[g];j[g]=_!==void 0?_:p.state.values[g]}),A.createElement(r,ye({},y,j,this.handlers,{ref:v||this.attachRef}))},d}(A.Component);gb(l),l.displayName="Uncontrolled("+n+")",l.propTypes=ye({innerRef:function(){}},pb(t)),s.forEach(function(u){l.prototype[u]=function(){var h;return(h=this.inner)[u].apply(h,arguments)}});var c=l;return A.forwardRef&&(c=A.forwardRef(function(u,d){return A.createElement(l,ye({},u,{innerRef:d,__source:{fileName:xb,lineNumber:128},__self:this}))}),c.propTypes=l.propTypes),c.ControlledComponent=r,c.deferControlTo=function(u,d,h){return d===void 0&&(d={}),Uf(u,ye({},t,d),h)},c}var an="milliseconds",ns="seconds",as="minutes",is="hours",dt="day",Rt="week",os="month",mt="year",ht="decade",pt="century",Bf={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},yb={month:1,year:12,decade:10*12,century:100*12};function bb(r){return[31,jb(r),31,30,31,30,31,31,30,31,30,31]}function jb(r){return r%4===0&&r%100!==0||r%400===0?29:28}function lr(r,t,s){switch(r=new Date(r),s){case an:case ns:case as:case is:case dt:case Rt:return wb(r,t*Bf[s]);case os:case mt:case ht:case pt:return _b(r,t*yb[s])}throw new TypeError('Invalid units: "'+s+'"')}function wb(r,t){var s=new Date(+r+t);return Sb(r,s)}function _b(r,t){var s=r.getFullYear(),n=r.getMonth(),a=r.getDate(),i=s*12+n+t,o=Math.trunc(i/12),l=i%12,c=Math.min(a,bb(o)[l]),u=new Date(r);return u.setFullYear(o),u.setDate(1),u.setMonth(l),u.setDate(c),u}function Sb(r,t){var s=r.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-s;return new Date(+t+a*Bf.minutes)}function ls(r,t,s){return lr(r,-t,s)}function Re(r,t,s){switch(r=new Date(r),t){case pt:case ht:case mt:r=ln(r,0);case os:r=Yf(r,1);case Rt:case dt:r=ds(r,0);case is:r=At(r,0);case as:r=us(r,0);case ns:r=cs(r,0)}return t===ht&&(r=ls(r,ft(r)%10,"year")),t===pt&&(r=ls(r,ft(r)%100,"year")),t===Rt&&(r=Vf(r,0,s)),r}function on(r,t,s){switch(r=new Date(r),r=Re(r,t,s),t){case pt:case ht:case mt:case os:case Rt:r=lr(r,1,t),r=ls(r,1,dt),r.setHours(23,59,59,999);break;case dt:r.setHours(23,59,59,999);break;case is:case as:case ns:r=lr(r,1,t),r=ls(r,1,an)}return r}var Lt=$t(function(r,t){return r===t}),ic=$t(function(r,t){return r!==t}),wn=$t(function(r,t){return r>t}),xs=$t(function(r,t){return r>=t}),oc=$t(function(r,t){return r<t}),Ft=$t(function(r,t){return r<=t});function Hf(){return new Date(Math.min.apply(Math,arguments))}function Wf(){return new Date(Math.max.apply(Math,arguments))}function Gf(r,t,s,n){return n=n||"day",(!t||xs(r,t,n))&&(!s||Ft(r,s,n))}var cs=Wr("Milliseconds"),us=Wr("Seconds"),At=Wr("Minutes"),ds=Wr("Hours"),Kf=Wr("Day"),Yf=Wr("Date"),ln=Wr("Month"),ft=Wr("FullYear");function Nb(r,t){return t===void 0?ft(Re(r,ht)):lr(r,t+10,mt)}function Eb(r,t){return t===void 0?ft(Re(r,pt)):lr(r,t+100,mt)}function Vf(r,t,s){var n=(Kf(r)+7-(s||0))%7;return t===void 0?n:lr(r,t-n,dt)}function Cb(r,t,s,n){var a,i,o;switch(s){case an:case ns:case as:case is:case dt:case Rt:a=t.getTime()-r.getTime();break;case os:case mt:case ht:case pt:a=(ft(t)-ft(r))*12+ln(t)-ln(r);break;default:throw new TypeError('Invalid units: "'+s+'"')}switch(s){case an:i=1;break;case ns:i=1e3;break;case as:i=1e3*60;break;case is:i=1e3*60*60;break;case dt:i=1e3*60*60*24;break;case Rt:i=1e3*60*60*24*7;break;case os:i=1;break;case mt:i=12;break;case ht:i=120;break;case pt:i=1200;break;default:throw new TypeError('Invalid units: "'+s+'"')}return o=a/i,n?o:Math.round(o)}function Wr(r){var t=function(s){switch(s){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(r);return function(s,n){if(n===void 0)return s["get"+r]();var a=new Date(s);return a["set"+r](n),t&&a["get"+r]()!=n&&(r==="Hours"||n>=t&&a.getHours()-s.getHours()<Math.floor(n/t))&&a["set"+r](n+t),a}}function $t(r){return function(t,s,n){return r(+Re(t,n),+Re(s,n))}}const lu=Object.freeze(Object.defineProperty({__proto__:null,add:lr,century:Eb,date:Yf,day:Kf,decade:Nb,diff:Cb,endOf:on,eq:Lt,gt:wn,gte:xs,hours:ds,inRange:Gf,lt:oc,lte:Ft,max:Wf,milliseconds:cs,min:Hf,minutes:At,month:ln,neq:ic,seconds:us,startOf:Re,subtract:ls,weekday:Vf,year:ft},Symbol.toStringTag,{value:"Module"}));function Tb(r){if(Array.isArray(r))return Ll(r)}function Xf(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Rb(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ls(r){return Tb(r)||Xf(r)||ac(r)||Rb()}var Gn,cu;function Qf(){if(cu)return Gn;cu=1;function r(t,s,n){var a=-1,i=t.length;s<0&&(s=-s>i?0:i+s),n=n>i?i:n,n<0&&(n+=i),i=s>n?0:n-s>>>0,s>>>=0;for(var o=Array(i);++a<i;)o[a]=t[a+s];return o}return Gn=r,Gn}var Kn,uu;function ys(){if(uu)return Kn;uu=1;function r(t,s){return t===s||t!==t&&s!==s}return Kn=r,Kn}var Yn,du;function Jf(){if(du)return Yn;du=1;var r=typeof Ur=="object"&&Ur&&Ur.Object===Object&&Ur;return Yn=r,Yn}var Vn,mu;function yr(){if(mu)return Vn;mu=1;var r=Jf(),t=typeof self=="object"&&self&&self.Object===Object&&self,s=r||t||Function("return this")();return Vn=s,Vn}var Xn,hu;function zt(){if(hu)return Xn;hu=1;var r=yr(),t=r.Symbol;return Xn=t,Xn}var Qn,pu;function Ab(){if(pu)return Qn;pu=1;var r=zt(),t=Object.prototype,s=t.hasOwnProperty,n=t.toString,a=r?r.toStringTag:void 0;function i(o){var l=s.call(o,a),c=o[a];try{o[a]=void 0;var u=!0}catch{}var d=n.call(o);return u&&(l?o[a]=c:delete o[a]),d}return Qn=i,Qn}var Jn,fu;function kb(){if(fu)return Jn;fu=1;var r=Object.prototype,t=r.toString;function s(n){return t.call(n)}return Jn=s,Jn}var Zn,vu;function Ut(){if(vu)return Zn;vu=1;var r=zt(),t=Ab(),s=kb(),n="[object Null]",a="[object Undefined]",i=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?a:n:i&&i in Object(l)?t(l):s(l)}return Zn=o,Zn}var ea,gu;function qr(){if(gu)return ea;gu=1;function r(t){var s=typeof t;return t!=null&&(s=="object"||s=="function")}return ea=r,ea}var ra,xu;function lc(){if(xu)return ra;xu=1;var r=Ut(),t=qr(),s="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function o(l){if(!t(l))return!1;var c=r(l);return c==n||c==a||c==s||c==i}return ra=o,ra}var ta,yu;function cc(){if(yu)return ta;yu=1;var r=9007199254740991;function t(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=r}return ta=t,ta}var sa,bu;function bs(){if(bu)return sa;bu=1;var r=lc(),t=cc();function s(n){return n!=null&&t(n.length)&&!r(n)}return sa=s,sa}var na,ju;function uc(){if(ju)return na;ju=1;var r=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function s(n,a){var i=typeof n;return a=a??r,!!a&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return na=s,na}var aa,wu;function _n(){if(wu)return aa;wu=1;var r=ys(),t=bs(),s=uc(),n=qr();function a(i,o,l){if(!n(l))return!1;var c=typeof o;return(c=="number"?t(l)&&s(o,l.length):c=="string"&&o in l)?r(l[o],i):!1}return aa=a,aa}var ia,_u;function Db(){if(_u)return ia;_u=1;var r=/\s/;function t(s){for(var n=s.length;n--&&r.test(s.charAt(n)););return n}return ia=t,ia}var oa,Su;function Pb(){if(Su)return oa;Su=1;var r=Db(),t=/^\s+/;function s(n){return n&&n.slice(0,r(n)+1).replace(t,"")}return oa=s,oa}var la,Nu;function Gr(){if(Nu)return la;Nu=1;function r(t){return t!=null&&typeof t=="object"}return la=r,la}var ca,Eu;function js(){if(Eu)return ca;Eu=1;var r=Ut(),t=Gr(),s="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&r(a)==s}return ca=n,ca}var ua,Cu;function Mb(){if(Cu)return ua;Cu=1;var r=Pb(),t=qr(),s=js(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(s(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=r(u);var h=i.test(u);return h||o.test(u)?l(u.slice(2),h?2:8):a.test(u)?n:+u}return ua=c,ua}var da,Tu;function Zf(){if(Tu)return da;Tu=1;var r=Mb(),t=1/0,s=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=r(a),a===t||a===-t){var i=a<0?-1:1;return i*s}return a===a?a:0}return da=n,da}var ma,Ru;function ev(){if(Ru)return ma;Ru=1;var r=Zf();function t(s){var n=r(s),a=n%1;return n===n?a?n-a:n:0}return ma=t,ma}var ha,Au;function Ob(){if(Au)return ha;Au=1;var r=Qf(),t=_n(),s=ev(),n=Math.ceil,a=Math.max;function i(o,l,c){(c?t(o,l,c):l===void 0)?l=1:l=a(s(l),0);var u=o==null?0:o.length;if(!u||l<1)return[];for(var d=0,h=0,m=Array(n(u/l));d<u;)m[h++]=r(o,d,d+=l);return m}return ha=i,ha}var Ib=Ob();const qb=vr(Ib);function ws(r){return r&&r.ownerDocument||document}function Lb(r){var t=ws(r);return t&&t.defaultView||window}function Fb(r,t){return Lb(r).getComputedStyle(r,t)}var $b=/([A-Z])/g;function zb(r){return r.replace($b,"-$1").toLowerCase()}var Ub=/^ms-/;function ks(r){return zb(r).replace(Ub,"-ms-")}var Bb=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Hb(r){return!!(r&&Bb.test(r))}function St(r,t){var s="",n="";if(typeof t=="string")return r.style.getPropertyValue(ks(t))||Fb(r).getPropertyValue(ks(t));Object.keys(t).forEach(function(a){var i=t[a];!i&&i!==0?r.style.removeProperty(ks(a)):Hb(a)?n+=a+"("+i+") ":s+=ks(a)+": "+i+";"}),n&&(s+="transform: "+n+";"),r.style.cssText+=";"+s}function ms(r,t){if(r.contains)return r.contains(t);if(r.compareDocumentPosition)return r===t||!!(r.compareDocumentPosition(t)&16)}function Wb(r){return"nodeType"in r&&r.nodeType===document.DOCUMENT_NODE}function dc(r){return"window"in r&&r.window===r?r:Wb(r)&&r.defaultView||!1}function rv(r){var t=r==="pageXOffset"?"scrollLeft":"scrollTop";function s(n,a){var i=dc(n);if(a===void 0)return i?i[r]:n[t];i?i.scrollTo(i[r],a):n[t]=a}return s}const tv=rv("pageXOffset"),sv=rv("pageYOffset");function at(r){var t=ws(r),s={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!ms(n,r)||(r.getBoundingClientRect!==void 0&&(s=r.getBoundingClientRect()),s={top:s.top+sv(n)-(n.clientTop||0),left:s.left+tv(n)-(n.clientLeft||0),width:s.width,height:s.height}),s}var Gb=function(t){return!!t&&"offsetParent"in t};function Kb(r){for(var t=ws(r),s=r&&r.offsetParent;Gb(s)&&s.nodeName!=="HTML"&&St(s,"position")==="static";)s=s.offsetParent;return s||t.documentElement}var Yb=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function nv(r,t){var s={top:0,left:0},n;if(St(r,"position")==="fixed")n=r.getBoundingClientRect();else{var a=t||Kb(r);n=at(r),Yb(a)!=="html"&&(s=at(a));var i=String(St(a,"borderTopWidth")||0);s.top+=parseInt(i,10)-sv(a)||0;var o=String(St(a,"borderLeftWidth")||0);s.left+=parseInt(o,10)-tv(a)||0}var l=String(St(r,"marginTop")||0),c=String(St(r,"marginLeft")||0);return ye({},n,{top:n.top-s.top-(parseInt(l,10)||0),left:n.left-s.left-(parseInt(c,10)||0)})}const mc=!!(typeof window<"u"&&window.document&&window.document.createElement);var ku=new Date().getTime();function Vb(r){var t=new Date().getTime(),s=Math.max(0,16-(t-ku)),n=setTimeout(r,s);return ku=t,n}var Xb=["","webkit","moz","o","ms"],Fl="clearTimeout",$l=Vb,Du=function(t,s){return t+(t?s[0].toUpperCase()+s.substr(1):s)+"AnimationFrame"};mc&&Xb.some(function(r){var t=Du(r,"request");return t in window&&(Fl=Du(r,"cancel"),$l=function(n){return window[t](n)}),!!$l});var Pu=function(t){typeof window[Fl]=="function"&&window[Fl](t)},av=$l,pa;function Qb(r,t){if(!pa){var s=document.body,n=s.matches||s.matchesSelector||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector;pa=function(i,o){return n.call(i,o)}}return pa(r,t)}var Jb=Function.prototype.bind.call(Function.prototype.call,[].slice);function Zb(r,t){return Jb(r.querySelectorAll(t))}var zl=!1,Ul=!1;try{var fa={get passive(){return zl=!0},get once(){return Ul=zl=!0}};mc&&(window.addEventListener("test",fa,fa),window.removeEventListener("test",fa,!0))}catch{}function ej(r,t,s,n){if(n&&typeof n!="boolean"&&!Ul){var a=n.once,i=n.capture,o=s;!Ul&&a&&(o=s.__once||function l(c){this.removeEventListener(t,l,i),s.call(this,c)},s.__once=o),r.addEventListener(t,o,zl?n:i)}r.addEventListener(t,s,n)}function rj(r){const t=x.useRef(r);return x.useEffect(()=>{t.current=r},[r]),t}function Mu(r){const t=rj(r);return x.useCallback(function(...s){return t.current&&t.current(...s)},[t])}function Ou(){return x.useState(null)}function tj(){const r=x.useRef(!0),t=x.useRef(()=>r.current);return x.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]),t.current}function sj(r){const t=tj();return[r[0],x.useCallback(s=>{if(t())return r[1](s)},[t,r[1]])]}var qe="top",Je="bottom",Ze="right",Le="left",hc="auto",_s=[qe,Je,Ze,Le],kt="start",hs="end",nj="clippingParents",iv="viewport",Wt="popper",aj="reference",Iu=_s.reduce(function(r,t){return r.concat([t+"-"+kt,t+"-"+hs])},[]),pc=[].concat(_s,[hc]).reduce(function(r,t){return r.concat([t,t+"-"+kt,t+"-"+hs])},[]),ij="beforeRead",oj="read",lj="afterRead",cj="beforeMain",uj="main",dj="afterMain",mj="beforeWrite",hj="write",pj="afterWrite",fj=[ij,oj,lj,cj,uj,dj,mj,hj,pj];function hr(r){return r.split("-")[0]}function Ye(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var t=r.ownerDocument;return t&&t.defaultView||window}return r}function vt(r){var t=Ye(r).Element;return r instanceof t||r instanceof Element}function pr(r){var t=Ye(r).HTMLElement;return r instanceof t||r instanceof HTMLElement}function fc(r){if(typeof ShadowRoot>"u")return!1;var t=Ye(r).ShadowRoot;return r instanceof t||r instanceof ShadowRoot}var it=Math.max,cn=Math.min,Dt=Math.round;function Bl(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function ov(){return!/^((?!chrome|android).)*safari/i.test(Bl())}function Pt(r,t,s){t===void 0&&(t=!1),s===void 0&&(s=!1);var n=r.getBoundingClientRect(),a=1,i=1;t&&pr(r)&&(a=r.offsetWidth>0&&Dt(n.width)/r.offsetWidth||1,i=r.offsetHeight>0&&Dt(n.height)/r.offsetHeight||1);var o=vt(r)?Ye(r):window,l=o.visualViewport,c=!ov()&&s,u=(n.left+(c&&l?l.offsetLeft:0))/a,d=(n.top+(c&&l?l.offsetTop:0))/i,h=n.width/a,m=n.height/i;return{width:h,height:m,top:d,right:u+h,bottom:d+m,left:u,x:u,y:d}}function vc(r){var t=Pt(r),s=r.offsetWidth,n=r.offsetHeight;return Math.abs(t.width-s)<=1&&(s=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:r.offsetLeft,y:r.offsetTop,width:s,height:n}}function lv(r,t){var s=t.getRootNode&&t.getRootNode();if(r.contains(t))return!0;if(s&&fc(s)){var n=t;do{if(n&&r.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Br(r){return r?(r.nodeName||"").toLowerCase():null}function Ar(r){return Ye(r).getComputedStyle(r)}function vj(r){return["table","td","th"].indexOf(Br(r))>=0}function Kr(r){return((vt(r)?r.ownerDocument:r.document)||window.document).documentElement}function Sn(r){return Br(r)==="html"?r:r.assignedSlot||r.parentNode||(fc(r)?r.host:null)||Kr(r)}function qu(r){return!pr(r)||Ar(r).position==="fixed"?null:r.offsetParent}function gj(r){var t=/firefox/i.test(Bl()),s=/Trident/i.test(Bl());if(s&&pr(r)){var n=Ar(r);if(n.position==="fixed")return null}var a=Sn(r);for(fc(a)&&(a=a.host);pr(a)&&["html","body"].indexOf(Br(a))<0;){var i=Ar(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function Ss(r){for(var t=Ye(r),s=qu(r);s&&vj(s)&&Ar(s).position==="static";)s=qu(s);return s&&(Br(s)==="html"||Br(s)==="body"&&Ar(s).position==="static")?t:s||gj(r)||t}function gc(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Zt(r,t,s){return it(r,cn(t,s))}function xj(r,t,s){var n=Zt(r,t,s);return n>s?s:n}function cv(){return{top:0,right:0,bottom:0,left:0}}function uv(r){return Object.assign({},cv(),r)}function dv(r,t){return t.reduce(function(s,n){return s[n]=r,s},{})}var yj=function(t,s){return t=typeof t=="function"?t(Object.assign({},s.rects,{placement:s.placement})):t,uv(typeof t!="number"?t:dv(t,_s))};function bj(r){var t,s=r.state,n=r.name,a=r.options,i=s.elements.arrow,o=s.modifiersData.popperOffsets,l=hr(s.placement),c=gc(l),u=[Le,Ze].indexOf(l)>=0,d=u?"height":"width";if(!(!i||!o)){var h=yj(a.padding,s),m=vc(i),p=c==="y"?qe:Le,f=c==="y"?Je:Ze,v=s.rects.reference[d]+s.rects.reference[c]-o[c]-s.rects.popper[d],y=o[c]-s.rects.reference[c],j=Ss(i),g=j?c==="y"?j.clientHeight||0:j.clientWidth||0:0,_=v/2-y/2,b=h[p],N=g-m[d]-h[f],w=g/2-m[d]/2+_,E=Zt(b,w,N),S=c;s.modifiersData[n]=(t={},t[S]=E,t.centerOffset=E-w,t)}}function jj(r){var t=r.state,s=r.options,n=s.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||lv(t.elements.popper,a)&&(t.elements.arrow=a))}const wj={name:"arrow",enabled:!0,phase:"main",fn:bj,effect:jj,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Mt(r){return r.split("-")[1]}var _j={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Sj(r,t){var s=r.x,n=r.y,a=t.devicePixelRatio||1;return{x:Dt(s*a)/a||0,y:Dt(n*a)/a||0}}function Lu(r){var t,s=r.popper,n=r.popperRect,a=r.placement,i=r.variation,o=r.offsets,l=r.position,c=r.gpuAcceleration,u=r.adaptive,d=r.roundOffsets,h=r.isFixed,m=o.x,p=m===void 0?0:m,f=o.y,v=f===void 0?0:f,y=typeof d=="function"?d({x:p,y:v}):{x:p,y:v};p=y.x,v=y.y;var j=o.hasOwnProperty("x"),g=o.hasOwnProperty("y"),_=Le,b=qe,N=window;if(u){var w=Ss(s),E="clientHeight",S="clientWidth";if(w===Ye(s)&&(w=Kr(s),Ar(w).position!=="static"&&l==="absolute"&&(E="scrollHeight",S="scrollWidth")),w=w,a===qe||(a===Le||a===Ze)&&i===hs){b=Je;var C=h&&w===N&&N.visualViewport?N.visualViewport.height:w[E];v-=C-n.height,v*=c?1:-1}if(a===Le||(a===qe||a===Je)&&i===hs){_=Ze;var D=h&&w===N&&N.visualViewport?N.visualViewport.width:w[S];p-=D-n.width,p*=c?1:-1}}var R=Object.assign({position:l},u&&_j),O=d===!0?Sj({x:p,y:v},Ye(s)):{x:p,y:v};if(p=O.x,v=O.y,c){var T;return Object.assign({},R,(T={},T[b]=g?"0":"",T[_]=j?"0":"",T.transform=(N.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",T))}return Object.assign({},R,(t={},t[b]=g?v+"px":"",t[_]=j?p+"px":"",t.transform="",t))}function Nj(r){var t=r.state,s=r.options,n=s.gpuAcceleration,a=n===void 0?!0:n,i=s.adaptive,o=i===void 0?!0:i,l=s.roundOffsets,c=l===void 0?!0:l,u={placement:hr(t.placement),variation:Mt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Lu(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Lu(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Ej={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nj,data:{}};var Ds={passive:!0};function Cj(r){var t=r.state,s=r.instance,n=r.options,a=n.scroll,i=a===void 0?!0:a,o=n.resize,l=o===void 0?!0:o,c=Ye(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(d){d.addEventListener("scroll",s.update,Ds)}),l&&c.addEventListener("resize",s.update,Ds),function(){i&&u.forEach(function(d){d.removeEventListener("scroll",s.update,Ds)}),l&&c.removeEventListener("resize",s.update,Ds)}}const Tj={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Cj,data:{}};var Rj={left:"right",right:"left",bottom:"top",top:"bottom"};function Fs(r){return r.replace(/left|right|bottom|top/g,function(t){return Rj[t]})}var Aj={start:"end",end:"start"};function Fu(r){return r.replace(/start|end/g,function(t){return Aj[t]})}function xc(r){var t=Ye(r),s=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:s,scrollTop:n}}function yc(r){return Pt(Kr(r)).left+xc(r).scrollLeft}function kj(r,t){var s=Ye(r),n=Kr(r),a=s.visualViewport,i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;var u=ov();(u||!u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l+yc(r),y:c}}function Dj(r){var t,s=Kr(r),n=xc(r),a=(t=r.ownerDocument)==null?void 0:t.body,i=it(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=it(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+yc(r),c=-n.scrollTop;return Ar(a||s).direction==="rtl"&&(l+=it(s.clientWidth,a?a.clientWidth:0)-i),{width:i,height:o,x:l,y:c}}function bc(r){var t=Ar(r),s=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+n)}function mv(r){return["html","body","#document"].indexOf(Br(r))>=0?r.ownerDocument.body:pr(r)&&bc(r)?r:mv(Sn(r))}function es(r,t){var s;t===void 0&&(t=[]);var n=mv(r),a=n===((s=r.ownerDocument)==null?void 0:s.body),i=Ye(n),o=a?[i].concat(i.visualViewport||[],bc(n)?n:[]):n,l=t.concat(o);return a?l:l.concat(es(Sn(o)))}function Hl(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function Pj(r,t){var s=Pt(r,!1,t==="fixed");return s.top=s.top+r.clientTop,s.left=s.left+r.clientLeft,s.bottom=s.top+r.clientHeight,s.right=s.left+r.clientWidth,s.width=r.clientWidth,s.height=r.clientHeight,s.x=s.left,s.y=s.top,s}function $u(r,t,s){return t===iv?Hl(kj(r,s)):vt(t)?Pj(t,s):Hl(Dj(Kr(r)))}function Mj(r){var t=es(Sn(r)),s=["absolute","fixed"].indexOf(Ar(r).position)>=0,n=s&&pr(r)?Ss(r):r;return vt(n)?t.filter(function(a){return vt(a)&&lv(a,n)&&Br(a)!=="body"}):[]}function Oj(r,t,s,n){var a=t==="clippingParents"?Mj(r):[].concat(t),i=[].concat(a,[s]),o=i[0],l=i.reduce(function(c,u){var d=$u(r,u,n);return c.top=it(d.top,c.top),c.right=cn(d.right,c.right),c.bottom=cn(d.bottom,c.bottom),c.left=it(d.left,c.left),c},$u(r,o,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function hv(r){var t=r.reference,s=r.element,n=r.placement,a=n?hr(n):null,i=n?Mt(n):null,o=t.x+t.width/2-s.width/2,l=t.y+t.height/2-s.height/2,c;switch(a){case qe:c={x:o,y:t.y-s.height};break;case Je:c={x:o,y:t.y+t.height};break;case Ze:c={x:t.x+t.width,y:l};break;case Le:c={x:t.x-s.width,y:l};break;default:c={x:t.x,y:t.y}}var u=a?gc(a):null;if(u!=null){var d=u==="y"?"height":"width";switch(i){case kt:c[u]=c[u]-(t[d]/2-s[d]/2);break;case hs:c[u]=c[u]+(t[d]/2-s[d]/2);break}}return c}function ps(r,t){t===void 0&&(t={});var s=t,n=s.placement,a=n===void 0?r.placement:n,i=s.strategy,o=i===void 0?r.strategy:i,l=s.boundary,c=l===void 0?nj:l,u=s.rootBoundary,d=u===void 0?iv:u,h=s.elementContext,m=h===void 0?Wt:h,p=s.altBoundary,f=p===void 0?!1:p,v=s.padding,y=v===void 0?0:v,j=uv(typeof y!="number"?y:dv(y,_s)),g=m===Wt?aj:Wt,_=r.rects.popper,b=r.elements[f?g:m],N=Oj(vt(b)?b:b.contextElement||Kr(r.elements.popper),c,d,o),w=Pt(r.elements.reference),E=hv({reference:w,element:_,placement:a}),S=Hl(Object.assign({},_,E)),C=m===Wt?S:w,D={top:N.top-C.top+j.top,bottom:C.bottom-N.bottom+j.bottom,left:N.left-C.left+j.left,right:C.right-N.right+j.right},R=r.modifiersData.offset;if(m===Wt&&R){var O=R[a];Object.keys(D).forEach(function(T){var q=[Ze,Je].indexOf(T)>=0?1:-1,$=[qe,Je].indexOf(T)>=0?"y":"x";D[T]+=O[$]*q})}return D}function Ij(r,t){t===void 0&&(t={});var s=t,n=s.placement,a=s.boundary,i=s.rootBoundary,o=s.padding,l=s.flipVariations,c=s.allowedAutoPlacements,u=c===void 0?pc:c,d=Mt(n),h=d?l?Iu:Iu.filter(function(f){return Mt(f)===d}):_s,m=h.filter(function(f){return u.indexOf(f)>=0});m.length===0&&(m=h);var p=m.reduce(function(f,v){return f[v]=ps(r,{placement:v,boundary:a,rootBoundary:i,padding:o})[hr(v)],f},{});return Object.keys(p).sort(function(f,v){return p[f]-p[v]})}function qj(r){if(hr(r)===hc)return[];var t=Fs(r);return[Fu(r),t,Fu(t)]}function Lj(r){var t=r.state,s=r.options,n=r.name;if(!t.modifiersData[n]._skip){for(var a=s.mainAxis,i=a===void 0?!0:a,o=s.altAxis,l=o===void 0?!0:o,c=s.fallbackPlacements,u=s.padding,d=s.boundary,h=s.rootBoundary,m=s.altBoundary,p=s.flipVariations,f=p===void 0?!0:p,v=s.allowedAutoPlacements,y=t.options.placement,j=hr(y),g=j===y,_=c||(g||!f?[Fs(y)]:qj(y)),b=[y].concat(_).reduce(function(Pe,he){return Pe.concat(hr(he)===hc?Ij(t,{placement:he,boundary:d,rootBoundary:h,padding:u,flipVariations:f,allowedAutoPlacements:v}):he)},[]),N=t.rects.reference,w=t.rects.popper,E=new Map,S=!0,C=b[0],D=0;D<b.length;D++){var R=b[D],O=hr(R),T=Mt(R)===kt,q=[qe,Je].indexOf(O)>=0,$=q?"width":"height",z=ps(t,{placement:R,boundary:d,rootBoundary:h,altBoundary:m,padding:u}),J=q?T?Ze:Le:T?Je:qe;N[$]>w[$]&&(J=Fs(J));var ne=Fs(J),le=[];if(i&&le.push(z[O]<=0),l&&le.push(z[J]<=0,z[ne]<=0),le.every(function(Pe){return Pe})){C=R,S=!1;break}E.set(R,le)}if(S)for(var M=f?3:1,F=function(he){var Me=b.find(function(Ve){var Xe=E.get(Ve);if(Xe)return Xe.slice(0,he).every(function(Lr){return Lr})});if(Me)return C=Me,"break"},de=M;de>0;de--){var re=F(de);if(re==="break")break}t.placement!==C&&(t.modifiersData[n]._skip=!0,t.placement=C,t.reset=!0)}}const Fj={name:"flip",enabled:!0,phase:"main",fn:Lj,requiresIfExists:["offset"],data:{_skip:!1}};function zu(r,t,s){return s===void 0&&(s={x:0,y:0}),{top:r.top-t.height-s.y,right:r.right-t.width+s.x,bottom:r.bottom-t.height+s.y,left:r.left-t.width-s.x}}function Uu(r){return[qe,Ze,Je,Le].some(function(t){return r[t]>=0})}function $j(r){var t=r.state,s=r.name,n=t.rects.reference,a=t.rects.popper,i=t.modifiersData.preventOverflow,o=ps(t,{elementContext:"reference"}),l=ps(t,{altBoundary:!0}),c=zu(o,n),u=zu(l,a,i),d=Uu(c),h=Uu(u);t.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}const zj={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:$j};function Uj(r,t,s){var n=hr(r),a=[Le,qe].indexOf(n)>=0?-1:1,i=typeof s=="function"?s(Object.assign({},t,{placement:r})):s,o=i[0],l=i[1];return o=o||0,l=(l||0)*a,[Le,Ze].indexOf(n)>=0?{x:l,y:o}:{x:o,y:l}}function Bj(r){var t=r.state,s=r.options,n=r.name,a=s.offset,i=a===void 0?[0,0]:a,o=pc.reduce(function(d,h){return d[h]=Uj(h,t.rects,i),d},{}),l=o[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=o}const Hj={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Bj};function Wj(r){var t=r.state,s=r.name;t.modifiersData[s]=hv({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Gj={name:"popperOffsets",enabled:!0,phase:"read",fn:Wj,data:{}};function Kj(r){return r==="x"?"y":"x"}function Yj(r){var t=r.state,s=r.options,n=r.name,a=s.mainAxis,i=a===void 0?!0:a,o=s.altAxis,l=o===void 0?!1:o,c=s.boundary,u=s.rootBoundary,d=s.altBoundary,h=s.padding,m=s.tether,p=m===void 0?!0:m,f=s.tetherOffset,v=f===void 0?0:f,y=ps(t,{boundary:c,rootBoundary:u,padding:h,altBoundary:d}),j=hr(t.placement),g=Mt(t.placement),_=!g,b=gc(j),N=Kj(b),w=t.modifiersData.popperOffsets,E=t.rects.reference,S=t.rects.popper,C=typeof v=="function"?v(Object.assign({},t.rects,{placement:t.placement})):v,D=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),R=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,O={x:0,y:0};if(w){if(i){var T,q=b==="y"?qe:Le,$=b==="y"?Je:Ze,z=b==="y"?"height":"width",J=w[b],ne=J+y[q],le=J-y[$],M=p?-S[z]/2:0,F=g===kt?E[z]:S[z],de=g===kt?-S[z]:-E[z],re=t.elements.arrow,Pe=p&&re?vc(re):{width:0,height:0},he=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:cv(),Me=he[q],Ve=he[$],Xe=Zt(0,E[z],Pe[z]),Lr=_?E[z]/2-M-Xe-Me-D.mainAxis:F-Xe-Me-D.mainAxis,jt=_?-E[z]/2+M+Xe+Ve+D.mainAxis:de+Xe+Ve+D.mainAxis,Fr=t.elements.arrow&&Ss(t.elements.arrow),wt=Fr?b==="y"?Fr.clientTop||0:Fr.clientLeft||0:0,Yr=(T=R==null?void 0:R[b])!=null?T:0,_t=J+Lr-Yr-wt,oe=J+jt-Yr,ur=Zt(p?cn(ne,_t):ne,J,p?it(le,oe):le);w[b]=ur,O[b]=ur-J}if(l){var ae,sr=b==="x"?qe:Le,Ce=b==="x"?Je:Ze,br=w[N],jr=N==="y"?"height":"width",nr=br+y[sr],Te=br-y[Ce],$r=[qe,Le].indexOf(j)!==-1,Vr=(ae=R==null?void 0:R[N])!=null?ae:0,Rs=$r?nr:br-E[jr]-S[jr]-Vr+D.altAxis,Ht=$r?br+E[jr]+S[jr]-Vr-D.altAxis:Te,wr=p&&$r?xj(Rs,br,Ht):Zt(p?Rs:nr,br,p?Ht:Te);w[N]=wr,O[N]=wr-br}t.modifiersData[n]=O}}const Vj={name:"preventOverflow",enabled:!0,phase:"main",fn:Yj,requiresIfExists:["offset"]};function Xj(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function Qj(r){return r===Ye(r)||!pr(r)?xc(r):Xj(r)}function Jj(r){var t=r.getBoundingClientRect(),s=Dt(t.width)/r.offsetWidth||1,n=Dt(t.height)/r.offsetHeight||1;return s!==1||n!==1}function Zj(r,t,s){s===void 0&&(s=!1);var n=pr(t),a=pr(t)&&Jj(t),i=Kr(t),o=Pt(r,a,s),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!s)&&((Br(t)!=="body"||bc(i))&&(l=Qj(t)),pr(t)?(c=Pt(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=yc(i))),{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}function e0(r){var t=new Map,s=new Set,n=[];r.forEach(function(i){t.set(i.name,i)});function a(i){s.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(l){if(!s.has(l)){var c=t.get(l);c&&a(c)}}),n.push(i)}return r.forEach(function(i){s.has(i.name)||a(i)}),n}function r0(r){var t=e0(r);return fj.reduce(function(s,n){return s.concat(t.filter(function(a){return a.phase===n}))},[])}function t0(r){var t;return function(){return t||(t=new Promise(function(s){Promise.resolve().then(function(){t=void 0,s(r())})})),t}}function s0(r){var t=r.reduce(function(s,n){var a=s[n.name];return s[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,s},{});return Object.keys(t).map(function(s){return t[s]})}var Bu={placement:"bottom",modifiers:[],strategy:"absolute"};function Hu(){for(var r=arguments.length,t=new Array(r),s=0;s<r;s++)t[s]=arguments[s];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function n0(r){r===void 0&&(r={});var t=r,s=t.defaultModifiers,n=s===void 0?[]:s,a=t.defaultOptions,i=a===void 0?Bu:a;return function(l,c,u){u===void 0&&(u=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Bu,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],m=!1,p={state:d,setOptions:function(j){var g=typeof j=="function"?j(d.options):j;v(),d.options=Object.assign({},i,d.options,g),d.scrollParents={reference:vt(l)?es(l):l.contextElement?es(l.contextElement):[],popper:es(c)};var _=r0(s0([].concat(n,d.options.modifiers)));return d.orderedModifiers=_.filter(function(b){return b.enabled}),f(),p.update()},forceUpdate:function(){if(!m){var j=d.elements,g=j.reference,_=j.popper;if(Hu(g,_)){d.rects={reference:Zj(g,Ss(_),d.options.strategy==="fixed"),popper:vc(_)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(D){return d.modifiersData[D.name]=Object.assign({},D.data)});for(var b=0;b<d.orderedModifiers.length;b++){if(d.reset===!0){d.reset=!1,b=-1;continue}var N=d.orderedModifiers[b],w=N.fn,E=N.options,S=E===void 0?{}:E,C=N.name;typeof w=="function"&&(d=w({state:d,options:S,name:C,instance:p})||d)}}}},update:t0(function(){return new Promise(function(y){p.forceUpdate(),y(d)})}),destroy:function(){v(),m=!0}};if(!Hu(l,c))return p;p.setOptions(u).then(function(y){!m&&u.onFirstUpdate&&u.onFirstUpdate(y)});function f(){d.orderedModifiers.forEach(function(y){var j=y.name,g=y.options,_=g===void 0?{}:g,b=y.effect;if(typeof b=="function"){var N=b({state:d,name:j,instance:p,options:_}),w=function(){};h.push(N||w)}})}function v(){h.forEach(function(y){return y()}),h=[]}return p}}var a0=n0({defaultModifiers:[zj,Gj,Ej,Tj,Hj,Fj,Vj,wj]}),Wu=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},i0={name:"applyStyles",enabled:!1},o0={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var s=t.state;return function(){var n=s.elements,a=n.reference,i=n.popper;if("removeAttribute"in a){var o=(a.getAttribute("aria-describedby")||"").split(",").filter(function(l){return l.trim()!==i.id});o.length?a.setAttribute("aria-describedby",o.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var s,n=t.state,a=n.elements,i=a.popper,o=a.reference,l=(s=i.getAttribute("role"))==null?void 0:s.toLowerCase();if(i.id&&l==="tooltip"&&"setAttribute"in o){var c=o.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(i.id)!==-1)return;o.setAttribute("aria-describedby",c?c+","+i.id:i.id)}}},l0=[];function c0(r,t,s){var n=s===void 0?{}:s,a=n.enabled,i=a===void 0?!0:a,o=n.placement,l=o===void 0?"bottom":o,c=n.strategy,u=c===void 0?"absolute":c,d=n.modifiers,h=d===void 0?l0:d,m=jn(n,["enabled","placement","strategy","modifiers"]),p=x.useRef(),f=x.useCallback(function(){var b;(b=p.current)==null||b.update()},[]),v=x.useCallback(function(){var b;(b=p.current)==null||b.forceUpdate()},[]),y=sj(x.useState({placement:l,update:f,forceUpdate:v,attributes:{},styles:{popper:Wu(u),arrow:{}}})),j=y[0],g=y[1],_=x.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(N){var w=N.state,E={},S={};Object.keys(w.elements).forEach(function(C){E[C]=w.styles[C],S[C]=w.attributes[C]}),g({state:w,styles:E,attributes:S,update:f,forceUpdate:v,placement:w.placement})}}},[f,v,g]);return x.useEffect(function(){!p.current||!i||p.current.setOptions({placement:l,strategy:u,modifiers:[].concat(h,[_,i0])})},[u,l,_,i]),x.useEffect(function(){if(!(!i||r==null||t==null))return p.current=a0(r,t,ye({},m,{placement:l,strategy:u,modifiers:[].concat(h,[o0,_])})),function(){p.current!=null&&(p.current.destroy(),p.current=void 0,g(function(b){return ye({},b,{attributes:{},styles:{popper:Wu(u)}})}))}},[i,r,t]),j}function u0(r,t,s,n){var a=n&&typeof n!="boolean"?n.capture:n;r.removeEventListener(t,s,a),s.__once&&r.removeEventListener(t,s.__once,a)}function Yt(r,t,s,n){return ej(r,t,s,n),function(){u0(r,t,s,n)}}var va,Gu;function d0(){if(Gu)return va;Gu=1;var r=function(){};return va=r,va}var m0=d0();const h0=vr(m0);function p0(r){return r&&"setState"in r?Mp.findDOMNode(r):r??null}const f0=function(r){return ws(p0(r))};var v0=27,Ku=function(){};function g0(r){return r.button===0}function x0(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}var Yu=function(t){return t&&("current"in t?t.current:t)};function y0(r,t,s){var n=s===void 0?{}:s,a=n.disabled,i=n.clickTrigger,o=i===void 0?"click":i,l=x.useRef(!1),c=t||Ku,u=x.useCallback(function(m){var p,f=Yu(r);h0(!!f,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),l.current=!f||x0(m)||!g0(m)||!!ms(f,(p=m.composedPath==null?void 0:m.composedPath()[0])!=null?p:m.target)},[r]),d=Mu(function(m){l.current||c(m)}),h=Mu(function(m){m.keyCode===v0&&c(m)});x.useEffect(function(){if(!(a||r==null)){var m=window.event,p=f0(Yu(r)),f=Yt(p,o,u,!0),v=Yt(p,o,function(g){if(g===m){m=void 0;return}d(g)}),y=Yt(p,"keyup",function(g){if(g===m){m=void 0;return}h(g)}),j=[];return"ontouchstart"in p.documentElement&&(j=[].slice.call(p.body.children).map(function(g){return Yt(g,"mousemove",Ku)})),function(){f(),v(),y(),j.forEach(function(g){return g()})}}},[r,a,o,u,d,h])}function b0(r){var t={};return Array.isArray(r)?(r==null||r.forEach(function(s){t[s.name]=s}),t):r||t}function j0(r){return r===void 0&&(r={}),Array.isArray(r)?r:Object.keys(r).map(function(t){return r[t].name=t,r[t]})}function w0(r){var t,s,n,a,i=r.enabled,o=r.enableEvents,l=r.placement,c=r.flip,u=r.offset,d=r.fixed,h=r.containerPadding,m=r.arrowElement,p=r.popperConfig,f=p===void 0?{}:p,v=b0(f.modifiers);return ye({},f,{placement:l,enabled:i,strategy:d?"fixed":f.strategy,modifiers:j0(ye({},v,{eventListeners:{enabled:o},preventOverflow:ye({},v.preventOverflow,{options:h?ye({padding:h},(t=v.preventOverflow)==null?void 0:t.options):(s=v.preventOverflow)==null?void 0:s.options}),offset:{options:ye({offset:u},(n=v.offset)==null?void 0:n.options)},arrow:ye({},v.arrow,{enabled:!!m,options:ye({},(a=v.arrow)==null?void 0:a.options,{element:m})}),flip:ye({enabled:!!c},v.flip)}))})}function _0(r,t){return r.classList?r.classList.contains(t):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+t+" ")!==-1}function S0(r,t){r.classList?r.classList.add(t):_0(r,t)||(typeof r.className=="string"?r.className=r.className+" "+t:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+t))}function Vu(r,t){return r.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function N0(r,t){r.classList?r.classList.remove(t):typeof r.className=="string"?r.className=Vu(r.className,t):r.setAttribute("class",Vu(r.className&&r.className.baseVal||"",t))}var Ps;function jc(r){if((!Ps&&Ps!==0||r)&&mc){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),Ps=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Ps}var ga=function(t){var s;return typeof document>"u"?null:t==null?ws().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(s=t)!=null&&s.nodeType&&t||null)};function Xu(r,t){var s=x.useState(function(){return ga(r)}),n=s[0],a=s[1];if(!n){var i=ga(r);i&&a(i)}return x.useEffect(function(){},[t,n]),x.useEffect(function(){var o=ga(r);o!==n&&a(o)},[r,n]),n}const Qu=r=>!r||typeof r=="function"?r:t=>{r.current=t};function E0(r,t){const s=Qu(r),n=Qu(t);return a=>{s&&s(a),n&&n(a)}}function C0(r,t){return x.useMemo(()=>E0(r,t),[r,t])}var wc=A.forwardRef(function(r,t){var s=r.flip,n=r.offset,a=r.placement,i=r.containerPadding,o=i===void 0?5:i,l=r.popperConfig,c=l===void 0?{}:l,u=r.transition,d=Ou(),h=d[0],m=d[1],p=Ou(),f=p[0],v=p[1],y=C0(m,t),j=Xu(r.container),g=Xu(r.target),_=x.useState(!r.show),b=_[0],N=_[1],w=c0(g,h,w0({placement:a,enableEvents:!!r.show,containerPadding:o||5,flip:s,offset:n,arrowElement:f,popperConfig:c})),E=w.styles,S=w.attributes,C=jn(w,["styles","attributes"]);r.show?b&&N(!1):!r.transition&&!b&&N(!0);var D=function(){N(!0),r.onExited&&r.onExited.apply(r,arguments)},R=r.show||u&&!b;if(y0(h,r.onHide,{disabled:!r.rootClose||r.rootCloseDisabled,clickTrigger:r.rootCloseEvent}),!R)return null;var O=r.children(ye({},C,{show:!!r.show,props:ye({},S.popper,{style:E.popper,ref:y}),arrowProps:ye({},S.arrow,{style:E.arrow,ref:v})}));if(u){var T=r.onExit,q=r.onExiting,$=r.onEnter,z=r.onEntering,J=r.onEntered;O=A.createElement(u,{in:r.show,appear:!0,onExit:T,onExiting:q,onExited:D,onEnter:$,onEntering:z,onEntered:J},O)}return j?Mp.createPortal(O,j):null});wc.displayName="Overlay";wc.propTypes={show:L.bool,placement:L.oneOf(pc),target:L.any,container:L.any,flip:L.bool,children:L.func.isRequired,containerPadding:L.number,popperConfig:L.object,rootClose:L.bool,rootCloseEvent:L.oneOf(["click","mousedown"]),rootCloseDisabled:L.bool,onHide:function(t){for(var s=arguments.length,n=new Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];if(t.rootClose){var i;return(i=L.func).isRequired.apply(i,[t].concat(n))}return L.func.apply(L,[t].concat(n))},transition:L.elementType,onEnter:L.func,onEntering:L.func,onEntered:L.func,onExit:L.func,onExiting:L.func,onExited:L.func};var xa,Ju;function T0(){if(Ju)return xa;Ju=1;function r(){this.__data__=[],this.size=0}return xa=r,xa}var ya,Zu;function Nn(){if(Zu)return ya;Zu=1;var r=ys();function t(s,n){for(var a=s.length;a--;)if(r(s[a][0],n))return a;return-1}return ya=t,ya}var ba,ed;function R0(){if(ed)return ba;ed=1;var r=Nn(),t=Array.prototype,s=t.splice;function n(a){var i=this.__data__,o=r(i,a);if(o<0)return!1;var l=i.length-1;return o==l?i.pop():s.call(i,o,1),--this.size,!0}return ba=n,ba}var ja,rd;function A0(){if(rd)return ja;rd=1;var r=Nn();function t(s){var n=this.__data__,a=r(n,s);return a<0?void 0:n[a][1]}return ja=t,ja}var wa,td;function k0(){if(td)return wa;td=1;var r=Nn();function t(s){return r(this.__data__,s)>-1}return wa=t,wa}var _a,sd;function D0(){if(sd)return _a;sd=1;var r=Nn();function t(s,n){var a=this.__data__,i=r(a,s);return i<0?(++this.size,a.push([s,n])):a[i][1]=n,this}return _a=t,_a}var Sa,nd;function En(){if(nd)return Sa;nd=1;var r=T0(),t=R0(),s=A0(),n=k0(),a=D0();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return i.prototype.clear=r,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=a,Sa=i,Sa}var Na,ad;function P0(){if(ad)return Na;ad=1;var r=En();function t(){this.__data__=new r,this.size=0}return Na=t,Na}var Ea,id;function M0(){if(id)return Ea;id=1;function r(t){var s=this.__data__,n=s.delete(t);return this.size=s.size,n}return Ea=r,Ea}var Ca,od;function O0(){if(od)return Ca;od=1;function r(t){return this.__data__.get(t)}return Ca=r,Ca}var Ta,ld;function I0(){if(ld)return Ta;ld=1;function r(t){return this.__data__.has(t)}return Ta=r,Ta}var Ra,cd;function q0(){if(cd)return Ra;cd=1;var r=yr(),t=r["__core-js_shared__"];return Ra=t,Ra}var Aa,ud;function L0(){if(ud)return Aa;ud=1;var r=q0(),t=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function s(n){return!!t&&t in n}return Aa=s,Aa}var ka,dd;function pv(){if(dd)return ka;dd=1;var r=Function.prototype,t=r.toString;function s(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return ka=s,ka}var Da,md;function F0(){if(md)return Da;md=1;var r=lc(),t=L0(),s=qr(),n=pv(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(m){if(!s(m)||t(m))return!1;var p=r(m)?d:i;return p.test(n(m))}return Da=h,Da}var Pa,hd;function $0(){if(hd)return Pa;hd=1;function r(t,s){return t==null?void 0:t[s]}return Pa=r,Pa}var Ma,pd;function bt(){if(pd)return Ma;pd=1;var r=F0(),t=$0();function s(n,a){var i=t(n,a);return r(i)?i:void 0}return Ma=s,Ma}var Oa,fd;function _c(){if(fd)return Oa;fd=1;var r=bt(),t=yr(),s=r(t,"Map");return Oa=s,Oa}var Ia,vd;function Cn(){if(vd)return Ia;vd=1;var r=bt(),t=r(Object,"create");return Ia=t,Ia}var qa,gd;function z0(){if(gd)return qa;gd=1;var r=Cn();function t(){this.__data__=r?r(null):{},this.size=0}return qa=t,qa}var La,xd;function U0(){if(xd)return La;xd=1;function r(t){var s=this.has(t)&&delete this.__data__[t];return this.size-=s?1:0,s}return La=r,La}var Fa,yd;function B0(){if(yd)return Fa;yd=1;var r=Cn(),t="__lodash_hash_undefined__",s=Object.prototype,n=s.hasOwnProperty;function a(i){var o=this.__data__;if(r){var l=o[i];return l===t?void 0:l}return n.call(o,i)?o[i]:void 0}return Fa=a,Fa}var $a,bd;function H0(){if(bd)return $a;bd=1;var r=Cn(),t=Object.prototype,s=t.hasOwnProperty;function n(a){var i=this.__data__;return r?i[a]!==void 0:s.call(i,a)}return $a=n,$a}var za,jd;function W0(){if(jd)return za;jd=1;var r=Cn(),t="__lodash_hash_undefined__";function s(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=r&&a===void 0?t:a,this}return za=s,za}var Ua,wd;function G0(){if(wd)return Ua;wd=1;var r=z0(),t=U0(),s=B0(),n=H0(),a=W0();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return i.prototype.clear=r,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=a,Ua=i,Ua}var Ba,_d;function K0(){if(_d)return Ba;_d=1;var r=G0(),t=En(),s=_c();function n(){this.size=0,this.__data__={hash:new r,map:new(s||t),string:new r}}return Ba=n,Ba}var Ha,Sd;function Y0(){if(Sd)return Ha;Sd=1;function r(t){var s=typeof t;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?t!=="__proto__":t===null}return Ha=r,Ha}var Wa,Nd;function Tn(){if(Nd)return Wa;Nd=1;var r=Y0();function t(s,n){var a=s.__data__;return r(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Wa=t,Wa}var Ga,Ed;function V0(){if(Ed)return Ga;Ed=1;var r=Tn();function t(s){var n=r(this,s).delete(s);return this.size-=n?1:0,n}return Ga=t,Ga}var Ka,Cd;function X0(){if(Cd)return Ka;Cd=1;var r=Tn();function t(s){return r(this,s).get(s)}return Ka=t,Ka}var Ya,Td;function Q0(){if(Td)return Ya;Td=1;var r=Tn();function t(s){return r(this,s).has(s)}return Ya=t,Ya}var Va,Rd;function J0(){if(Rd)return Va;Rd=1;var r=Tn();function t(s,n){var a=r(this,s),i=a.size;return a.set(s,n),this.size+=a.size==i?0:1,this}return Va=t,Va}var Xa,Ad;function Sc(){if(Ad)return Xa;Ad=1;var r=K0(),t=V0(),s=X0(),n=Q0(),a=J0();function i(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return i.prototype.clear=r,i.prototype.delete=t,i.prototype.get=s,i.prototype.has=n,i.prototype.set=a,Xa=i,Xa}var Qa,kd;function Z0(){if(kd)return Qa;kd=1;var r=En(),t=_c(),s=Sc(),n=200;function a(i,o){var l=this.__data__;if(l instanceof r){var c=l.__data__;if(!t||c.length<n-1)return c.push([i,o]),this.size=++l.size,this;l=this.__data__=new s(c)}return l.set(i,o),this.size=l.size,this}return Qa=a,Qa}var Ja,Dd;function Nc(){if(Dd)return Ja;Dd=1;var r=En(),t=P0(),s=M0(),n=O0(),a=I0(),i=Z0();function o(l){var c=this.__data__=new r(l);this.size=c.size}return o.prototype.clear=t,o.prototype.delete=s,o.prototype.get=n,o.prototype.has=a,o.prototype.set=i,Ja=o,Ja}var Za,Pd;function ew(){if(Pd)return Za;Pd=1;var r="__lodash_hash_undefined__";function t(s){return this.__data__.set(s,r),this}return Za=t,Za}var ei,Md;function rw(){if(Md)return ei;Md=1;function r(t){return this.__data__.has(t)}return ei=r,ei}var ri,Od;function tw(){if(Od)return ri;Od=1;var r=Sc(),t=ew(),s=rw();function n(a){var i=-1,o=a==null?0:a.length;for(this.__data__=new r;++i<o;)this.add(a[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=s,ri=n,ri}var ti,Id;function sw(){if(Id)return ti;Id=1;function r(t,s){for(var n=-1,a=t==null?0:t.length;++n<a;)if(s(t[n],n,t))return!0;return!1}return ti=r,ti}var si,qd;function nw(){if(qd)return si;qd=1;function r(t,s){return t.has(s)}return si=r,si}var ni,Ld;function fv(){if(Ld)return ni;Ld=1;var r=tw(),t=sw(),s=nw(),n=1,a=2;function i(o,l,c,u,d,h){var m=c&n,p=o.length,f=l.length;if(p!=f&&!(m&&f>p))return!1;var v=h.get(o),y=h.get(l);if(v&&y)return v==l&&y==o;var j=-1,g=!0,_=c&a?new r:void 0;for(h.set(o,l),h.set(l,o);++j<p;){var b=o[j],N=l[j];if(u)var w=m?u(N,b,j,l,o,h):u(b,N,j,o,l,h);if(w!==void 0){if(w)continue;g=!1;break}if(_){if(!t(l,function(E,S){if(!s(_,S)&&(b===E||d(b,E,c,u,h)))return _.push(S)})){g=!1;break}}else if(!(b===N||d(b,N,c,u,h))){g=!1;break}}return h.delete(o),h.delete(l),g}return ni=i,ni}var ai,Fd;function vv(){if(Fd)return ai;Fd=1;var r=yr(),t=r.Uint8Array;return ai=t,ai}var ii,$d;function aw(){if($d)return ii;$d=1;function r(t){var s=-1,n=Array(t.size);return t.forEach(function(a,i){n[++s]=[i,a]}),n}return ii=r,ii}var oi,zd;function iw(){if(zd)return oi;zd=1;function r(t){var s=-1,n=Array(t.size);return t.forEach(function(a){n[++s]=a}),n}return oi=r,oi}var li,Ud;function ow(){if(Ud)return li;Ud=1;var r=zt(),t=vv(),s=ys(),n=fv(),a=aw(),i=iw(),o=1,l=2,c="[object Boolean]",u="[object Date]",d="[object Error]",h="[object Map]",m="[object Number]",p="[object RegExp]",f="[object Set]",v="[object String]",y="[object Symbol]",j="[object ArrayBuffer]",g="[object DataView]",_=r?r.prototype:void 0,b=_?_.valueOf:void 0;function N(w,E,S,C,D,R,O){switch(S){case g:if(w.byteLength!=E.byteLength||w.byteOffset!=E.byteOffset)return!1;w=w.buffer,E=E.buffer;case j:return!(w.byteLength!=E.byteLength||!R(new t(w),new t(E)));case c:case u:case m:return s(+w,+E);case d:return w.name==E.name&&w.message==E.message;case p:case v:return w==E+"";case h:var T=a;case f:var q=C&o;if(T||(T=i),w.size!=E.size&&!q)return!1;var $=O.get(w);if($)return $==E;C|=l,O.set(w,E);var z=n(T(w),T(E),C,D,R,O);return O.delete(w),z;case y:if(b)return b.call(w)==b.call(E)}return!1}return li=N,li}var ci,Bd;function Ec(){if(Bd)return ci;Bd=1;function r(t,s){for(var n=-1,a=s.length,i=t.length;++n<a;)t[i+n]=s[n];return t}return ci=r,ci}var ui,Hd;function tr(){if(Hd)return ui;Hd=1;var r=Array.isArray;return ui=r,ui}var di,Wd;function gv(){if(Wd)return di;Wd=1;var r=Ec(),t=tr();function s(n,a,i){var o=a(n);return t(n)?o:r(o,i(n))}return di=s,di}var mi,Gd;function lw(){if(Gd)return mi;Gd=1;function r(t,s){for(var n=-1,a=t==null?0:t.length,i=0,o=[];++n<a;){var l=t[n];s(l,n,t)&&(o[i++]=l)}return o}return mi=r,mi}var hi,Kd;function xv(){if(Kd)return hi;Kd=1;function r(){return[]}return hi=r,hi}var pi,Yd;function Cc(){if(Yd)return pi;Yd=1;var r=lw(),t=xv(),s=Object.prototype,n=s.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(o){return o==null?[]:(o=Object(o),r(a(o),function(l){return n.call(o,l)}))}:t;return pi=i,pi}var fi,Vd;function cw(){if(Vd)return fi;Vd=1;function r(t,s){for(var n=-1,a=Array(t);++n<t;)a[n]=s(n);return a}return fi=r,fi}var vi,Xd;function uw(){if(Xd)return vi;Xd=1;var r=Ut(),t=Gr(),s="[object Arguments]";function n(a){return t(a)&&r(a)==s}return vi=n,vi}var gi,Qd;function Tc(){if(Qd)return gi;Qd=1;var r=uw(),t=Gr(),s=Object.prototype,n=s.hasOwnProperty,a=s.propertyIsEnumerable,i=r(function(){return arguments}())?r:function(o){return t(o)&&n.call(o,"callee")&&!a.call(o,"callee")};return gi=i,gi}var Vt={exports:{}},xi,Jd;function dw(){if(Jd)return xi;Jd=1;function r(){return!1}return xi=r,xi}Vt.exports;var Zd;function Rn(){return Zd||(Zd=1,function(r,t){var s=yr(),n=dw(),a=t&&!t.nodeType&&t,i=a&&!0&&r&&!r.nodeType&&r,o=i&&i.exports===a,l=o?s.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;r.exports=u}(Vt,Vt.exports)),Vt.exports}var yi,em;function mw(){if(em)return yi;em=1;var r=Ut(),t=cc(),s=Gr(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",o="[object Date]",l="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",h="[object Object]",m="[object RegExp]",p="[object Set]",f="[object String]",v="[object WeakMap]",y="[object ArrayBuffer]",j="[object DataView]",g="[object Float32Array]",_="[object Float64Array]",b="[object Int8Array]",N="[object Int16Array]",w="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",C="[object Uint16Array]",D="[object Uint32Array]",R={};R[g]=R[_]=R[b]=R[N]=R[w]=R[E]=R[S]=R[C]=R[D]=!0,R[n]=R[a]=R[y]=R[i]=R[j]=R[o]=R[l]=R[c]=R[u]=R[d]=R[h]=R[m]=R[p]=R[f]=R[v]=!1;function O(T){return s(T)&&t(T.length)&&!!R[r(T)]}return yi=O,yi}var bi,rm;function An(){if(rm)return bi;rm=1;function r(t){return function(s){return t(s)}}return bi=r,bi}var Xt={exports:{}};Xt.exports;var tm;function Rc(){return tm||(tm=1,function(r,t){var s=Jf(),n=t&&!t.nodeType&&t,a=n&&!0&&r&&!r.nodeType&&r,i=a&&a.exports===n,o=i&&s.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();r.exports=l}(Xt,Xt.exports)),Xt.exports}var ji,sm;function Ac(){if(sm)return ji;sm=1;var r=mw(),t=An(),s=Rc(),n=s&&s.isTypedArray,a=n?t(n):r;return ji=a,ji}var wi,nm;function yv(){if(nm)return wi;nm=1;var r=cw(),t=Tc(),s=tr(),n=Rn(),a=uc(),i=Ac(),o=Object.prototype,l=o.hasOwnProperty;function c(u,d){var h=s(u),m=!h&&t(u),p=!h&&!m&&n(u),f=!h&&!m&&!p&&i(u),v=h||m||p||f,y=v?r(u.length,String):[],j=y.length;for(var g in u)(d||l.call(u,g))&&!(v&&(g=="length"||p&&(g=="offset"||g=="parent")||f&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||a(g,j)))&&y.push(g);return y}return wi=c,wi}var _i,am;function kc(){if(am)return _i;am=1;var r=Object.prototype;function t(s){var n=s&&s.constructor,a=typeof n=="function"&&n.prototype||r;return s===a}return _i=t,_i}var Si,im;function bv(){if(im)return Si;im=1;function r(t,s){return function(n){return t(s(n))}}return Si=r,Si}var Ni,om;function hw(){if(om)return Ni;om=1;var r=bv(),t=r(Object.keys,Object);return Ni=t,Ni}var Ei,lm;function pw(){if(lm)return Ei;lm=1;var r=kc(),t=hw(),s=Object.prototype,n=s.hasOwnProperty;function a(i){if(!r(i))return t(i);var o=[];for(var l in Object(i))n.call(i,l)&&l!="constructor"&&o.push(l);return o}return Ei=a,Ei}var Ci,cm;function Ns(){if(cm)return Ci;cm=1;var r=yv(),t=pw(),s=bs();function n(a){return s(a)?r(a):t(a)}return Ci=n,Ci}var Ti,um;function jv(){if(um)return Ti;um=1;var r=gv(),t=Cc(),s=Ns();function n(a){return r(a,s,t)}return Ti=n,Ti}var Ri,dm;function fw(){if(dm)return Ri;dm=1;var r=jv(),t=1,s=Object.prototype,n=s.hasOwnProperty;function a(i,o,l,c,u,d){var h=l&t,m=r(i),p=m.length,f=r(o),v=f.length;if(p!=v&&!h)return!1;for(var y=p;y--;){var j=m[y];if(!(h?j in o:n.call(o,j)))return!1}var g=d.get(i),_=d.get(o);if(g&&_)return g==o&&_==i;var b=!0;d.set(i,o),d.set(o,i);for(var N=h;++y<p;){j=m[y];var w=i[j],E=o[j];if(c)var S=h?c(E,w,j,o,i,d):c(w,E,j,i,o,d);if(!(S===void 0?w===E||u(w,E,l,c,d):S)){b=!1;break}N||(N=j=="constructor")}if(b&&!N){var C=i.constructor,D=o.constructor;C!=D&&"constructor"in i&&"constructor"in o&&!(typeof C=="function"&&C instanceof C&&typeof D=="function"&&D instanceof D)&&(b=!1)}return d.delete(i),d.delete(o),b}return Ri=a,Ri}var Ai,mm;function vw(){if(mm)return Ai;mm=1;var r=bt(),t=yr(),s=r(t,"DataView");return Ai=s,Ai}var ki,hm;function gw(){if(hm)return ki;hm=1;var r=bt(),t=yr(),s=r(t,"Promise");return ki=s,ki}var Di,pm;function xw(){if(pm)return Di;pm=1;var r=bt(),t=yr(),s=r(t,"Set");return Di=s,Di}var Pi,fm;function yw(){if(fm)return Pi;fm=1;var r=bt(),t=yr(),s=r(t,"WeakMap");return Pi=s,Pi}var Mi,vm;function kn(){if(vm)return Mi;vm=1;var r=vw(),t=_c(),s=gw(),n=xw(),a=yw(),i=Ut(),o=pv(),l="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",h="[object WeakMap]",m="[object DataView]",p=o(r),f=o(t),v=o(s),y=o(n),j=o(a),g=i;return(r&&g(new r(new ArrayBuffer(1)))!=m||t&&g(new t)!=l||s&&g(s.resolve())!=u||n&&g(new n)!=d||a&&g(new a)!=h)&&(g=function(_){var b=i(_),N=b==c?_.constructor:void 0,w=N?o(N):"";if(w)switch(w){case p:return m;case f:return l;case v:return u;case y:return d;case j:return h}return b}),Mi=g,Mi}var Oi,gm;function bw(){if(gm)return Oi;gm=1;var r=Nc(),t=fv(),s=ow(),n=fw(),a=kn(),i=tr(),o=Rn(),l=Ac(),c=1,u="[object Arguments]",d="[object Array]",h="[object Object]",m=Object.prototype,p=m.hasOwnProperty;function f(v,y,j,g,_,b){var N=i(v),w=i(y),E=N?d:a(v),S=w?d:a(y);E=E==u?h:E,S=S==u?h:S;var C=E==h,D=S==h,R=E==S;if(R&&o(v)){if(!o(y))return!1;N=!0,C=!1}if(R&&!C)return b||(b=new r),N||l(v)?t(v,y,j,g,_,b):s(v,y,E,j,g,_,b);if(!(j&c)){var O=C&&p.call(v,"__wrapped__"),T=D&&p.call(y,"__wrapped__");if(O||T){var q=O?v.value():v,$=T?y.value():y;return b||(b=new r),_(q,$,j,g,b)}}return R?(b||(b=new r),n(v,y,j,g,_,b)):!1}return Oi=f,Oi}var Ii,xm;function Dc(){if(xm)return Ii;xm=1;var r=bw(),t=Gr();function s(n,a,i,o,l){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:r(n,a,i,o,s,l)}return Ii=s,Ii}var qi,ym;function jw(){if(ym)return qi;ym=1;var r=Dc();function t(s,n){return r(s,n)}return qi=t,qi}var ww=jw();const _w=vr(ww);function Li(r,t){var s=dc(r);return s?s.innerHeight:at(r).height}function wv(r,t,s){r.closest&&!s&&r.closest(t);var n=r;do{if(Qb(n,t))return n;n=n.parentElement}while(n&&n!==s&&n.nodeType===document.ELEMENT_NODE);return null}var Fi,bm;function Sw(){if(bm)return Fi;bm=1;function r(t,s,n,a){for(var i=t.length,o=n+(a?1:-1);a?o--:++o<i;)if(s(t[o],o,t))return o;return-1}return Fi=r,Fi}var $i,jm;function Nw(){if(jm)return $i;jm=1;var r=Nc(),t=Dc(),s=1,n=2;function a(i,o,l,c){var u=l.length,d=u,h=!c;if(i==null)return!d;for(i=Object(i);u--;){var m=l[u];if(h&&m[2]?m[1]!==i[m[0]]:!(m[0]in i))return!1}for(;++u<d;){m=l[u];var p=m[0],f=i[p],v=m[1];if(h&&m[2]){if(f===void 0&&!(p in i))return!1}else{var y=new r;if(c)var j=c(f,v,p,i,o,y);if(!(j===void 0?t(v,f,s|n,c,y):j))return!1}}return!0}return $i=a,$i}var zi,wm;function _v(){if(wm)return zi;wm=1;var r=qr();function t(s){return s===s&&!r(s)}return zi=t,zi}var Ui,_m;function Ew(){if(_m)return Ui;_m=1;var r=_v(),t=Ns();function s(n){for(var a=t(n),i=a.length;i--;){var o=a[i],l=n[o];a[i]=[o,l,r(l)]}return a}return Ui=s,Ui}var Bi,Sm;function Sv(){if(Sm)return Bi;Sm=1;function r(t,s){return function(n){return n==null?!1:n[t]===s&&(s!==void 0||t in Object(n))}}return Bi=r,Bi}var Hi,Nm;function Cw(){if(Nm)return Hi;Nm=1;var r=Nw(),t=Ew(),s=Sv();function n(a){var i=t(a);return i.length==1&&i[0][2]?s(i[0][0],i[0][1]):function(o){return o===a||r(o,a,i)}}return Hi=n,Hi}var Wi,Em;function Pc(){if(Em)return Wi;Em=1;var r=tr(),t=js(),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){if(r(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:n.test(i)||!s.test(i)||o!=null&&i in Object(o)}return Wi=a,Wi}var Gi,Cm;function Tw(){if(Cm)return Gi;Cm=1;var r=Sc(),t="Expected a function";function s(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var i=function(){var o=arguments,l=a?a.apply(this,o):o[0],c=i.cache;if(c.has(l))return c.get(l);var u=n.apply(this,o);return i.cache=c.set(l,u)||c,u};return i.cache=new(s.Cache||r),i}return s.Cache=r,Gi=s,Gi}var Ki,Tm;function Rw(){if(Tm)return Ki;Tm=1;var r=Tw(),t=500;function s(n){var a=r(n,function(o){return i.size===t&&i.clear(),o}),i=a.cache;return a}return Ki=s,Ki}var Yi,Rm;function Aw(){if(Rm)return Yi;Rm=1;var r=Rw(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,n=r(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(t,function(o,l,c,u){i.push(c?u.replace(s,"$1"):l||o)}),i});return Yi=n,Yi}var Vi,Am;function Mc(){if(Am)return Vi;Am=1;function r(t,s){for(var n=-1,a=t==null?0:t.length,i=Array(a);++n<a;)i[n]=s(t[n],n,t);return i}return Vi=r,Vi}var Xi,km;function kw(){if(km)return Xi;km=1;var r=zt(),t=Mc(),s=tr(),n=js(),a=r?r.prototype:void 0,i=a?a.toString:void 0;function o(l){if(typeof l=="string")return l;if(s(l))return t(l,o)+"";if(n(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Xi=o,Xi}var Qi,Dm;function Dw(){if(Dm)return Qi;Dm=1;var r=kw();function t(s){return s==null?"":r(s)}return Qi=t,Qi}var Ji,Pm;function Dn(){if(Pm)return Ji;Pm=1;var r=tr(),t=Pc(),s=Aw(),n=Dw();function a(i,o){return r(i)?i:t(i,o)?[i]:s(n(i))}return Ji=a,Ji}var Zi,Mm;function Es(){if(Mm)return Zi;Mm=1;var r=js();function t(s){if(typeof s=="string"||r(s))return s;var n=s+"";return n=="0"&&1/s==-1/0?"-0":n}return Zi=t,Zi}var eo,Om;function Pn(){if(Om)return eo;Om=1;var r=Dn(),t=Es();function s(n,a){a=r(a,n);for(var i=0,o=a.length;n!=null&&i<o;)n=n[t(a[i++])];return i&&i==o?n:void 0}return eo=s,eo}var ro,Im;function Pw(){if(Im)return ro;Im=1;var r=Pn();function t(s,n,a){var i=s==null?void 0:r(s,n);return i===void 0?a:i}return ro=t,ro}var to,qm;function Mw(){if(qm)return to;qm=1;function r(t,s){return t!=null&&s in Object(t)}return to=r,to}var so,Lm;function Ow(){if(Lm)return so;Lm=1;var r=Dn(),t=Tc(),s=tr(),n=uc(),a=cc(),i=Es();function o(l,c,u){c=r(c,l);for(var d=-1,h=c.length,m=!1;++d<h;){var p=i(c[d]);if(!(m=l!=null&&u(l,p)))break;l=l[p]}return m||++d!=h?m:(h=l==null?0:l.length,!!h&&a(h)&&n(p,h)&&(s(l)||t(l)))}return so=o,so}var no,Fm;function Iw(){if(Fm)return no;Fm=1;var r=Mw(),t=Ow();function s(n,a){return n!=null&&t(n,a,r)}return no=s,no}var ao,$m;function qw(){if($m)return ao;$m=1;var r=Dc(),t=Pw(),s=Iw(),n=Pc(),a=_v(),i=Sv(),o=Es(),l=1,c=2;function u(d,h){return n(d)&&a(h)?i(o(d),h):function(m){var p=t(m,d);return p===void 0&&p===h?s(m,d):r(h,p,l|c)}}return ao=u,ao}var io,zm;function Mn(){if(zm)return io;zm=1;function r(t){return t}return io=r,io}var oo,Um;function Lw(){if(Um)return oo;Um=1;function r(t){return function(s){return s==null?void 0:s[t]}}return oo=r,oo}var lo,Bm;function Fw(){if(Bm)return lo;Bm=1;var r=Pn();function t(s){return function(n){return r(n,s)}}return lo=t,lo}var co,Hm;function $w(){if(Hm)return co;Hm=1;var r=Lw(),t=Fw(),s=Pc(),n=Es();function a(i){return s(i)?r(n(i)):t(i)}return co=a,co}var uo,Wm;function On(){if(Wm)return uo;Wm=1;var r=Cw(),t=qw(),s=Mn(),n=tr(),a=$w();function i(o){return typeof o=="function"?o:o==null?s:typeof o=="object"?n(o)?t(o[0],o[1]):r(o):a(o)}return uo=i,uo}var mo,Gm;function zw(){if(Gm)return mo;Gm=1;var r=Sw(),t=On(),s=ev(),n=Math.max;function a(i,o,l){var c=i==null?0:i.length;if(!c)return-1;var u=l==null?0:s(l);return u<0&&(u=n(c+u,0)),r(i,t(o,3),u)}return mo=a,mo}var Uw=zw();const Bw=vr(Uw);var ho,Km;function Hw(){if(Km)return ho;Km=1;var r=Math.ceil,t=Math.max;function s(n,a,i,o){for(var l=-1,c=t(r((a-n)/(i||1)),0),u=Array(c);c--;)u[o?c:++l]=n,n+=i;return u}return ho=s,ho}var po,Ym;function Ww(){if(Ym)return po;Ym=1;var r=Hw(),t=_n(),s=Zf();function n(a){return function(i,o,l){return l&&typeof l!="number"&&t(i,o,l)&&(o=l=void 0),i=s(i),o===void 0?(o=i,i=0):o=s(o),l=l===void 0?i<o?1:-1:s(l),r(i,o,l,a)}}return po=n,po}var fo,Vm;function Gw(){if(Vm)return fo;Vm=1;var r=Ww(),t=r();return fo=t,fo}var Kw=Gw();const Yw=vr(Kw);var Xm=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Vw(r,t){return!!(r===t||Xm(r)&&Xm(t))}function Xw(r,t){if(r.length!==t.length)return!1;for(var s=0;s<r.length;s++)if(!Vw(r[s],t[s]))return!1;return!0}function Nv(r,t){t===void 0&&(t=Xw);var s=null;function n(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];if(s&&s.lastThis===this&&t(a,s.lastArgs))return s.lastResult;var o=r.apply(this,a);return s={lastResult:o,lastArgs:a,lastThis:this},o}return n.clear=function(){s=null},n}function Wl(r,t){var s=dc(r);return s?s.innerWidth:at(r).width}var vo,Qm;function Qw(){if(Qm)return vo;Qm=1;var r=zt(),t=Tc(),s=tr(),n=r?r.isConcatSpreadable:void 0;function a(i){return s(i)||t(i)||!!(n&&i&&i[n])}return vo=a,vo}var go,Jm;function Ev(){if(Jm)return go;Jm=1;var r=Ec(),t=Qw();function s(n,a,i,o,l){var c=-1,u=n.length;for(i||(i=t),l||(l=[]);++c<u;){var d=n[c];a>0&&i(d)?a>1?s(d,a-1,i,o,l):r(l,d):o||(l[l.length]=d)}return l}return go=s,go}var xo,Zm;function Jw(){if(Zm)return xo;Zm=1;function r(t){return function(s,n,a){for(var i=-1,o=Object(s),l=a(s),c=l.length;c--;){var u=l[t?c:++i];if(n(o[u],u,o)===!1)break}return s}}return xo=r,xo}var yo,eh;function Zw(){if(eh)return yo;eh=1;var r=Jw(),t=r();return yo=t,yo}var bo,rh;function Oc(){if(rh)return bo;rh=1;var r=Zw(),t=Ns();function s(n,a){return n&&r(n,a,t)}return bo=s,bo}var jo,th;function e_(){if(th)return jo;th=1;var r=bs();function t(s,n){return function(a,i){if(a==null)return a;if(!r(a))return s(a,i);for(var o=a.length,l=n?o:-1,c=Object(a);(n?l--:++l<o)&&i(c[l],l,c)!==!1;);return a}}return jo=t,jo}var wo,sh;function r_(){if(sh)return wo;sh=1;var r=Oc(),t=e_(),s=t(r);return wo=s,wo}var _o,nh;function t_(){if(nh)return _o;nh=1;var r=r_(),t=bs();function s(n,a){var i=-1,o=t(n)?Array(n.length):[];return r(n,function(l,c,u){o[++i]=a(l,c,u)}),o}return _o=s,_o}var So,ah;function s_(){if(ah)return So;ah=1;function r(t,s){var n=t.length;for(t.sort(s);n--;)t[n]=t[n].value;return t}return So=r,So}var No,ih;function n_(){if(ih)return No;ih=1;var r=js();function t(s,n){if(s!==n){var a=s!==void 0,i=s===null,o=s===s,l=r(s),c=n!==void 0,u=n===null,d=n===n,h=r(n);if(!u&&!h&&!l&&s>n||l&&c&&d&&!u&&!h||i&&c&&d||!a&&d||!o)return 1;if(!i&&!l&&!h&&s<n||h&&a&&o&&!i&&!l||u&&a&&o||!c&&o||!d)return-1}return 0}return No=t,No}var Eo,oh;function a_(){if(oh)return Eo;oh=1;var r=n_();function t(s,n,a){for(var i=-1,o=s.criteria,l=n.criteria,c=o.length,u=a.length;++i<c;){var d=r(o[i],l[i]);if(d){if(i>=u)return d;var h=a[i];return d*(h=="desc"?-1:1)}}return s.index-n.index}return Eo=t,Eo}var Co,lh;function i_(){if(lh)return Co;lh=1;var r=Mc(),t=Pn(),s=On(),n=t_(),a=s_(),i=An(),o=a_(),l=Mn(),c=tr();function u(d,h,m){h.length?h=r(h,function(v){return c(v)?function(y){return t(y,v.length===1?v[0]:v)}:v}):h=[l];var p=-1;h=r(h,i(s));var f=n(d,function(v,y,j){var g=r(h,function(_){return _(v)});return{criteria:g,index:++p,value:v}});return a(f,function(v,y){return o(v,y,m)})}return Co=u,Co}var To,ch;function o_(){if(ch)return To;ch=1;function r(t,s,n){switch(n.length){case 0:return t.call(s);case 1:return t.call(s,n[0]);case 2:return t.call(s,n[0],n[1]);case 3:return t.call(s,n[0],n[1],n[2])}return t.apply(s,n)}return To=r,To}var Ro,uh;function Cv(){if(uh)return Ro;uh=1;var r=o_(),t=Math.max;function s(n,a,i){return a=t(a===void 0?n.length-1:a,0),function(){for(var o=arguments,l=-1,c=t(o.length-a,0),u=Array(c);++l<c;)u[l]=o[a+l];l=-1;for(var d=Array(a+1);++l<a;)d[l]=o[l];return d[a]=i(u),r(n,this,d)}}return Ro=s,Ro}var Ao,dh;function l_(){if(dh)return Ao;dh=1;function r(t){return function(){return t}}return Ao=r,Ao}var ko,mh;function Tv(){if(mh)return ko;mh=1;var r=bt(),t=function(){try{var s=r(Object,"defineProperty");return s({},"",{}),s}catch{}}();return ko=t,ko}var Do,hh;function c_(){if(hh)return Do;hh=1;var r=l_(),t=Tv(),s=Mn(),n=t?function(a,i){return t(a,"toString",{configurable:!0,enumerable:!1,value:r(i),writable:!0})}:s;return Do=n,Do}var Po,ph;function u_(){if(ph)return Po;ph=1;var r=800,t=16,s=Date.now;function n(a){var i=0,o=0;return function(){var l=s(),c=t-(l-o);if(o=l,c>0){if(++i>=r)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return Po=n,Po}var Mo,fh;function Rv(){if(fh)return Mo;fh=1;var r=c_(),t=u_(),s=t(r);return Mo=s,Mo}var Oo,vh;function Av(){if(vh)return Oo;vh=1;var r=Mn(),t=Cv(),s=Rv();function n(a,i){return s(t(a,i,r),a+"")}return Oo=n,Oo}var Io,gh;function d_(){if(gh)return Io;gh=1;var r=Ev(),t=i_(),s=Av(),n=_n(),a=s(function(i,o){if(i==null)return[];var l=o.length;return l>1&&n(i,o[0],o[1])?o=[]:l>2&&n(o[0],o[1],o[2])&&(o=[o[0]]),t(i,r(o,1),[])});return Io=a,Io}var m_=d_();const h_=vr(m_);function kv(r){return If(r)||Xf(r)||ac(r)||qf()}var qo,xh;function p_(){if(xh)return qo;xh=1;function r(t){var s=[];if(t!=null)for(var n in Object(t))s.push(n);return s}return qo=r,qo}var Lo,yh;function f_(){if(yh)return Lo;yh=1;var r=qr(),t=kc(),s=p_(),n=Object.prototype,a=n.hasOwnProperty;function i(o){if(!r(o))return s(o);var l=t(o),c=[];for(var u in o)u=="constructor"&&(l||!a.call(o,u))||c.push(u);return c}return Lo=i,Lo}var Fo,bh;function In(){if(bh)return Fo;bh=1;var r=yv(),t=f_(),s=bs();function n(a){return s(a)?r(a,!0):t(a)}return Fo=n,Fo}var $o,jh;function v_(){if(jh)return $o;jh=1;var r=Av(),t=ys(),s=_n(),n=In(),a=Object.prototype,i=a.hasOwnProperty,o=r(function(l,c){l=Object(l);var u=-1,d=c.length,h=d>2?c[2]:void 0;for(h&&s(c[0],c[1],h)&&(d=1);++u<d;)for(var m=c[u],p=n(m),f=-1,v=p.length;++f<v;){var y=p[f],j=l[y];(j===void 0||t(j,a[y])&&!i.call(l,y))&&(l[y]=m[y])}return l});return $o=o,$o}var g_=v_();const x_=vr(g_);var zo,wh;function Ic(){if(wh)return zo;wh=1;var r=Tv();function t(s,n,a){n=="__proto__"&&r?r(s,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):s[n]=a}return zo=t,zo}var Uo,_h;function y_(){if(_h)return Uo;_h=1;var r=Ic(),t=Oc(),s=On();function n(a,i){var o={};return i=s(i,3),t(a,function(l,c,u){r(o,c,i(l,c,u))}),o}return Uo=n,Uo}var b_=y_();const j_=vr(b_);var Bo,Sh;function Dv(){if(Sh)return Bo;Sh=1;function r(t,s){for(var n=-1,a=t==null?0:t.length;++n<a&&s(t[n],n,t)!==!1;);return t}return Bo=r,Bo}var Ho,Nh;function Pv(){if(Nh)return Ho;Nh=1;var r=Ic(),t=ys(),s=Object.prototype,n=s.hasOwnProperty;function a(i,o,l){var c=i[o];(!(n.call(i,o)&&t(c,l))||l===void 0&&!(o in i))&&r(i,o,l)}return Ho=a,Ho}var Wo,Eh;function Cs(){if(Eh)return Wo;Eh=1;var r=Pv(),t=Ic();function s(n,a,i,o){var l=!i;i||(i={});for(var c=-1,u=a.length;++c<u;){var d=a[c],h=o?o(i[d],n[d],d,i,n):void 0;h===void 0&&(h=n[d]),l?t(i,d,h):r(i,d,h)}return i}return Wo=s,Wo}var Go,Ch;function w_(){if(Ch)return Go;Ch=1;var r=Cs(),t=Ns();function s(n,a){return n&&r(a,t(a),n)}return Go=s,Go}var Ko,Th;function __(){if(Th)return Ko;Th=1;var r=Cs(),t=In();function s(n,a){return n&&r(a,t(a),n)}return Ko=s,Ko}var Qt={exports:{}};Qt.exports;var Rh;function S_(){return Rh||(Rh=1,function(r,t){var s=yr(),n=t&&!t.nodeType&&t,a=n&&!0&&r&&!r.nodeType&&r,i=a&&a.exports===n,o=i?s.Buffer:void 0,l=o?o.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var h=u.length,m=l?l(h):new u.constructor(h);return u.copy(m),m}r.exports=c}(Qt,Qt.exports)),Qt.exports}var Yo,Ah;function N_(){if(Ah)return Yo;Ah=1;function r(t,s){var n=-1,a=t.length;for(s||(s=Array(a));++n<a;)s[n]=t[n];return s}return Yo=r,Yo}var Vo,kh;function E_(){if(kh)return Vo;kh=1;var r=Cs(),t=Cc();function s(n,a){return r(n,t(n),a)}return Vo=s,Vo}var Xo,Dh;function qn(){if(Dh)return Xo;Dh=1;var r=bv(),t=r(Object.getPrototypeOf,Object);return Xo=t,Xo}var Qo,Ph;function Mv(){if(Ph)return Qo;Ph=1;var r=Ec(),t=qn(),s=Cc(),n=xv(),a=Object.getOwnPropertySymbols,i=a?function(o){for(var l=[];o;)r(l,s(o)),o=t(o);return l}:n;return Qo=i,Qo}var Jo,Mh;function C_(){if(Mh)return Jo;Mh=1;var r=Cs(),t=Mv();function s(n,a){return r(n,t(n),a)}return Jo=s,Jo}var Zo,Oh;function Ov(){if(Oh)return Zo;Oh=1;var r=gv(),t=Mv(),s=In();function n(a){return r(a,s,t)}return Zo=n,Zo}var el,Ih;function T_(){if(Ih)return el;Ih=1;var r=Object.prototype,t=r.hasOwnProperty;function s(n){var a=n.length,i=new n.constructor(a);return a&&typeof n[0]=="string"&&t.call(n,"index")&&(i.index=n.index,i.input=n.input),i}return el=s,el}var rl,qh;function qc(){if(qh)return rl;qh=1;var r=vv();function t(s){var n=new s.constructor(s.byteLength);return new r(n).set(new r(s)),n}return rl=t,rl}var tl,Lh;function R_(){if(Lh)return tl;Lh=1;var r=qc();function t(s,n){var a=n?r(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.byteLength)}return tl=t,tl}var sl,Fh;function A_(){if(Fh)return sl;Fh=1;var r=/\w*$/;function t(s){var n=new s.constructor(s.source,r.exec(s));return n.lastIndex=s.lastIndex,n}return sl=t,sl}var nl,$h;function k_(){if($h)return nl;$h=1;var r=zt(),t=r?r.prototype:void 0,s=t?t.valueOf:void 0;function n(a){return s?Object(s.call(a)):{}}return nl=n,nl}var al,zh;function D_(){if(zh)return al;zh=1;var r=qc();function t(s,n){var a=n?r(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.length)}return al=t,al}var il,Uh;function P_(){if(Uh)return il;Uh=1;var r=qc(),t=R_(),s=A_(),n=k_(),a=D_(),i="[object Boolean]",o="[object Date]",l="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",h="[object String]",m="[object Symbol]",p="[object ArrayBuffer]",f="[object DataView]",v="[object Float32Array]",y="[object Float64Array]",j="[object Int8Array]",g="[object Int16Array]",_="[object Int32Array]",b="[object Uint8Array]",N="[object Uint8ClampedArray]",w="[object Uint16Array]",E="[object Uint32Array]";function S(C,D,R){var O=C.constructor;switch(D){case p:return r(C);case i:case o:return new O(+C);case f:return t(C,R);case v:case y:case j:case g:case _:case b:case N:case w:case E:return a(C,R);case l:return new O;case c:case h:return new O(C);case u:return s(C);case d:return new O;case m:return n(C)}}return il=S,il}var ol,Bh;function Iv(){if(Bh)return ol;Bh=1;var r=qr(),t=Object.create,s=function(){function n(){}return function(a){if(!r(a))return{};if(t)return t(a);n.prototype=a;var i=new n;return n.prototype=void 0,i}}();return ol=s,ol}var ll,Hh;function M_(){if(Hh)return ll;Hh=1;var r=Iv(),t=qn(),s=kc();function n(a){return typeof a.constructor=="function"&&!s(a)?r(t(a)):{}}return ll=n,ll}var cl,Wh;function O_(){if(Wh)return cl;Wh=1;var r=kn(),t=Gr(),s="[object Map]";function n(a){return t(a)&&r(a)==s}return cl=n,cl}var ul,Gh;function I_(){if(Gh)return ul;Gh=1;var r=O_(),t=An(),s=Rc(),n=s&&s.isMap,a=n?t(n):r;return ul=a,ul}var dl,Kh;function q_(){if(Kh)return dl;Kh=1;var r=kn(),t=Gr(),s="[object Set]";function n(a){return t(a)&&r(a)==s}return dl=n,dl}var ml,Yh;function L_(){if(Yh)return ml;Yh=1;var r=q_(),t=An(),s=Rc(),n=s&&s.isSet,a=n?t(n):r;return ml=a,ml}var hl,Vh;function F_(){if(Vh)return hl;Vh=1;var r=Nc(),t=Dv(),s=Pv(),n=w_(),a=__(),i=S_(),o=N_(),l=E_(),c=C_(),u=jv(),d=Ov(),h=kn(),m=T_(),p=P_(),f=M_(),v=tr(),y=Rn(),j=I_(),g=qr(),_=L_(),b=Ns(),N=In(),w=1,E=2,S=4,C="[object Arguments]",D="[object Array]",R="[object Boolean]",O="[object Date]",T="[object Error]",q="[object Function]",$="[object GeneratorFunction]",z="[object Map]",J="[object Number]",ne="[object Object]",le="[object RegExp]",M="[object Set]",F="[object String]",de="[object Symbol]",re="[object WeakMap]",Pe="[object ArrayBuffer]",he="[object DataView]",Me="[object Float32Array]",Ve="[object Float64Array]",Xe="[object Int8Array]",Lr="[object Int16Array]",jt="[object Int32Array]",Fr="[object Uint8Array]",wt="[object Uint8ClampedArray]",Yr="[object Uint16Array]",_t="[object Uint32Array]",oe={};oe[C]=oe[D]=oe[Pe]=oe[he]=oe[R]=oe[O]=oe[Me]=oe[Ve]=oe[Xe]=oe[Lr]=oe[jt]=oe[z]=oe[J]=oe[ne]=oe[le]=oe[M]=oe[F]=oe[de]=oe[Fr]=oe[wt]=oe[Yr]=oe[_t]=!0,oe[T]=oe[q]=oe[re]=!1;function ur(ae,sr,Ce,br,jr,nr){var Te,$r=sr&w,Vr=sr&E,Rs=sr&S;if(Ce&&(Te=jr?Ce(ae,br,jr,nr):Ce(ae)),Te!==void 0)return Te;if(!g(ae))return ae;var Ht=v(ae);if(Ht){if(Te=m(ae),!$r)return o(ae,Te)}else{var wr=h(ae),Hc=wr==q||wr==$;if(y(ae))return i(ae,$r);if(wr==ne||wr==C||Hc&&!jr){if(Te=Vr||Hc?{}:f(ae),!$r)return Vr?c(ae,a(Te,ae)):l(ae,n(Te,ae))}else{if(!oe[wr])return jr?ae:{};Te=p(ae,wr,$r)}}nr||(nr=new r);var Wc=nr.get(ae);if(Wc)return Wc;nr.set(ae,Te),_(ae)?ae.forEach(function(zr){Te.add(ur(zr,sr,Ce,zr,ae,nr))}):j(ae)&&ae.forEach(function(zr,Xr){Te.set(Xr,ur(zr,sr,Ce,Xr,ae,nr))});var sg=Rs?Vr?d:u:Vr?N:b,Gc=Ht?void 0:sg(ae);return t(Gc||ae,function(zr,Xr){Gc&&(Xr=zr,zr=ae[Xr]),s(Te,Xr,ur(zr,sr,Ce,Xr,ae,nr))}),Te}return hl=ur,hl}var pl,Xh;function $_(){if(Xh)return pl;Xh=1;function r(t){var s=t==null?0:t.length;return s?t[s-1]:void 0}return pl=r,pl}var fl,Qh;function z_(){if(Qh)return fl;Qh=1;var r=Pn(),t=Qf();function s(n,a){return a.length<2?n:r(n,t(a,0,-1))}return fl=s,fl}var vl,Jh;function U_(){if(Jh)return vl;Jh=1;var r=Dn(),t=$_(),s=z_(),n=Es();function a(i,o){return o=r(o,i),i=s(i,o),i==null||delete i[n(t(o))]}return vl=a,vl}var gl,Zh;function B_(){if(Zh)return gl;Zh=1;var r=Ut(),t=qn(),s=Gr(),n="[object Object]",a=Function.prototype,i=Object.prototype,o=a.toString,l=i.hasOwnProperty,c=o.call(Object);function u(d){if(!s(d)||r(d)!=n)return!1;var h=t(d);if(h===null)return!0;var m=l.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&o.call(m)==c}return gl=u,gl}var xl,ep;function H_(){if(ep)return xl;ep=1;var r=B_();function t(s){return r(s)?void 0:s}return xl=t,xl}var yl,rp;function W_(){if(rp)return yl;rp=1;var r=Ev();function t(s){var n=s==null?0:s.length;return n?r(s,1):[]}return yl=t,yl}var bl,tp;function G_(){if(tp)return bl;tp=1;var r=W_(),t=Cv(),s=Rv();function n(a){return s(t(a,void 0,r),a+"")}return bl=n,bl}var jl,sp;function K_(){if(sp)return jl;sp=1;var r=Mc(),t=F_(),s=U_(),n=Dn(),a=Cs(),i=H_(),o=G_(),l=Ov(),c=1,u=2,d=4,h=o(function(m,p){var f={};if(m==null)return f;var v=!1;p=r(p,function(j){return j=n(j,m),v||(v=j.length>1),j}),a(m,l(m),f),v&&(f=t(f,c|u|d,i));for(var y=p.length;y--;)s(f,p[y]);return f});return jl=h,jl}var Y_=K_();const V_=vr(Y_);var wl,np;function X_(){if(np)return wl;np=1;var r=Dv(),t=Iv(),s=Oc(),n=On(),a=qn(),i=tr(),o=Rn(),l=lc(),c=qr(),u=Ac();function d(h,m,p){var f=i(h),v=f||o(h)||u(h);if(m=n(m,4),p==null){var y=h&&h.constructor;v?p=f?new y:[]:c(h)?p=l(y)?t(a(h)):{}:p={}}return(v?r:s)(h,function(j,g,_){return m(p,j,g,_)}),p}return wl=d,wl}var Q_=X_();const J_=vr(Q_);var $s={exports:{}},Z_=$s.exports,ap;function eS(){return ap||(ap=1,function(r,t){(function(s,n){r.exports=n()})(Z_,function(){return function(s,n,a){n.prototype.isBetween=function(i,o,l,c){var u=a(i),d=a(o),h=(c=c||"()")[0]==="(",m=c[1]===")";return(h?this.isAfter(u,l):!this.isBefore(u,l))&&(m?this.isBefore(d,l):!this.isAfter(d,l))||(h?this.isBefore(u,l):!this.isAfter(u,l))&&(m?this.isAfter(d,l):!this.isBefore(d,l))}}})}($s)),$s.exports}eS();var zs={exports:{}},rS=zs.exports,ip;function tS(){return ip||(ip=1,function(r,t){(function(s,n){r.exports=n()})(rS,function(){return function(s,n){n.prototype.isSameOrAfter=function(a,i){return this.isSame(a,i)||this.isAfter(a,i)}}})}(zs)),zs.exports}tS();var Us={exports:{}},sS=Us.exports,op;function nS(){return op||(op=1,function(r,t){(function(s,n){r.exports=n()})(sS,function(){return function(s,n){n.prototype.isSameOrBefore=function(a,i){return this.isSame(a,i)||this.isBefore(a,i)}}})}(Us)),Us.exports}nS();var Bs={exports:{}},aS=Bs.exports,lp;function iS(){return lp||(lp=1,function(r,t){(function(s,n){r.exports=n()})(aS,function(){return function(s,n,a){var i=n.prototype,o=function(h){return h&&(h.indexOf?h:h.s)},l=function(h,m,p,f,v){var y=h.name?h:h.$locale(),j=o(y[m]),g=o(y[p]),_=j||g.map(function(N){return N.slice(0,f)});if(!v)return _;var b=y.weekStart;return _.map(function(N,w){return _[(w+(b||0))%7]})},c=function(){return a.Ls[a.locale()]},u=function(h,m){return h.formats[m]||function(p){return p.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(f,v,y){return v||y.slice(1)})}(h.formats[m.toUpperCase()])},d=function(){var h=this;return{months:function(m){return m?m.format("MMMM"):l(h,"months")},monthsShort:function(m){return m?m.format("MMM"):l(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(m){return m?m.format("dddd"):l(h,"weekdays")},weekdaysMin:function(m){return m?m.format("dd"):l(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(m){return m?m.format("ddd"):l(h,"weekdaysShort","weekdays",3)},longDateFormat:function(m){return u(h.$locale(),m)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return d.bind(this)()},a.localeData=function(){var h=c();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(m){return u(h,m)},meridiem:h.meridiem,ordinal:h.ordinal}},a.months=function(){return l(c(),"months")},a.monthsShort=function(){return l(c(),"monthsShort","months",3)},a.weekdays=function(h){return l(c(),"weekdays",null,null,h)},a.weekdaysShort=function(h){return l(c(),"weekdaysShort","weekdays",3,h)},a.weekdaysMin=function(h){return l(c(),"weekdaysMin","weekdays",2,h)}}})}(Bs)),Bs.exports}iS();var Hs={exports:{}},oS=Hs.exports,cp;function lS(){return cp||(cp=1,function(r,t){(function(s,n){r.exports=n()})(oS,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,i){var o=a.prototype,l=o.format;i.en.formats=s,o.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,d=function(h,m){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(p,f,v){var y=v&&v.toUpperCase();return f||m[v]||s[v]||m[y].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(j,g,_){return g||_.slice(1)})})}(c,u===void 0?{}:u);return l.call(this,d)}}})}(Hs)),Hs.exports}lS();var Ws={exports:{}},cS=Ws.exports,up;function uS(){return up||(up=1,function(r,t){(function(s,n){r.exports=n()})(cS,function(){return function(s,n,a){var i=function(o,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var c;l.length===1&&l[0].length>0&&(l=l[0]),c=(l=l.filter(function(d){return d}))[0];for(var u=1;u<l.length;u+=1)l[u].isValid()&&!l[u][o](c)||(c=l[u]);return c};a.max=function(){var o=[].slice.call(arguments,0);return i("isAfter",o)},a.min=function(){var o=[].slice.call(arguments,0);return i("isBefore",o)}}})}(Ws)),Ws.exports}uS();var Gs={exports:{}},dS=Gs.exports,dp;function mS(){return dp||(dp=1,function(r,t){(function(s,n){r.exports=n()})(dS,function(){var s="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,o,l){var c=o.prototype;l.utc=function(v){var y={date:v,utc:!0,args:arguments};return new o(y)},c.utc=function(v){var y=l(this.toDate(),{locale:this.$L,utc:!0});return v?y.add(this.utcOffset(),s):y},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var u=c.parse;c.parse=function(v){v.utc&&(this.$u=!0),this.$utils().u(v.$offset)||(this.$offset=v.$offset),u.call(this,v)};var d=c.init;c.init=function(){if(this.$u){var v=this.$d;this.$y=v.getUTCFullYear(),this.$M=v.getUTCMonth(),this.$D=v.getUTCDate(),this.$W=v.getUTCDay(),this.$H=v.getUTCHours(),this.$m=v.getUTCMinutes(),this.$s=v.getUTCSeconds(),this.$ms=v.getUTCMilliseconds()}else d.call(this)};var h=c.utcOffset;c.utcOffset=function(v,y){var j=this.$utils().u;if(j(v))return this.$u?0:j(this.$offset)?h.call(this):this.$offset;if(typeof v=="string"&&(v=function(N){N===void 0&&(N="");var w=N.match(n);if(!w)return null;var E=(""+w[0]).match(a)||["-",0,0],S=E[0],C=60*+E[1]+ +E[2];return C===0?0:S==="+"?C:-C}(v),v===null))return this;var g=Math.abs(v)<=16?60*v:v,_=this;if(y)return _.$offset=g,_.$u=v===0,_;if(v!==0){var b=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(_=this.local().add(g+b,s)).$offset=g,_.$x.$localOffset=b}else _=this.utc();return _};var m=c.format;c.format=function(v){var y=v||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return m.call(this,y)},c.valueOf=function(){var v=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*v},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var p=c.toDate;c.toDate=function(v){return v==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var f=c.diff;c.diff=function(v,y,j){if(v&&this.$u===v.$u)return f.call(this,v,y,j);var g=this.local(),_=l(v).local();return f.call(g,_,y,j)}}})}(Gs)),Gs.exports}mS();var Ks={exports:{}},hS=Ks.exports,mp;function pS(){return mp||(mp=1,function(r,t){(function(s,n){r.exports=n()})(hS,function(){return function(s,n){n.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})}(Ks)),Ks.exports}pS();function dr(r){return r.children}var Fe={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},Oe={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},hp=Object.keys(Oe).map(function(r){return Oe[r]});L.oneOfType([L.string,L.func]);L.any;L.func;L.oneOfType([L.arrayOf(L.oneOf(hp)),L.objectOf(function(r,t){var s=hp.indexOf(t)!==-1&&typeof r[t]=="boolean";if(s)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];return L.elementType.apply(L,[r,t].concat(a))})]);L.oneOfType([L.oneOf(["overlap","no-overlap"]),L.func]);var pp={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function qv(r,t){var s=Re(r,"month");return Re(s,"week",t.startOfWeek())}function Lv(r,t){var s=on(r,"month");return on(s,"week",t.startOfWeek())}function fS(r,t){for(var s=qv(r,t),n=Lv(r,t),a=[];Ft(s,n,"day");)a.push(s),s=lr(s,1,"day");return a}function vS(r,t){var s=Re(r,t);return Lt(s,r)?s:lr(s,1,t)}function gS(r,t){for(var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=r,a=[];Ft(n,t,s);)a.push(n),n=lr(n,1,s);return a}function xS(r,t){return t==null&&r==null?null:(t==null&&(t=new Date),r==null&&(r=new Date),r=Re(r,"day"),r=ds(r,ds(t)),r=At(r,At(t)),r=us(r,us(t)),cs(r,cs(t)))}function fp(r){return ds(r)===0&&At(r)===0&&us(r)===0&&cs(r)===0}function yS(r,t,s,n){return s==="day"&&(s="date"),Math.abs(lu[s](r,void 0,n)-lu[s](t,void 0,n))}function Lc(r,t,s){return!s||s==="milliseconds"?Math.abs(+r-+t):Math.round(Math.abs(+Re(r,s)/pp[s]-+Re(t,s)/pp[s]))}var bS=L.oneOfType([L.string,L.func]);function jS(r,t,s,n,a){var i=typeof n=="function"?n(s,a,r):t.call(r,s,n,a);return rs(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function wS(r,t,s){return new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,t+s,0,0)}function Fc(r,t){return r.getTimezoneOffset()-t.getTimezoneOffset()}function _S(r,t){return Lc(r,t,"minutes")+Fc(r,t)}function SS(r){var t=Re(r,"day");return Lc(t,r,"minutes")+Fc(t,r)}function NS(r,t){return oc(r,t,"day")}function ES(r,t,s){var n=Lt(r,t,"minutes");return n?xs(t,s,"minutes"):wn(t,s,"minutes")}function Gl(r,t){return yS(r,t,"day")}function CS(r){var t=r.evtA,s=t.start,n=t.end,a=t.allDay,i=r.evtB,o=i.start,l=i.end,c=i.allDay,u=+Re(s,"day")-+Re(o,"day"),d=Gl(s,n),h=Gl(o,l);return u||h-d||!!c-!!a||+s-+o||+n-+l}function TS(r){var t=r.event,s=t.start,n=t.end,a=r.range,i=a.start,o=a.end,l=Re(s,"day"),c=Ft(l,o,"day"),u=ic(l,n,"minutes"),d=u?wn(n,i,"minutes"):xs(n,i,"minutes");return c&&d}function RS(r,t){return Lt(r,t,"day")}function AS(r,t){return fp(r)&&fp(t)}var kS=Ne(function r(t){var s=this;Se(this,r),rs(typeof t.format=="function","date localizer `format(..)` must be a function"),rs(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||bS,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return jS.apply(void 0,[s,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||xS,this.inRange=t.inRange||Gf,this.lt=t.lt||oc,this.lte=t.lte||Ft,this.gt=t.gt||wn,this.gte=t.gte||xs,this.eq=t.eq||Lt,this.neq=t.neq||ic,this.startOf=t.startOf||Re,this.endOf=t.endOf||on,this.add=t.add||lr,this.range=t.range||gS,this.diff=t.diff||Lc,this.ceil=t.ceil||vS,this.min=t.min||Hf,this.max=t.max||Wf,this.minutes=t.minutes||At,this.daySpan=t.daySpan||Gl,this.firstVisibleDay=t.firstVisibleDay||qv,this.lastVisibleDay=t.lastVisibleDay||Lv,this.visibleDays=t.visibleDays||fS,this.getSlotDate=t.getSlotDate||wS,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||Fc,this.getTotalMin=t.getTotalMin||_S,this.getMinutesFromMidnight=t.getMinutesFromMidnight||SS,this.continuesPrior=t.continuesPrior||NS,this.continuesAfter=t.continuesAfter||ES,this.sortEvents=t.sortEvents||CS,this.inEventRange=t.inEventRange||TS,this.isSameDate=t.isSameDate||RS,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||AS,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function DS(r,t,s,n){var a=ue(ue({},r.formats),s);return ue(ue({},r),{},{messages:n,startOfWeek:function(){return r.startOfWeek(t)},format:function(o,l){return r.format(o,a[l]||l,t)}})}var PS=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.navigate=function(o){s.props.onNavigate(o)},s.view=function(o){s.props.onView(o)},s}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,i=n.label;return A.createElement("div",{className:"rbc-toolbar"},A.createElement("span",{className:"rbc-btn-group"},A.createElement("button",{type:"button",onClick:this.navigate.bind(null,Fe.TODAY)},a.today),A.createElement("button",{type:"button",onClick:this.navigate.bind(null,Fe.PREVIOUS)},a.previous),A.createElement("button",{type:"button",onClick:this.navigate.bind(null,Fe.NEXT)},a.next)),A.createElement("span",{className:"rbc-toolbar-label"},i),A.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,i=this.props.views,o=this.props.view;if(i.length>1)return i.map(function(l){return A.createElement("button",{type:"button",key:l,className:be({"rbc-active":o===l}),onClick:a.view.bind(null,l)},n[l])})}}])}(A.Component);function ve(r,t){r&&r.apply(null,[].concat(t))}var MS={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function OS(r){return ue(ue({},MS),r)}function IS(r){var t=r.ref,s=r.callback;x.useEffect(function(){var n=function(i){t.current&&!t.current.contains(i.target)&&s()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,s])}var qS=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Fv=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.style,i=n.className,o=n.event,l=n.selected,c=n.isAllDay,u=n.onSelect,d=n.onDoubleClick,h=n.onKeyPress,m=n.localizer,p=n.continuesPrior,f=n.continuesAfter,v=n.accessors,y=n.getters,j=n.children,g=n.components,_=g.event,b=g.eventWrapper,N=n.slotStart,w=n.slotEnd,E=fr(n,qS);delete E.resizable;var S=v.title(o),C=v.tooltip(o),D=v.end(o),R=v.start(o),O=v.allDay(o),T=c||O||m.diff(R,m.ceil(D,"day"),"day")>1,q=y.eventProp(o,R,D,l),$=A.createElement("div",{className:"rbc-event-content",title:C||void 0},_?A.createElement(_,{event:o,continuesPrior:p,continuesAfter:f,title:S,isAllDay:O,localizer:m,slotStart:N,slotEnd:w}):S);return A.createElement(b,Object.assign({},this.props,{type:"date"}),A.createElement("div",Object.assign({},E,{style:ue(ue({},q.style),a),className:be("rbc-event",i,q.className,{"rbc-selected":l,"rbc-event-allday":T,"rbc-event-continues-prior":p,"rbc-event-continues-after":f}),onClick:function(J){return u&&u(o,J)},onDoubleClick:function(J){return d&&d(o,J)},onKeyDown:function(J){return h&&h(o,J)}}),typeof j=="function"?j($):$))}}])}(A.Component);function Ln(r,t){return!r||t==null?!1:_w(r,t)}function $v(r,t){var s=r.right-r.left,n=s/t;return n}function zv(r,t,s,n){var a=$v(r,n);return s?n-1-Math.floor((t-r.left)/a):Math.floor((t-r.left)/a)}function LS(r,t){var s=t.x,n=t.y;return n>=r.top&&n<=r.bottom&&s>=r.left&&s<=r.right}function FS(r,t,s,n,a){var i=-1,o=-1,l=n-1,c=$v(t,n),u=zv(t,s.x,a,n),d=t.top<s.y&&t.bottom>s.y,h=t.top<r.y&&t.bottom>r.y,m=r.y>t.bottom,p=t.top>r.y,f=s.top<t.top&&s.bottom>t.bottom;return f&&(i=0,o=l),d&&(p?(i=0,o=u):m&&(i=u,o=l)),h&&(i=o=a?l-Math.floor((r.x-t.left)/c):Math.floor((r.x-t.left)/c),d?u<i?i=u:o=u:r.y<s.y?o=l:i=0),{startIdx:i,endIdx:o}}function $S(r){var t=r.target,s=r.offset,n=r.container,a=r.box,i=at(t),o=i.top,l=i.left,c=i.width,u=i.height,d=at(n),h=d.top,m=d.left,p=d.width,f=d.height,v=at(a),y=v.width,j=v.height,g=h+f,_=m+p,b=o+j,N=l+y,w=s.x,E=s.y,S=b>g?o-j-E:o+E+u,C=N>_?l+w-y+c:l+w;return{topOffset:S,leftOffset:C}}function zS(r){var t=r.containerRef,s=r.accessors,n=r.getters,a=r.selected,i=r.components,o=r.localizer,l=r.position,c=r.show,u=r.events,d=r.slotStart,h=r.slotEnd,m=r.onSelect,p=r.onDoubleClick,f=r.onKeyPress,v=r.handleDragStart,y=r.popperRef,j=r.target,g=r.offset;IS({ref:y,callback:c}),x.useLayoutEffect(function(){var N=$S({target:j,offset:g,container:t.current,box:y.current}),w=N.topOffset,E=N.leftOffset;y.current.style.top="".concat(w,"px"),y.current.style.left="".concat(E,"px")},[g.x,g.y,j]);var _=l.width,b={minWidth:_+_/2};return A.createElement("div",{style:b,className:"rbc-overlay",ref:y},A.createElement("div",{className:"rbc-overlay-header"},o.format(d,"dayHeaderFormat")),u.map(function(N,w){return A.createElement(Fv,{key:w,type:"popup",localizer:o,event:N,getters:n,onSelect:m,accessors:s,components:i,onDoubleClick:p,onKeyPress:f,continuesPrior:o.lt(s.end(N),d,"day"),continuesAfter:o.gte(s.start(N),h,"day"),slotStart:d,slotEnd:h,selected:Ln(N,a),draggable:!0,onDragStart:function(){return v(N)},onDragEnd:function(){return c()}})}))}var Uv=A.forwardRef(function(r,t){return A.createElement(zS,Object.assign({},r,{popperRef:t}))});Uv.propTypes={accessors:L.object.isRequired,getters:L.object.isRequired,selected:L.object,components:L.object.isRequired,localizer:L.object.isRequired,position:L.object.isRequired,show:L.func.isRequired,events:L.array.isRequired,slotStart:L.instanceOf(Date).isRequired,slotEnd:L.instanceOf(Date),onSelect:L.func,onDoubleClick:L.func,onKeyPress:L.func,handleDragStart:L.func,style:L.object,offset:L.shape({x:L.number,y:L.number})};function US(r){var t=r.containerRef,s=r.popupOffset,n=s===void 0?5:s,a=r.overlay,i=r.accessors,o=r.localizer,l=r.components,c=r.getters,u=r.selected,d=r.handleSelectEvent,h=r.handleDoubleClickEvent,m=r.handleKeyPressEvent,p=r.handleDragStart,f=r.onHide,v=r.overlayDisplay,y=x.useRef(null);if(!a.position)return null;var j=n;isNaN(n)||(j={x:n,y:n});var g=a.position,_=a.events,b=a.date,N=a.end;return A.createElement(wc,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:f,target:a.target},function(w){var E=w.props;return A.createElement(Uv,Object.assign({},E,{containerRef:t,ref:y,target:a.target,offset:j,accessors:i,getters:c,selected:u,components:l,localizer:o,position:g,show:v,events:_,slotStart:b,slotEnd:N,onSelect:d,onDoubleClick:h,onKeyPress:m,handleDragStart:p}))})}var $c=A.forwardRef(function(r,t){return A.createElement(US,Object.assign({},r,{containerRef:t}))});$c.propTypes={popupOffset:L.oneOfType([L.number,L.shape({x:L.number,y:L.number})]),overlay:L.shape({position:L.object,events:L.array,date:L.instanceOf(Date),end:L.instanceOf(Date)}),accessors:L.object.isRequired,localizer:L.object.isRequired,components:L.object.isRequired,getters:L.object.isRequired,selected:L.object,handleSelectEvent:L.func,handleDoubleClickEvent:L.func,handleKeyPressEvent:L.func,handleDragStart:L.func,onHide:L.func,overlayDisplay:L.func};function Ae(r,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Yt(s,r,t,{passive:!1})}function BS(r,t,s){return!r||ms(r,document.elementFromPoint(t,s))}function HS(r,t){var s=t.clientX,n=t.clientY,a=document.elementFromPoint(s,n);return wv(a,".rbc-event",r)}function WS(r,t){var s=t.clientX,n=t.clientY,a=document.elementFromPoint(s,n);return wv(a,".rbc-show-more",r)}function un(r,t){return!!HS(r,t)}function GS(r,t){return!!WS(r,t)}function Gt(r){var t=r;return r.touches&&r.touches.length&&(t=r.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var vp=5,KS=250,Bv=function(){function r(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=s.global,a=n===void 0?!1:n,i=s.longPressThreshold,o=i===void 0?250:i,l=s.validContainers,c=l===void 0?[]:l;Se(this,r),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=o,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Ae("touchmove",function(){},window),this._removeKeyDownListener=Ae("keydown",this._keyListener),this._removeKeyUpListener=Ae("keyup",this._keyListener),this._removeDropFromOutsideListener=Ae("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Ae("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Ne(r,[{key:"on",value:function(s,n){var a=this._listeners[s]||(this._listeners[s]=[]);return a.push(n),{remove:function(){var o=a.indexOf(n);o!==-1&&a.splice(o,1)}}}},{key:"emit",value:function(s){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o,l=this._listeners[s]||[];return l.forEach(function(c){o===void 0&&(o=c.apply(void 0,a))}),o}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(s){var n=this._selectRect;return!n||!this.selecting?!1:gp(n,gt(s))}},{key:"filter",value:function(s){var n=this._selectRect;return!n||!this.selecting?[]:s.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(s,n){var a=this,i=null,o=null,l=null,c=function(m){i=setTimeout(function(){d(),s(m)},a.longPressThreshold),o=Ae("touchmove",function(){return d()}),l=Ae("touchend",function(){return d()})},u=Ae("touchstart",c),d=function(){i&&clearTimeout(i),o&&o(),l&&l(),i=null,o=null,l=null};return n&&c(n),function(){d(),u()}}},{key:"_addInitialEventListener",value:function(){var s=this,n=Ae("mousedown",function(i){s._removeInitialEventListener(),s._handleInitialEvent(i),s._removeInitialEventListener=Ae("mousedown",s._handleInitialEvent)}),a=Ae("touchstart",function(i){s._removeInitialEventListener(),s._removeInitialEventListener=s._addLongPressListener(s._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(s){var n=Gt(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:a,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(s){var n=Gt(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:a,y:i,clientX:o,clientY:l}),s.preventDefault()}},{key:"_handleInitialEvent",value:function(s){if(this._initialEvent=s,!this.isDetached){var n=Gt(s),a=n.clientX,i=n.clientY,o=n.pageX,l=n.pageY,c=this.container(),u,d;if(!(s.which===3||s.button===2||!BS(c,a,i))){if(!this.globalMouse&&c&&!ms(c,s.target)){var h=YS(0),m=h.top,p=h.left,f=h.bottom,v=h.right;if(d=gt(c),u=gp({top:d.top-m,left:d.left-p,bottom:d.bottom+f,right:d.right+v},{top:l,left:o}),!u)return}var y=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(s.type),x:o,y:l,clientX:a,clientY:i});if(y!==!1)switch(s.type){case"mousedown":this._removeEndListener=Ae("mouseup",this._handleTerminatingEvent),this._onEscListener=Ae("keydown",this._handleTerminatingEvent),this._removeMoveListener=Ae("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(s),this._removeEndListener=Ae("touchend",this._handleTerminatingEvent),this._removeMoveListener=Ae("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(s){var n=s.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(s){var n=this.selecting,a=this._selectRect;if(!n&&s.type.includes("key")&&(s=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!s){var i=!this.container||ms(this.container(),s.target),o=this._isWithinValidContainer(s);return s.key==="Escape"||!o?this.emit("reset"):!n&&i?this._handleClickEvent(s):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(s){var n=Gt(s),a=n.pageX,i=n.pageY,o=n.clientX,l=n.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<KS?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:i,clientX:o,clientY:l})):(this._lastClickData={timestamp:c},this.emit("click",{x:a,y:i,clientX:o,clientY:l}))}},{key:"_handleMoveEvent",value:function(s){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,i=n.y,o=Gt(s),l=o.pageX,c=o.pageY,u=Math.abs(a-l),d=Math.abs(i-c),h=Math.min(l,a),m=Math.min(c,i),p=this.selecting,f=this.isClick(l,c);f&&!p&&!(u||d)||(!p&&!f&&this.emit("selectStart",this._initialEventData),f||(this.selecting=!0,this._selectRect={top:m,left:h,x:l,y:c,right:h+u,bottom:m+d},this.emit("selecting",this._selectRect)),s.preventDefault())}}},{key:"_keyListener",value:function(s){this.ctrl=s.metaKey||s.ctrlKey}},{key:"isClick",value:function(s,n){var a=this._initialEventData,i=a.x,o=a.y,l=a.isTouch;return!l&&Math.abs(s-i)<=vp&&Math.abs(n-o)<=vp}}])}();function YS(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return lt(r)!=="object"&&(r={top:r,left:r,right:r,bottom:r}),r}function gp(r,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=gt(r),a=n.top,i=n.left,o=n.right,l=o===void 0?i:o,c=n.bottom,u=c===void 0?a:c,d=gt(t),h=d.top,m=d.left,p=d.right,f=p===void 0?m:p,v=d.bottom,y=v===void 0?h:v;return!(u-s<h||a+s>y||l-s<m||i+s>f)}function gt(r){if(!r.getBoundingClientRect)return r;var t=r.getBoundingClientRect(),s=t.left+xp("left"),n=t.top+xp("top");return{top:n,left:s,right:(r.offsetWidth||0)+s,bottom:(r.offsetHeight||0)+n}}function xp(r){if(r==="left")return window.pageXOffset||document.body.scrollLeft||0;if(r==="top")return window.pageYOffset||document.body.scrollTop||0}var VS=function(r){function t(s,n){var a;return Se(this,t),a=ke(this,t,[s,n]),a.state={selecting:!1},a.containerRef=x.createRef(),a}return De(t,r),Ne(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,i=n.getNow,o=n.getters,l=n.date,c=n.components.dateCellWrapper,u=n.localizer,d=this.state,h=d.selecting,m=d.startIdx,p=d.endIdx,f=i();return A.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(v,y){var j=h&&y>=m&&y<=p,g=o.dayProp(v),_=g.className,b=g.style;return A.createElement(c,{key:y,value:v,range:a},A.createElement("div",{style:b,className:be("rbc-day-bg",_,j&&"rbc-selected-cell",u.isSameDate(v,f)&&"rbc-today",l&&u.neq(l,v,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,i=this._selector=new Bv(this.props.container,{longPressThreshold:this.props.longPressThreshold}),o=function(c,u){if(!un(a,c)&&!GS(a,c)){var d=gt(a),h=n.props,m=h.range,p=h.rtl;if(LS(d,c)){var f=zv(d,c.x,p,m.length);n._selectSlot({startIdx:f,endIdx:f,action:u,box:c})}}n._initial={},n.setState({selecting:!1})};i.on("selecting",function(l){var c=n.props,u=c.range,d=c.rtl,h=-1,m=-1;if(n.state.selecting||(ve(n.props.onSelectStart,[l]),n._initial={x:l.x,y:l.y}),i.isSelected(a)){var p=gt(a),f=FS(n._initial,p,l,u.length,d);h=f.startIdx,m=f.endIdx}n.setState({selecting:!0,startIdx:h,endIdx:m})}),i.on("beforeSelect",function(l){if(n.props.selectable==="ignoreEvents")return!un(n.containerRef.current,l)}),i.on("click",function(l){return o(l,"click")}),i.on("doubleClick",function(l){return o(l,"doubleClick")}),i.on("select",function(l){n._selectSlot(ue(ue({},n.state),{},{action:"select",bounds:l})),n._initial={},n.setState({selecting:!1}),ve(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,i=n.startIdx,o=n.action,l=n.bounds,c=n.box;a!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:a,action:o,bounds:l,box:c,resourceId:this.props.resourceId})}}])}(A.Component),Qe={propTypes:{slotMetrics:L.object.isRequired,selected:L.object,isAllDay:L.bool,accessors:L.object.isRequired,localizer:L.object.isRequired,components:L.object.isRequired,getters:L.object.isRequired,onSelect:L.func,onDoubleClick:L.func,onKeyPress:L.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,s){var n=t.selected;t.isAllDay;var a=t.accessors,i=t.getters,o=t.onSelect,l=t.onDoubleClick,c=t.onKeyPress,u=t.localizer,d=t.slotMetrics,h=t.components,m=t.resizable,p=d.continuesPrior(s),f=d.continuesAfter(s);return A.createElement(Fv,{event:s,getters:i,localizer:u,accessors:a,components:h,onSelect:o,onDoubleClick:l,onKeyPress:c,continuesPrior:p,continuesAfter:f,slotStart:d.first,slotEnd:d.last,selected:Ln(s,n),resizable:m})},renderSpan:function(t,s,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(s)/t*100+"%";return A.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},a)}},Hv=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.segments,o=a.slotMetrics.slots,l=a.className,c=1;return A.createElement("div",{className:be(l,"rbc-row")},i.reduce(function(u,d,h){var m=d.event,p=d.left,f=d.right,v=d.span,y="_lvl_"+h,j=p-c,g=Qe.renderEvent(n.props,m);return j&&u.push(Qe.renderSpan(o,j,"".concat(y,"_gap"))),u.push(Qe.renderSpan(o,v,y,g)),c=f+1,u},[]))}}])}(A.Component);Hv.defaultProps=ue({},Qe.defaultProps);function Wv(r){var t=r.dateRange,s=r.unit,n=s===void 0?"day":s,a=r.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function XS(r,t,s,n){var a=Wv({dateRange:t,localizer:n}),i=a.first,o=a.last,l=n.diff(i,o,"day"),c=n.max(n.startOf(s.start(r),"day"),i),u=n.min(n.ceil(s.end(r),"day"),o),d=Bw(t,function(m){return n.isSameDate(m,c)}),h=n.diff(c,u,"day");return h=Math.min(h,l),h=Math.max(h-n.segmentOffset,1),{event:r,span:h,left:d+1,right:Math.max(d+h,1)}}function Kl(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s,n,a,i=[],o=[];for(s=0;s<r.length;s++){for(a=r[s],n=0;n<i.length&&QS(a,i[n]);n++);n>=t?o.push(a):(i[n]||(i[n]=[])).push(a)}for(s=0;s<i.length;s++)i[s].sort(function(l,c){return l.left-c.left});return{levels:i,extra:o}}function fs(r,t,s,n,a){var i={start:n.start(r),end:n.end(r)},o={start:t,end:s};return a.inEventRange({event:i,range:o})}function QS(r,t){return t.some(function(s){return s.left<=r.right&&s.right>=r.left})}function JS(r,t,s){var n=Ls(r),a=[],i=[];n.forEach(function(c){var u=t.start(c),d=t.end(c);s.daySpan(u,d)>1?a.push(c):i.push(c)});var o=a.sort(function(c,u){return Yl(c,u,t,s)}),l=i.sort(function(c,u){return Yl(c,u,t,s)});return[].concat(Ls(o),Ls(l))}function Yl(r,t,s,n){var a={start:s.start(r),end:s.end(r),allDay:s.allDay(r)},i={start:s.start(t),end:s.end(t),allDay:s.allDay(t)};return n.sortEvents({evtA:a,evtB:i})}var Vl=function(t,s){return t.left<=s&&t.right>=s},_l=function(t,s){return t.filter(function(n){return Vl(n,s)}).map(function(n){return n.event})},Gv=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,i=n.slotMetrics.slots,o=Kl(a).levels[0],l=1,c=1,u=[];l<=i;){var d="_lvl_"+l,h=o.filter(function(b){return Vl(b,l)})[0]||{},m=h.event,p=h.left,f=h.right,v=h.span;if(!m){var y=this.getHiddenEventsForSlot(a,l);if(y.length>0){var j=l-c;j&&u.push(Qe.renderSpan(i,j,d+"_gap")),u.push(Qe.renderSpan(i,1,d,this.renderShowMore(a,l))),c=l=l+1;continue}l++;continue}var g=Math.max(0,p-c);if(this.canRenderSlotEvent(p,v)){var _=Qe.renderEvent(this.props,m);g&&u.push(Qe.renderSpan(i,g,d+"_gap")),u.push(Qe.renderSpan(i,v,d,_)),c=l=f+1}else g&&u.push(Qe.renderSpan(i,g,d+"_gap")),u.push(Qe.renderSpan(i,1,d,this.renderShowMore(a,l))),c=l=l+1}return A.createElement("div",{className:"rbc-row"},u)}},{key:"getHiddenEventsForSlot",value:function(n,a){var i=_l(n,a),o=Kl(n).levels[0],l=o.filter(function(c){return Vl(c,a)}).map(function(c){return c.event});return i.filter(function(c){return!l.some(function(u){return u===c})})}},{key:"canRenderSlotEvent",value:function(n,a){var i=this.props.segments;return Yw(n,n+a).every(function(o){var l=_l(i,o).length;return l===1})}},{key:"renderShowMore",value:function(n,a){var i=this,o=this.props,l=o.localizer,c=o.slotMetrics,u=o.components,d=c.getEventsForSlot(a),h=_l(n,a),m=h.length;if(u!=null&&u.showMore){var p=u.showMore,f=c.getDateForSlot(a-1);return m?A.createElement(p,{localizer:l,slotDate:f,slot:a,count:m,events:d,remainingEvents:h}):!1}return m?A.createElement("button",{type:"button",key:"sm_"+a,className:be("rbc-button-link","rbc-show-more"),onClick:function(y){return i.showMore(a,y)}},l.messages.showMore(m,h,d)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(A.Component);Gv.defaultProps=ue({},Qe.defaultProps);var ZS=function(t){var s=t.children;return A.createElement("div",{className:"rbc-row-content-scroll-container"},s)},eN=function(t,s){return t.left<=s&&t.right>=s},rN=function(t,s){return t[0].range===s[0].range&&t[0].events===s[0].events};function Kv(){return Nv(function(r){for(var t=r.range,s=r.events,n=r.maxRows,a=r.minRows,i=r.accessors,o=r.localizer,l=Wv({dateRange:t,localizer:o}),c=l.first,u=l.last,d=s.map(function(v){return XS(v,t,i,o)}),h=Kl(d,Math.max(n-1,1)),m=h.levels,p=h.extra,f=p.length>0?a-1:a;m.length<f;)m.push([]);return{first:c,last:u,levels:m,extra:p,range:t,slots:t.length,clone:function(y){var j=Kv();return j(ue(ue({},r),y))},getDateForSlot:function(y){return t[y]},getSlotForDate:function(y){return t.find(function(j){return o.isSameDate(j,y)})},getEventsForSlot:function(y){return d.filter(function(j){return eN(j,y)}).map(function(j){return j.event})},continuesPrior:function(y){return o.continuesPrior(i.start(y),c)},continuesAfter:function(y){var j=i.start(y),g=i.end(y);return o.continuesAfter(j,g,u)}}},rN)}var vs=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.handleSelectSlot=function(o){var l=s.props,c=l.range,u=l.onSelectSlot;u(c.slice(o.start,o.end+1),o)},s.handleShowMore=function(o,l){var c=s.props,u=c.range,d=c.onShowMore,h=s.slotMetrics(s.props),m=Zb(s.containerRef.current,".rbc-row-bg")[0],p;m&&(p=m.children[o-1]);var f=h.getEventsForSlot(o);d(f,u[o-1],p,o,l)},s.getContainer=function(){var o=s.props.container;return o?o():s.containerRef.current},s.renderHeadingCell=function(o,l){var c=s.props,u=c.renderHeader,d=c.getNow,h=c.localizer;return u({date:o,key:"header_".concat(l),className:be("rbc-date-cell",h.isSameDate(o,d())&&"rbc-now")})},s.renderDummy=function(){var o=s.props,l=o.className,c=o.range,u=o.renderHeader,d=o.showAllEvents;return A.createElement("div",{className:l,ref:s.containerRef},A.createElement("div",{className:be("rbc-row-content",d&&"rbc-row-content-scrollable")},u&&A.createElement("div",{className:"rbc-row",ref:s.headingRowRef},c.map(s.renderHeadingCell)),A.createElement("div",{className:"rbc-row",ref:s.eventRowRef},A.createElement("div",{className:"rbc-row-segment"},A.createElement("div",{className:"rbc-event"},A.createElement("div",{className:"rbc-event-content"}," "))))))},s.containerRef=x.createRef(),s.headingRowRef=x.createRef(),s.eventRowRef=x.createRef(),s.slotMetrics=Kv(),s}return De(t,r),Ne(t,[{key:"getRowLimit",value:function(){var n,a=Li(this.eventRowRef.current),i=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?Li(this.headingRowRef.current):0,o=Li(this.containerRef.current)-i;return Math.max(Math.floor(o/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.rtl,o=n.range,l=n.className,c=n.selected,u=n.selectable,d=n.renderForMeasure,h=n.accessors,m=n.getters,p=n.components,f=n.getNow,v=n.renderHeader,y=n.onSelect,j=n.localizer,g=n.onSelectStart,_=n.onSelectEnd,b=n.onDoubleClick,N=n.onKeyPress,w=n.resourceId,E=n.longPressThreshold,S=n.isAllDay,C=n.resizable,D=n.showAllEvents;if(d)return this.renderDummy();var R=this.slotMetrics(this.props),O=R.levels,T=R.extra,q=D?ZS:dr,$=p.weekWrapper,z={selected:c,accessors:h,getters:m,localizer:j,components:p,onSelect:y,onDoubleClick:b,onKeyPress:N,resourceId:w,slotMetrics:R,resizable:C};return A.createElement("div",{className:l,role:"rowgroup",ref:this.containerRef},A.createElement(VS,{localizer:j,date:a,getNow:f,rtl:i,range:o,selectable:u,container:this.getContainer,getters:m,onSelectStart:g,onSelectEnd:_,onSelectSlot:this.handleSelectSlot,components:p,longPressThreshold:E,resourceId:w}),A.createElement("div",{className:be("rbc-row-content",D&&"rbc-row-content-scrollable"),role:"row"},v&&A.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},o.map(this.renderHeadingCell)),A.createElement(q,null,A.createElement($,Object.assign({isAllDay:S},z,{rtl:this.props.rtl}),O.map(function(J,ne){return A.createElement(Hv,Object.assign({key:ne,segments:J},z))}),!!T.length&&A.createElement(Gv,Object.assign({segments:T,onShowMore:this.handleShowMore},z))))))}}])}(A.Component);vs.defaultProps={minRows:0,maxRows:1/0};var zc=function(t){var s=t.label;return A.createElement("span",{role:"columnheader","aria-sort":"none"},s)},tN=function(t){var s=t.label,n=t.drilldownView,a=t.onDrillDown;return n?A.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},s):A.createElement("span",null,s)},sN=["date","className"],nN=function(t,s,n,a,i){return t.filter(function(o){return fs(o,s,n,a,i)})},Fn=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.getContainer=function(){return s.containerRef.current},s.renderWeek=function(o,l){var c=s.props,u=c.events,d=c.components,h=c.selectable,m=c.getNow,p=c.selected,f=c.date,v=c.localizer,y=c.longPressThreshold,j=c.accessors,g=c.getters,_=c.showAllEvents,b=s.state,N=b.needLimitMeasure,w=b.rowLimit,E=nN(Ls(u),o[0],o[o.length-1],j,v),S=JS(E,j,v);return A.createElement(vs,{key:l,ref:l===0?s.slotRowRef:void 0,container:s.getContainer,className:"rbc-month-row",getNow:m,date:f,range:o,events:S,maxRows:_?1/0:w,selected:p,selectable:h,components:d,accessors:j,getters:g,localizer:v,renderHeader:s.readerDateHeading,renderForMeasure:N,onShowMore:s.handleShowMore,onSelect:s.handleSelectEvent,onDoubleClick:s.handleDoubleClickEvent,onKeyPress:s.handleKeyPressEvent,onSelectSlot:s.handleSelectSlot,longPressThreshold:y,rtl:s.props.rtl,resizable:s.props.resizable,showAllEvents:_})},s.readerDateHeading=function(o){var l=o.date,c=o.className,u=fr(o,sN),d=s.props,h=d.date,m=d.getDrilldownView,p=d.localizer,f=p.neq(h,l,"month"),v=p.isSameDate(l,h),y=m(l),j=p.format(l,"dateFormat"),g=s.props.components.dateHeader||tN;return A.createElement("div",Object.assign({},u,{className:be(c,f&&"rbc-off-range",v&&"rbc-current"),role:"cell"}),A.createElement(g,{label:j,date:l,drilldownView:y,isOffRange:f,onDrillDown:function(b){return s.handleHeadingClick(l,y,b)}}))},s.handleSelectSlot=function(o,l){s._pendingSelection=s._pendingSelection.concat(o),clearTimeout(s._selectTimer),s._selectTimer=setTimeout(function(){return s.selectDates(l)})},s.handleHeadingClick=function(o,l,c){c.preventDefault(),s.clearSelection(),ve(s.props.onDrillDown,[o,l])},s.handleSelectEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){s.clearSelection();for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onKeyPressEvent,l)},s.handleShowMore=function(o,l,c,u,d){var h=s.props,m=h.popup,p=h.onDrillDown,f=h.onShowMore,v=h.getDrilldownView,y=h.doShowMoreDrillDown;if(s.clearSelection(),m){var j=nv(c,s.containerRef.current);s.setState({overlay:{date:l,events:o,position:j,target:d}})}else y&&ve(p,[l,v(l)||Oe.DAY]);ve(f,[o,l,u])},s.overlayDisplay=function(){s.setState({overlay:null})},s.state={rowLimit:5,needLimitMeasure:!0,date:null},s.containerRef=x.createRef(),s.slotRowRef=x.createRef(),s._bgRows=[],s._pendingSelection=[],s}return De(t,r),Ne(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||av(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.className,l=i.visibleDays(a,i),c=qb(l,7);return this._weekCount=c.length,A.createElement("div",{className:be("rbc-month-view",o),role:"table","aria-label":"Month View",ref:this.containerRef},A.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(c[0])),c.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,i=a.localizer,o=a.components,l=n[0],c=n[n.length-1],u=o.header||zc;return i.range(l,c,"day").map(function(d,h){return A.createElement("div",{key:"header_"+h,className:"rbc-header"},A.createElement(u,{date:d,localizer:i,label:i.format(d,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,i=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,u=l.localizer,d=l.components,h=l.getters,m=l.selected,p=l.popupOffset,f=l.handleDragStart,v=function(){return i.setState({overlay:null})};return A.createElement($c,{overlay:o,accessors:c,localizer:u,components:d,getters:h,selected:m,popupOffset:p,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:f,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:v})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(l,c){return+l-+c});var i=new Date(a[0]),o=new Date(a[a.length-1]);o.setDate(a[a.length-1].getDate()+1),ve(this.props.onSelectSlot,{slots:a,start:i,end:o,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var i=n.date,o=n.localizer;return{date:i,needLimitMeasure:o.neq(i,a.date,"month")}}}])}(A.Component);Fn.range=function(r,t){var s=t.localizer,n=s.firstVisibleDay(r,s),a=s.lastVisibleDay(r,s);return{start:n,end:a}};Fn.navigate=function(r,t,s){var n=s.localizer;switch(t){case Fe.PREVIOUS:return n.add(r,-1,"month");case Fe.NEXT:return n.add(r,1,"month");default:return r}};Fn.title=function(r,t){var s=t.localizer;return s.format(r,"monthHeaderFormat")};var yp=function(t){var s=t.min,n=t.max,a=t.step,i=t.slots,o=t.localizer;return"".concat(+o.startOf(s,"minutes"))+"".concat(+o.startOf(n,"minutes"))+"".concat(a,"-").concat(i)};function Uc(r){for(var t=r.min,s=r.max,n=r.step,a=r.timeslots,i=r.localizer,o=yp({step:n,localizer:i}),l=1+i.getTotalMin(t,s),c=i.getMinutesFromMidnight(t),u=Math.ceil((l-1)/(n*a)),d=u*a,h=new Array(u),m=new Array(d),p=0;p<u;p++){h[p]=new Array(a);for(var f=0;f<a;f++){var v=p*a+f,y=v*n;m[v]=h[p][f]=i.getSlotDate(t,c,y)}}var j=m.length*n;m.push(i.getSlotDate(t,c,j));function g(_){var b=i.diff(t,_,"minutes")+i.getDstOffset(t,_);return Math.min(b,l)}return{groups:h,update:function(b){return yp(b)!==o?Uc(b):this},dateIsInGroup:function(b,N){var w=h[N+1];return i.inRange(b,h[N][0],w?w[0]:s,"minutes")},nextSlot:function(b){var N=m[Math.min(m.findIndex(function(w){return w===b||i.eq(w,b)})+1,m.length-1)];return i.eq(N,b)&&(N=i.add(b,n,"minutes")),N},closestSlotToPosition:function(b){var N=Math.min(m.length-1,Math.max(0,Math.floor(b*d)));return m[N]},closestSlotFromPoint:function(b,N){var w=Math.abs(N.top-N.bottom);return this.closestSlotToPosition((b.y-N.top)/w)},closestSlotFromDate:function(b){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(b,t,"minutes"))return m[0];if(i.gt(b,s,"minutes"))return m[m.length-1];var w=i.diff(t,b,"minutes");return m[(w-w%n)/n+N]},startsBeforeDay:function(b){return i.lt(b,t,"day")},startsAfterDay:function(b){return i.gt(b,s,"day")},startsBefore:function(b){return i.lt(i.merge(t,b),t,"minutes")},startsAfter:function(b){return i.gt(i.merge(s,b),s,"minutes")},getRange:function(b,N,w,E){w||(b=i.min(s,i.max(t,b))),E||(N=i.min(s,i.max(t,N)));var S=g(b),C=g(N),D=C>n*d&&!i.eq(s,N)?(S-n)/(n*d)*100:S/(n*d)*100;return{top:D,height:C/(n*d)*100-D,start:g(b),startDate:b,end:g(N),endDate:N}},getCurrentTimePosition:function(b){var N=g(b),w=N/(n*d)*100;return w}}}var aN=function(){function r(t,s){var n=s.accessors,a=s.slotMetrics;Se(this,r);var i=a.getRange(n.start(t),n.end(t)),o=i.start,l=i.startDate,c=i.end,u=i.endDate,d=i.top,h=i.height;this.start=o,this.end=c,this.startMs=+l,this.endMs=+u,this.top=d,this.height=h,this.data=t}return Ne(r,[{key:"_width",get:function(){if(this.rows){var s=this.rows.reduce(function(a,i){return Math.max(a,i.leaves.length+1)},0)+1;return 100/s}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var s=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:s;var a=this.row.leaves,i=a.indexOf(this);return i===a.length-1?s:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var s=this.row,n=s.leaves,a=s.xOffset,i=s._width,o=n.indexOf(this)+1;return a+o*i}}])}();function iN(r,t,s){return Math.abs(t.start-r.start)<s||t.start>r.start&&t.start<r.end}function oN(r){for(var t=h_(r,["startMs",function(l){return-l.endMs}]),s=[];t.length>0;){var n=t.shift();s.push(n);for(var a=0;a<t.length;a++){var i=t[a];if(!(n.endMs>i.startMs)){if(a>0){var o=t.splice(a,1)[0];s.push(o)}break}}}return s}function Yv(r){for(var t=r.events,s=r.minimumStartDifference,n=r.slotMetrics,a=r.accessors,i=t.map(function(d){return new aN(d,{slotMetrics:n,accessors:a})}),o=oN(i),l=[],c=function(){var h=o[u],m=l.find(function(v){return v.end>h.start||Math.abs(h.start-v.start)<s});if(!m)return h.rows=[],l.push(h),1;h.container=m;for(var p=null,f=m.rows.length-1;!p&&f>=0;f--)iN(m.rows[f],h,s)&&(p=m.rows[f]);p?(p.leaves.push(h),h.row=p):(h.leaves=[],m.rows.push(h))},u=0;u<o.length;u++)c();return o.map(function(d){return{event:d.data,style:{top:d.top,height:d.height,width:d.width,xOffset:Math.max(0,d.xOffset)}}})}function Vv(r,t,s){for(var n=0;n<r.friends.length;++n)if(!(s.indexOf(r.friends[n])>-1)){t=t>r.friends[n].idx?t:r.friends[n].idx,s.push(r.friends[n]);var a=Vv(r.friends[n],t,s);t=t>a?t:a}return t}function lN(r){var t=r.events,s=r.minimumStartDifference,n=r.slotMetrics,a=r.accessors,i=Yv({events:t,minimumStartDifference:s,slotMetrics:n,accessors:a});i.sort(function($,z){return $=$.style,z=z.style,$.top!==z.top?$.top>z.top?1:-1:$.height!==z.height?$.top+$.height<z.top+z.height?1:-1:0});for(var o=0;o<i.length;++o)i[o].friends=[],delete i[o].style.left,delete i[o].style.left,delete i[o].idx,delete i[o].size;for(var l=0;l<i.length-1;++l)for(var c=i[l],u=c.style.top,d=c.style.top+c.style.height,h=l+1;h<i.length;++h){var m=i[h],p=m.style.top,f=m.style.top+m.style.height;(p>=u&&f<=d||f>u&&f<=d||p>=u&&p<d)&&(c.friends.push(m),m.friends.push(c))}for(var v=0;v<i.length;++v){for(var y=i[v],j=[],g=0;g<100;++g)j.push(1);for(var _=0;_<y.friends.length;++_)y.friends[_].idx!==void 0&&(j[y.friends[_].idx]=0);y.idx=j.indexOf(1)}for(var b=0;b<i.length;++b){var N=0;if(!i[b].size){var w=[],E=Vv(i[b],0,w);N=100/(E+1),i[b].size=N;for(var S=0;S<w.length;++S)w[S].size=N}}for(var C=0;C<i.length;++C){var D=i[C];D.style.left=D.idx*D.size;for(var R=0,O=0;O<D.friends.length;++O){var T=D.friends[O].idx;R=R>T?R:T}R<=D.idx&&(D.size=100-D.idx*D.size);var q=D.idx===0?0:3;D.style.width="calc(".concat(D.size,"% - ").concat(q,"px)"),D.style.height="calc(".concat(D.style.height,"% - 2px)"),D.style.xOffset="calc(".concat(D.style.left,"% + ").concat(q,"px)")}return i}var bp={overlap:Yv,"no-overlap":lN};function cN(r){return!!(r&&r.constructor&&r.call&&r.apply)}function uN(r){r.events,r.minimumStartDifference,r.slotMetrics,r.accessors;var t=r.dayLayoutAlgorithm,s=t;return t in bp&&(s=bp[t]),cN(s)?s.apply(this,arguments):[]}var Xv=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,i=n.resource,o=n.group,l=n.getters,c=n.components,u=c===void 0?{}:c,d=u.timeSlotWrapper,h=d===void 0?dr:d,m=l?l.slotGroupProp(o):{};return A.createElement("div",Object.assign({className:"rbc-timeslot-group"},m),o.map(function(p,f){var v=l?l.slotProp(p,i):{};return A.createElement(h,{key:f,value:p,resource:i},A.createElement("div",Object.assign({},v,{className:be("rbc-time-slot",v.className)}),a&&a(p,f)))}))}}])}(x.Component);function Ms(r){return typeof r=="string"?r:r+"%"}function dN(r){var t=r.style,s=r.className,n=r.event,a=r.accessors,i=r.rtl,o=r.selected,l=r.label,c=r.continuesPrior,u=r.continuesAfter,d=r.getters,h=r.onClick,m=r.onDoubleClick,p=r.isBackgroundEvent,f=r.onKeyPress,v=r.components,y=v.event,j=v.eventWrapper,g=a.title(n),_=a.tooltip(n),b=a.end(n),N=a.start(n),w=d.eventProp(n,N,b,o),E=[A.createElement("div",{key:"1",className:"rbc-event-label"},l),A.createElement("div",{key:"2",className:"rbc-event-content"},y?A.createElement(y,{event:n,title:g}):g)],S=t.height,C=t.top,D=t.width,R=t.xOffset,O=ue(ue({},w.style),{},Zr({top:Ms(C),height:Ms(S),width:Ms(D)},i?"right":"left",Ms(R)));return A.createElement(j,Object.assign({type:"time"},r),A.createElement("div",{role:"button",tabIndex:0,onClick:h,onDoubleClick:m,style:O,onKeyDown:f,title:_?(typeof l=="string"?l+": ":"")+_:void 0,className:be(p?"rbc-background-event":"rbc-event",s,w.className,{"rbc-selected":o,"rbc-event-continues-earlier":c,"rbc-event-continues-later":u})},E))}var mN=function(t){var s=t.children,n=t.className,a=t.style,i=t.innerRef;return A.createElement("div",{className:n,style:a,ref:i},s)},hN=A.forwardRef(function(r,t){return A.createElement(mN,Object.assign({},r,{innerRef:t}))}),pN=["dayProp"],fN=["eventContainerWrapper","timeIndicatorWrapper"],Qv=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.state={selecting:!1,timeIndicatorPosition:null},s.intervalTriggered=!1,s.renderEvents=function(o){var l=o.events,c=o.isBackgroundEvent,u=s.props,d=u.rtl,h=u.selected,m=u.accessors,p=u.localizer,f=u.getters,v=u.components,y=u.step,j=u.timeslots,g=u.dayLayoutAlgorithm,_=u.resizable,b=s,N=b.slotMetrics,w=p.messages,E=uN({events:l,accessors:m,slotMetrics:N,minimumStartDifference:Math.ceil(y*j/2),dayLayoutAlgorithm:g});return E.map(function(S,C){var D,R=S.event,O=S.style,T=m.end(R),q=m.start(R),$=(D=m.eventId(R))!==null&&D!==void 0?D:"evt_"+C,z="eventTimeRangeFormat",J,ne=N.startsBeforeDay(q),le=N.startsAfterDay(T);ne?z="eventTimeRangeEndFormat":le&&(z="eventTimeRangeStartFormat"),ne&&le?J=w.allDay:J=p.format({start:q,end:T},z);var M=ne||N.startsBefore(q),F=le||N.startsAfter(T);return A.createElement(dN,{style:O,event:R,label:J,key:$,getters:f,rtl:d,components:v,continuesPrior:M,continuesAfter:F,accessors:m,resource:s.props.resource,selected:Ln(R,h),onClick:function(re){return s._select(ue(ue(ue({},R),s.props.resource&&{sourceResource:s.props.resource}),c&&{isBackgroundEvent:!0}),re)},onDoubleClick:function(re){return s._doubleClick(R,re)},isBackgroundEvent:c,onKeyPress:function(re){return s._keyPress(R,re)},resizable:_})})},s._selectable=function(){var o=s.containerRef.current,l=s.props,c=l.longPressThreshold,u=l.localizer,d=s._selector=new Bv(function(){return o},{longPressThreshold:c}),h=function(v){var y=s.props.onSelecting,j=s.state||{},g=m(v),_=g.startDate,b=g.endDate;y&&(u.eq(j.startDate,_,"minutes")&&u.eq(j.endDate,b,"minutes")||y({start:_,end:b,resourceId:s.props.resource})===!1)||(s.state.start!==g.start||s.state.end!==g.end||s.state.selecting!==g.selecting)&&s.setState(g)},m=function(v){var y=s.slotMetrics.closestSlotFromPoint(v,gt(o));s.state.selecting||(s._initialSlot=y);var j=s._initialSlot;u.lte(j,y)?y=s.slotMetrics.nextSlot(y):u.gt(j,y)&&(j=s.slotMetrics.nextSlot(j));var g=s.slotMetrics.getRange(u.min(j,y),u.max(j,y));return ue(ue({},g),{},{selecting:!0,top:"".concat(g.top,"%"),height:"".concat(g.height,"%")})},p=function(v,y){if(!un(s.containerRef.current,v)){var j=m(v),g=j.startDate,_=j.endDate;s._selectSlot({startDate:g,endDate:_,action:y,box:v})}s.setState({selecting:!1})};d.on("selecting",h),d.on("selectStart",h),d.on("beforeSelect",function(f){if(s.props.selectable==="ignoreEvents")return!un(s.containerRef.current,f)}),d.on("click",function(f){return p(f,"click")}),d.on("doubleClick",function(f){return p(f,"doubleClick")}),d.on("select",function(f){s.state.selecting&&(s._selectSlot(ue(ue({},s.state),{},{action:"select",bounds:f})),s.setState({selecting:!1}))}),d.on("reset",function(){s.state.selecting&&s.setState({selecting:!1})})},s._teardownSelectable=function(){s._selector&&(s._selector.teardown(),s._selector=null)},s._selectSlot=function(o){for(var l=o.startDate,c=o.endDate,u=o.action,d=o.bounds,h=o.box,m=l,p=[];s.props.localizer.lte(m,c);)p.push(m),m=new Date(+m+s.props.step*60*1e3);ve(s.props.onSelectSlot,{slots:p,start:l,end:c,resourceId:s.props.resource,action:u,bounds:d,box:h})},s._select=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onSelectEvent,l)},s._doubleClick=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onDoubleClickEvent,l)},s._keyPress=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onKeyPressEvent,l)},s.slotMetrics=Uc(s.props),s.containerRef=x.createRef(),s}return De(t,r),Ne(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var i=this.props,o=i.getNow,l=i.isNow,c=i.localizer,u=i.date,d=i.min,h=i.max,m=c.neq(n.getNow(),o(),"minutes");if(n.isNow!==l||m){if(this.clearTimeIndicatorInterval(),l){var p=!m&&c.eq(n.date,u,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(p)}}else l&&(c.neq(n.min,d,"minutes")||c.neq(n.max,h,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,i=n.max,o=n.getNow,l=o();if(l>=a&&l<=i){var c=this.slotMetrics.getCurrentTimePosition(l);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:c})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.max,o=n.rtl,l=n.isNow,c=n.resource,u=n.accessors,d=n.localizer,h=n.getters,m=h.dayProp,p=fr(h,pN),f=n.components,v=f.eventContainerWrapper,y=f.timeIndicatorWrapper,j=fr(f,fN);this.slotMetrics=this.slotMetrics.update(this.props);var g=this.slotMetrics,_=this.state,b=_.selecting,N=_.top,w=_.height,E=_.startDate,S=_.endDate,C={start:E,end:S},D=m(i,c),R=D.className,O=D.style,T={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},q=j.dayColumnWrapper||hN;return A.createElement(q,{ref:this.containerRef,date:a,style:O,className:be(R,"rbc-day-slot","rbc-time-column",l&&"rbc-now",l&&"rbc-today",b&&"rbc-slot-selecting"),slotMetrics:g,resource:c},g.groups.map(function($,z){return A.createElement(Xv,{key:z,group:$,resource:c,getters:p,components:j})}),A.createElement(v,{localizer:d,resource:c,accessors:u,getters:p,components:j,slotMetrics:g},A.createElement("div",{className:be("rbc-events-container",o&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),b&&A.createElement("div",{className:"rbc-slot-selection",style:{top:N,height:w}},A.createElement("span",null,d.format(C,"selectRangeFormat"))),l&&this.intervalTriggered&&A.createElement(y,T,A.createElement("div",T)))}}])}(A.Component);Qv.defaultProps={dragThroughEvents:!0,timeslots:2};var Jv=function(t){var s=t.label;return A.createElement(A.Fragment,null,s)},vN=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),ve(s.props.onDrillDown,[o,l])},s.renderRow=function(o){var l=s.props,c=l.events,u=l.rtl,d=l.selectable,h=l.getNow,m=l.range,p=l.getters,f=l.localizer,v=l.accessors,y=l.components,j=l.resizable,g=v.resourceId(o),_=o?c.filter(function(b){return v.resource(b)===g}):c;return A.createElement(vs,{isAllDay:!0,rtl:u,getNow:h,minRows:2,maxRows:s.props.allDayMaxRows+1,range:m,events:_,resourceId:g,className:"rbc-allday-cell",selectable:d,selected:s.props.selected,components:y,accessors:v,getters:p,localizer:f,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyPress:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:j})},s}return De(t,r),Ne(t,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,u=i.getters.dayProp,d=i.components.header,h=d===void 0?zc:d,m=c();return n.map(function(p,f){var v=l(p),y=o.format(p,"dayFormat"),j=u(p),g=j.className,_=j.style,b=A.createElement(h,{date:p,label:y,localizer:o});return A.createElement("div",{key:f,style:_,className:be("rbc-header",g,o.isSameDate(p,m)&&"rbc-today")},v?A.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(w){return a.handleHeaderClick(p,v,w)}},b):A.createElement("span",null,b))})}},{key:"render",value:function(){var n=this,a=this.props,i=a.width,o=a.rtl,l=a.resources,c=a.range,u=a.events,d=a.getNow,h=a.accessors,m=a.selectable,p=a.components,f=a.getters,v=a.scrollRef,y=a.localizer,j=a.isOverflowing,g=a.components,_=g.timeGutterHeader,b=g.resourceHeader,N=b===void 0?Jv:b,w=a.resizable,E={};j&&(E[o?"marginLeft":"marginRight"]="".concat(jc()-1,"px"));var S=l.groupEvents(u);return A.createElement("div",{style:E,ref:v,className:be("rbc-time-header",j&&"rbc-overflowing")},A.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},_&&A.createElement(_,null)),l.map(function(C,D){var R=ut(C,2),O=R[0],T=R[1];return A.createElement("div",{className:"rbc-time-header-content",key:O||D},T&&A.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(D)},A.createElement("div",{className:"rbc-header"},A.createElement(N,{index:D,label:h.resourceTitle(T),resource:T}))),A.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(c.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(c)),A.createElement(vs,{isAllDay:!0,rtl:o,getNow:d,minRows:2,maxRows:n.props.allDayMaxRows+1,range:c,events:S.get(O)||[],resourceId:T&&O,className:"rbc-allday-cell",selectable:m,selected:n.props.selected,components:p,accessors:h,getters:f,localizer:y,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:w}))}))}}])}(A.Component),gN=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.handleHeaderClick=function(o,l,c){c.preventDefault(),ve(s.props.onDrillDown,[o,l])},s}return De(t,r),Ne(t,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,o=i.localizer,l=i.getDrilldownView,c=i.getNow,u=i.getters.dayProp,d=i.components,h=d.header,m=h===void 0?zc:h,p=d.resourceHeader,f=p===void 0?Jv:p,v=i.resources,y=i.accessors,j=i.events,g=i.rtl,_=i.selectable,b=i.components,N=i.getters,w=i.resizable,E=c(),S=v.groupEvents(j);return n.map(function(C,D){var R=l(C),O=o.format(C,"dayFormat"),T=u(C),q=T.className,$=T.style,z=A.createElement(m,{date:C,label:O,localizer:o});return A.createElement("div",{key:D,className:"rbc-time-header-content rbc-resource-grouping"},A.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},A.createElement("div",{style:$,className:be("rbc-header",q,o.isSameDate(C,E)&&"rbc-today")},R?A.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(ne){return a.handleHeaderClick(C,R,ne)}},z):A.createElement("span",null,z))),A.createElement("div",{className:"rbc-row"},v.map(function(J,ne){var le=ut(J,2),M=le[0],F=le[1];return A.createElement("div",{key:"resource_".concat(M,"_").concat(ne),className:be("rbc-header",q,o.isSameDate(C,E)&&"rbc-today")},A.createElement(f,{index:ne,label:y.resourceTitle(F),resource:F}))})),A.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},v.map(function(J,ne){var le=ut(J,2),M=le[0],F=le[1],de=(S.get(M)||[]).filter(function(re){return o.isSameDate(re.start,C)||o.isSameDate(re.end,C)});return A.createElement(vs,{key:"resource_".concat(M,"_").concat(ne),isAllDay:!0,rtl:g,getNow:c,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[C],events:de,resourceId:F&&M,className:"rbc-allday-cell",selectable:_,selected:a.props.selected,components:b,accessors:y,getters:N,localizer:o,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:w})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,i=n.rtl,o=n.range,l=n.scrollRef,c=n.isOverflowing,u=n.components.timeGutterHeader,d={};return c&&(d[i?"marginLeft":"marginRight"]="".concat(jc()-1,"px")),A.createElement("div",{style:d,ref:l,className:be("rbc-time-header",c&&"rbc-overflowing")},A.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},u&&A.createElement(u,null)),this.renderHeaderCells(o))}}])}(A.Component);function xN(r){var t=r.min,s=r.max,n=r.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(s)?{start:n.add(t,-1,"day"),end:n.add(s,-1,"day")}:{start:t,end:s}}var yN=function(t){var s=t.min,n=t.max,a=t.timeslots,i=t.step,o=t.localizer,l=t.getNow,c=t.resource,u=t.components,d=t.getters,h=t.gutterRef,m=u.timeGutterWrapper,p=x.useMemo(function(){return xN({min:s,max:n,localizer:o})},[s==null?void 0:s.toISOString(),n==null?void 0:n.toISOString(),o]),f=p.start,v=p.end,y=x.useState(Uc({min:f,max:v,timeslots:a,step:i,localizer:o})),j=ut(y,2),g=j[0],_=j[1];x.useEffect(function(){g&&_(g.update({min:f,max:v,timeslots:a,step:i,localizer:o}))},[f==null?void 0:f.toISOString(),v==null?void 0:v.toISOString(),a,i]);var b=x.useCallback(function(N,w){if(w)return null;var E=g.dateIsInGroup(l(),w);return A.createElement("span",{className:be("rbc-label",E&&"rbc-now")},o.format(N,"timeGutterFormat"))},[g,o,l]);return A.createElement(m,{slotMetrics:g},A.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:h},g.groups.map(function(N,w){return A.createElement(Xv,{key:w,group:N,resource:c,components:u,renderSlot:b,getters:d})})))},bN=A.forwardRef(function(r,t){return A.createElement(yN,Object.assign({gutterRef:t},r))}),Sl={};function jN(r,t){return{map:function(n){return r?r.map(function(a,i){return n([t.resourceId(a),a],i)}):[n([Sl,null],0)]},groupEvents:function(n){var a=new Map;return r?(n.forEach(function(i){var o=t.resource(i)||Sl;if(Array.isArray(o))o.forEach(function(c){var u=a.get(c)||[];u.push(i),a.set(c,u)});else{var l=a.get(o)||[];l.push(i),a.set(o,l)}}),a):(a.set(Sl,n),a)}}}var Bt=function(r){function t(s){var n;return Se(this,t),n=ke(this,t,[s]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){Pu(n.rafHandle),n.rafHandle=av(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];ve(n.props.onKeyPressEvent,i)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];ve(n.props.onSelectEvent,i)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];ve(n.props.onDoubleClickEvent,i)},n.handleShowMore=function(a,i,o,l,c){var u=n.props,d=u.popup,h=u.onDrillDown,m=u.onShowMore,p=u.getDrilldownView,f=u.doShowMoreDrillDown;if(n.clearSelection(),d){var v=nv(o,n.containerRef.current);n.setState({overlay:{date:i,events:a,position:ue(ue({},v),{},{width:"200px"}),target:c}})}else f&&ve(h,[i,p(i)||Oe.DAY]);ve(m,[a,i,l])},n.handleSelectAllDaySlot=function(a,i){var o=n.props.onSelectSlot,l=new Date(a[0]),c=new Date(a[a.length-1]);c.setDate(a[a.length-1].getDate()+1),ve(o,{slots:a,start:l,end:c,action:i.action,resourceId:i.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var i=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==i&&(n._updatingOverflow=!0,n.setState({isOverflowing:i},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=Nv(function(a,i){return jN(a,i)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=A.createRef(),n.contentRef=A.createRef(),n.containerRef=A.createRef(),n._scrollRatio=null,n.gutterRef=x.createRef(),n}return De(t,r),Ne(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Pu(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,i,o,l,c,u,d,h,m){var p=this.props,f=p.min,v=p.max,y=(o.get(a)||[]).filter(function(g){return c.inRange(n,u.start(g),u.end(g),"day")}),j=(l.get(a)||[]).filter(function(g){return c.inRange(n,u.start(g),u.end(g),"day")});return A.createElement(Qv,Object.assign({},this.props,{localizer:c,min:c.merge(n,f),max:c.merge(n,v),resource:i&&a,components:d,isNow:c.isSameDate(n,m),key:"".concat(a,"-").concat(n),date:n,events:y,backgroundEvents:j,dayLayoutAlgorithm:h}))}},{key:"renderResourcesFirst",value:function(n,a,i,o,l,c,u,d,h){var m=this;return a.map(function(p){var f=ut(p,2),v=f[0],y=f[1];return n.map(function(j){return m.renderDayColumn(j,v,y,i,o,l,c,d,h,u)})})}},{key:"renderRangeFirst",value:function(n,a,i,o,l,c,u,d,h){var m=this;return n.map(function(p){return A.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:p},a.map(function(f){var v=ut(f,2),y=v[0],j=v[1];return A.createElement("div",{style:{flex:1},key:c.resourceId(j)},m.renderDayColumn(p,y,j,i,o,l,c,d,h,u))}))})}},{key:"renderEvents",value:function(n,a,i,o){var l=this.props,c=l.accessors,u=l.localizer,d=l.resourceGroupingLayout,h=l.components,m=l.dayLayoutAlgorithm,p=this.memoizedResources(this.props.resources,c),f=p.groupEvents(a),v=p.groupEvents(i);return d?this.renderRangeFirst(n,p,f,v,u,c,o,h,m):this.renderResourcesFirst(n,p,f,v,u,c,o,h,m)}},{key:"render",value:function(){var n,a=this.props,i=a.events,o=a.backgroundEvents,l=a.range,c=a.width,u=a.rtl,d=a.selected,h=a.getNow,m=a.resources,p=a.components,f=a.accessors,v=a.getters,y=a.localizer,j=a.min,g=a.max,_=a.showMultiDayTimes,b=a.longPressThreshold,N=a.resizable,w=a.resourceGroupingLayout;c=c||this.state.gutterWidth;var E=l[0],S=l[l.length-1];this.slots=l.length;var C=[],D=[],R=[];i.forEach(function(T){if(fs(T,E,S,f,y)){var q=f.start(T),$=f.end(T);f.allDay(T)||y.startAndEndAreDateOnly(q,$)||!_&&!y.isSameDate(q,$)?C.push(T):D.push(T)}}),o.forEach(function(T){fs(T,E,S,f,y)&&R.push(T)}),C.sort(function(T,q){return Yl(T,q,f,y)});var O={range:l,events:C,width:c,rtl:u,getNow:h,localizer:y,selected:d,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(m,f),selectable:this.props.selectable,accessors:f,getters:v,components:p,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:b,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:N};return A.createElement("div",{className:be("rbc-time-view",m&&"rbc-time-view-resources"),ref:this.containerRef},m&&m.length>1&&w?A.createElement(gN,O):A.createElement(vN,O),this.props.popup&&this.renderOverlay(),A.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},A.createElement(bN,{date:E,ref:this.gutterRef,localizer:y,min:y.merge(E,j),max:y.merge(E,g),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:p,className:"rbc-time-gutter",getters:v}),this.renderEvents(l,D,R,h())))}},{key:"renderOverlay",value:function(){var n,a,i=this,o=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,u=l.localizer,d=l.components,h=l.getters,m=l.selected,p=l.popupOffset,f=l.handleDragStart,v=function(){return i.setState({overlay:null})};return A.createElement($c,{overlay:o,accessors:c,localizer:u,components:d,getters:h,selected:m,popupOffset:p,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:f,show:!!o.position,overlayDisplay:this.overlayDisplay,onHide:v})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,i=(a=n.gutterRef)!==null&&a!==void 0&&a.current?Wl(n.gutterRef.current):void 0;i&&n.state.gutterWidth!==i&&n.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,i=n.max,o=n.scrollToTime,l=n.localizer,c=l.diff(l.merge(o,a),o,"milliseconds"),u=l.diff(a,i,"milliseconds");this._scrollRatio=c/u}}])}(x.Component);Bt.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var wN=["date","localizer","min","max","scrollToTime","enableAutoScroll"],$n=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,h=d===void 0?i.startOf(new Date,"day"):d,m=n.enableAutoScroll,p=m===void 0?!0:m,f=fr(n,wN),v=t.range(a,{localizer:i});return A.createElement(Bt,Object.assign({},f,{range:v,eventOffset:10,localizer:i,min:l,max:u,scrollToTime:h,enableAutoScroll:p}))}}])}(A.Component);$n.range=function(r,t){var s=t.localizer;return[s.startOf(r,"day")]};$n.navigate=function(r,t,s){var n=s.localizer;switch(t){case Fe.PREVIOUS:return n.add(r,-1,"day");case Fe.NEXT:return n.add(r,1,"day");default:return r}};$n.title=function(r,t){var s=t.localizer;return s.format(r,"dayHeaderFormat")};var _N=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Hr=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,h=d===void 0?i.startOf(new Date,"day"):d,m=n.enableAutoScroll,p=m===void 0?!0:m,f=fr(n,_N),v=t.range(a,this.props);return A.createElement(Bt,Object.assign({},f,{range:v,eventOffset:15,localizer:i,min:l,max:u,scrollToTime:h,enableAutoScroll:p}))}}])}(A.Component);Hr.defaultProps=Bt.defaultProps;Hr.navigate=function(r,t,s){var n=s.localizer;switch(t){case Fe.PREVIOUS:return n.add(r,-1,"week");case Fe.NEXT:return n.add(r,1,"week");default:return r}};Hr.range=function(r,t){var s=t.localizer,n=s.startOfWeek(),a=s.startOf(r,"week",n),i=s.endOf(r,"week",n);return s.range(a,i)};Hr.title=function(r,t){var s=t.localizer,n=Hr.range(r,{localizer:s}),a=kv(n),i=a[0],o=a.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var SN=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function Bc(r,t){return Hr.range(r,t).filter(function(s){return[6,0].indexOf(s.getDay())===-1})}var Ts=function(r){function t(){return Se(this,t),ke(this,t,arguments)}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,o=n.min,l=o===void 0?i.startOf(new Date,"day"):o,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,h=d===void 0?i.startOf(new Date,"day"):d,m=n.enableAutoScroll,p=m===void 0?!0:m,f=fr(n,SN),v=Bc(a,this.props);return A.createElement(Bt,Object.assign({},f,{range:v,eventOffset:15,localizer:i,min:l,max:u,scrollToTime:h,enableAutoScroll:p}))}}])}(A.Component);Ts.defaultProps=Bt.defaultProps;Ts.range=Bc;Ts.navigate=Hr.navigate;Ts.title=function(r,t){var s=t.localizer,n=Bc(r,{localizer:s}),a=kv(n),i=a[0],o=a.slice(1);return s.format({start:i,end:o.pop()},"dayRangeHeaderFormat")};var zn=30;function Un(r){var t=r.accessors,s=r.components,n=r.date,a=r.events,i=r.getters,o=r.length,l=o===void 0?zn:o,c=r.localizer,u=r.onDoubleClickEvent,d=r.onSelectEvent,h=r.selected,m=x.useRef(null),p=x.useRef(null),f=x.useRef(null),v=x.useRef(null),y=x.useRef(null);x.useEffect(function(){_()});var j=function(S,C,D){var R=s.event,O=s.date;return C=C.filter(function(T){return fs(T,c.startOf(S,"day"),c.endOf(S,"day"),t,c)}),C.map(function(T,q){var $=t.title(T),z=t.end(T),J=t.start(T),ne=i.eventProp(T,J,z,Ln(T,h)),le=q===0&&c.format(S,"agendaDateFormat"),M=q===0?A.createElement("td",{rowSpan:C.length,className:"rbc-agenda-date-cell"},O?A.createElement(O,{day:S,label:le}):le):!1;return A.createElement("tr",{key:D+"_"+q,className:ne.className,style:ne.style},M,A.createElement("td",{className:"rbc-agenda-time-cell"},g(S,T)),A.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(de){return d&&d(T,de)},onDoubleClick:function(de){return u&&u(T,de)}},R?A.createElement(R,{event:T,title:$}):$))},[])},g=function(S,C){var D="",R=s.time,O=c.messages.allDay,T=t.end(C),q=t.start(C);return t.allDay(C)||(c.eq(q,T)?O=c.format(q,"agendaTimeFormat"):c.isSameDate(q,T)?O=c.format({start:q,end:T},"agendaTimeRangeFormat"):c.isSameDate(S,q)?O=c.format(q,"agendaTimeFormat"):c.isSameDate(S,T)&&(O=c.format(T,"agendaTimeFormat"))),c.gt(S,q,"day")&&(D="rbc-continues-prior"),c.lt(S,T,"day")&&(D+=" rbc-continues-after"),A.createElement("span",{className:D.trim()},R?A.createElement(R,{event:C,day:S,label:O}):O)},_=function(){if(y.current){var S=m.current,C=y.current.firstChild;if(C){var D=v.current.scrollHeight>v.current.clientHeight,R=[],O=R;R=[Wl(C.children[0]),Wl(C.children[1])],(O[0]!==R[0]||O[1]!==R[1])&&(p.current.style.width=R[0]+"px",f.current.style.width=R[1]+"px"),D?(S0(S,"rbc-header-overflowing"),S.style.marginRight=jc()+"px"):N0(S,"rbc-header-overflowing")}}},b=c.messages,N=c.add(n,l,"day"),w=c.range(n,N,"day");return a=a.filter(function(E){return fs(E,c.startOf(n,"day"),c.endOf(N,"day"),t,c)}),a.sort(function(E,S){return+t.start(E)-+t.start(S)}),A.createElement("div",{className:"rbc-agenda-view"},a.length!==0?A.createElement(A.Fragment,null,A.createElement("table",{ref:m,className:"rbc-agenda-table"},A.createElement("thead",null,A.createElement("tr",null,A.createElement("th",{className:"rbc-header",ref:p},b.date),A.createElement("th",{className:"rbc-header",ref:f},b.time),A.createElement("th",{className:"rbc-header"},b.event)))),A.createElement("div",{className:"rbc-agenda-content",ref:v},A.createElement("table",{className:"rbc-agenda-table"},A.createElement("tbody",{ref:y},w.map(function(E,S){return j(E,a,S)}))))):A.createElement("span",{className:"rbc-agenda-empty"},b.noEventsInRange))}Un.range=function(r,t){var s=t.length,n=s===void 0?zn:s,a=t.localizer,i=a.add(r,n,"day");return{start:r,end:i}};Un.navigate=function(r,t,s){var n=s.length,a=n===void 0?zn:n,i=s.localizer;switch(t){case Fe.PREVIOUS:return i.add(r,-a,"day");case Fe.NEXT:return i.add(r,a,"day");default:return r}};Un.title=function(r,t){var s=t.length,n=s===void 0?zn:s,a=t.localizer,i=a.add(r,n,"day");return a.format({start:r,end:i},"agendaHeaderFormat")};var Ys=Zr(Zr(Zr(Zr(Zr({},Oe.MONTH,Fn),Oe.WEEK,Hr),Oe.WORK_WEEK,Ts),Oe.DAY,$n),Oe.AGENDA,Un),NN=["action","date","today"];function EN(r,t){var s=t.action,n=t.date,a=t.today,i=fr(t,NN);switch(r=typeof r=="string"?Ys[r]:r,s){case Fe.TODAY:n=a||new Date;break;case Fe.DATE:break;default:rs(r&&typeof r.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=r.navigate(n,s,i)}return n}function CN(r,t){var s=null;return typeof t=="function"?s=t(r):typeof t=="string"&&lt(r)==="object"&&r!=null&&t in r&&(s=r[t]),s}var _r=function(t){return function(s){return CN(s,t)}},TN=["view","date","getNow","onNavigate"],RN=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function Zv(r){if(Array.isArray(r))return r;for(var t=[],s=0,n=Object.entries(r);s<n.length;s++){var a=ut(n[s],2),i=a[0],o=a[1];o&&t.push(i)}return t}function AN(r,t){var s=t.views,n=Zv(s);return n.indexOf(r)!==-1}var eg=function(r){function t(){var s;Se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s=ke(this,t,[].concat(a)),s.getViews=function(){var o=s.props.views;return Array.isArray(o)?J_(o,function(l,c){return l[c]=Ys[c]},{}):lt(o)==="object"?j_(o,function(l,c){return l===!0?Ys[c]:l}):Ys},s.getView=function(){var o=s.getViews();return o[s.props.view]},s.getDrilldownView=function(o){var l=s.props,c=l.view,u=l.drilldownView,d=l.getDrilldownView;return d?d(o,c,Object.keys(s.getViews())):u},s.handleRangeChange=function(o,l,c){var u=s.props,d=u.onRangeChange,h=u.localizer;d&&l.range&&d(l.range(o,{localizer:h}),c)},s.handleNavigate=function(o,l){var c=s.props,u=c.view,d=c.date,h=c.getNow,m=c.onNavigate,p=fr(c,TN),f=s.getView(),v=h();d=EN(f,ue(ue({},p),{},{action:o,date:l||d||v,today:v})),m(d,u,o),s.handleRangeChange(d,f)},s.handleViewChange=function(o){o!==s.props.view&&AN(o,s.props)&&s.props.onView(o);var l=s.getViews();s.handleRangeChange(s.props.date||s.props.getNow(),l[o],o)},s.handleSelectEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onSelectEvent,l)},s.handleDoubleClickEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onDoubleClickEvent,l)},s.handleKeyPressEvent=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];ve(s.props.onKeyPressEvent,l)},s.handleSelectSlot=function(o){ve(s.props.onSelectSlot,o)},s.handleDrillDown=function(o,l){var c=s.props.onDrillDown;if(c){c(o,l,s.drilldownView);return}l&&s.handleViewChange(l),s.handleNavigate(Fe.DATE,o)},s.state={context:t.getContext(s.props)},s}return De(t,r),Ne(t,[{key:"render",value:function(){var n=this.props,a=n.view,i=n.toolbar,o=n.events,l=n.backgroundEvents,c=n.resourceGroupingLayout,u=n.style,d=n.className,h=n.elementProps,m=n.date,p=n.getNow,f=n.length,v=n.showMultiDayTimes,y=n.onShowMore,j=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var g=fr(n,RN);m=m||p();var _=this.getView(),b=this.state.context,N=b.accessors,w=b.components,E=b.getters,S=b.localizer,C=b.viewNames,D=w.toolbar||PS,R=_.title(m,{localizer:S,length:f});return A.createElement("div",Object.assign({},h,{className:be(d,"rbc-calendar",g.rtl&&"rbc-rtl"),style:u}),i&&A.createElement(D,{date:m,view:a,views:C,label:R,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:S}),A.createElement(_,Object.assign({},g,{events:o,backgroundEvents:l,date:m,getNow:p,length:f,localizer:S,getters:E,components:w,accessors:N,showMultiDayTimes:v,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:y,doShowMoreDrillDown:j,resourceGroupingLayout:c})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,i=n.endAccessor,o=n.allDayAccessor,l=n.tooltipAccessor,c=n.titleAccessor,u=n.resourceAccessor,d=n.resourceIdAccessor,h=n.resourceTitleAccessor,m=n.eventIdAccessor,p=n.eventPropGetter,f=n.backgroundEventPropGetter,v=n.slotPropGetter,y=n.slotGroupPropGetter,j=n.dayPropGetter,g=n.view,_=n.views,b=n.localizer,N=n.culture,w=n.messages,E=w===void 0?{}:w,S=n.components,C=S===void 0?{}:S,D=n.formats,R=D===void 0?{}:D,O=Zv(_),T=OS(E);return{viewNames:O,localizer:DS(b,N,R,T),getters:{eventProp:function(){return p&&p.apply(void 0,arguments)||{}},backgroundEventProp:function(){return f&&f.apply(void 0,arguments)||{}},slotProp:function(){return v&&v.apply(void 0,arguments)||{}},slotGroupProp:function(){return y&&y.apply(void 0,arguments)||{}},dayProp:function(){return j&&j.apply(void 0,arguments)||{}}},components:x_(C[g]||{},V_(C,O),{eventWrapper:dr,backgroundEventWrapper:dr,eventContainerWrapper:dr,dateCellWrapper:dr,weekWrapper:dr,timeSlotWrapper:dr,timeGutterWrapper:dr,timeIndicatorWrapper:dr}),accessors:{start:_r(a),end:_r(i),allDay:_r(o),tooltip:_r(l),title:_r(c),resource:_r(u),resourceId:_r(d),resourceTitle:_r(h),eventId:_r(m)}}}}])}(A.Component);eg.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Oe.MONTH,views:[Oe.MONTH,Oe.WEEK,Oe.DAY,Oe.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Oe.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var kN=Uf(eg,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),DN=function(t,s,n){var a=t.start,i=t.end;return"".concat(n.format(a,"P",s)," – ").concat(n.format(i,"P",s))},Nl=function(t,s,n){var a=t.start,i=t.end;return"".concat(n.format(a,"p",s)," – ").concat(n.format(i,"p",s))},PN=function(t,s,n){var a=t.start;return"".concat(n.format(a,"h:mma",s)," – ")},MN=function(t,s,n){var a=t.end;return" – ".concat(n.format(a,"h:mma",s))},ON=function(t,s,n){var a=t.start,i=t.end;return"".concat(n.format(a,"MMMM dd",s)," – ").concat(n.format(i,Lt(a,i,"month")?"dd":"MMMM dd",s))},IN={dateFormat:"dd",dayFormat:"dd eee",weekdayFormat:"ccc",selectRangeFormat:Nl,eventTimeRangeFormat:Nl,eventTimeRangeStartFormat:PN,eventTimeRangeEndFormat:MN,timeGutterFormat:"p",monthHeaderFormat:"MMMM yyyy",dayHeaderFormat:"cccc MMM dd",dayRangeHeaderFormat:ON,agendaHeaderFormat:DN,agendaDateFormat:"ccc MMM dd",agendaTimeFormat:"p",agendaTimeRangeFormat:Nl},qN=function(t){var s=t.startOfWeek,n=t.getDay,a=t.format,i=t.locales;return new kS({formats:IN,firstOfWeek:function(l){return n(s(new Date,{locale:i[l]}))},format:function(l,c,u){return a(new Date(l),c,{locale:i[u]})}})};function LN(r){Ig(1,arguments);var t=qg(r),s=t.getDay();return s}const FN={fr:Fg},$N=qN({format:Lg,startOfWeek:r=>$g(r,{weekStartsOn:1}),getDay:LN,locales:FN}),zN=({bookings:r,loading:t,onUpdateStatus:s})=>{const[n,a]=x.useState("month"),i=r.map(c=>({id:c.id,title:`${c.space_name||"Espace"} - ${c.user_name||"Utilisateur"}`,start:new Date(c.start_time),end:new Date(c.end_time),resource:c})),o=({event:c})=>{const u=c.resource;return e.jsxs("div",{className:"text-xs p-1 overflow-hidden h-full",children:[e.jsx("div",{className:"font-semibold truncate",children:c.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(nc,{status:u.status}),e.jsxs("select",{value:u.status,onChange:d=>s(u.id,d.target.value),className:"text-xs bg-transparent border-none focus:ring-0",onClick:d=>d.stopPropagation(),children:[e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"confirmed",children:"Confirmé"}),e.jsx("option",{value:"cancelled",children:"Annulé"})]})]})]})},l=c=>{const u=()=>{c.onNavigate("PREV")},d=()=>{c.onNavigate("NEXT")},h=()=>{c.onNavigate("TODAY")};return e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:u,children:"Précédent"}),e.jsx(P,{variant:"outline",size:"sm",onClick:h,children:"Aujourd'hui"}),e.jsx(P,{variant:"outline",size:"sm",onClick:d,children:"Suivant"})]}),e.jsx("h2",{className:"text-lg font-semibold",children:c.label}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:n==="month"?"default":"outline",size:"sm",onClick:()=>a("month"),children:"Mois"}),e.jsx(P,{variant:n==="week"?"default":"outline",size:"sm",onClick:()=>a("week"),children:"Semaine"}),e.jsx(P,{variant:n==="day"?"default":"outline",size:"sm",onClick:()=>a("day"),children:"Jour"}),e.jsx(P,{variant:n==="agenda"?"default":"outline",size:"sm",onClick:()=>a("agenda"),children:"Agenda"})]})]})};return t?e.jsx("div",{className:"h-[600px] w-full bg-gray-100 animate-pulse rounded-md"}):e.jsx("div",{className:"h-[600px]",children:e.jsx(kN,{localizer:$N,events:i,startAccessor:"start",endAccessor:"end",style:{height:"100%"},views:["month","week","day","agenda"],view:n,onView:c=>a(c),components:{event:o,toolbar:l},popup:!0,onSelectEvent:c=>{console.log("Selected event:",c)},eventPropGetter:c=>{const u=c.resource;let d="#3174ad";return u.status==="confirmed"?d="#10b981":u.status==="pending"?d="#f59e0b":u.status==="cancelled"&&(d="#ef4444"),{style:{backgroundColor:d}}},messages:{month:"Mois",week:"Semaine",day:"Jour",agenda:"Agenda",today:"Aujourd'hui",previous:"Précédent",next:"Suivant",showMore:c=>`+ ${c} autres`},culture:"fr"})})},dn=new Map;let UN=!1;function jp(r,t,s,n="*"){if(dn.has(r)){console.log(`⚠️ Canal ${r} existe déjà. Il ne sera pas recréé.`);return}try{console.log(`ℹ️ WebSocket temps réel non disponible avec PostgreSQL direct (${r})`);const a={unsubscribe:()=>{},on:()=>a,subscribe:()=>({status:"SUBSCRIBED"})};dn.set(r,{channel:a,callback:s,table:t,event:n}),console.log(`✅ Canal ${r} configuré (PostgreSQL mode)`),UN=!0}catch(a){console.error(`❌ Erreur non interceptée lors de la création du canal ${r}:`,a)}}function wp(r){if(dn.get(r))try{console.log(`🔌 Déconnexion du canal ${r} (PostgreSQL mode)`),dn.delete(r)}catch(s){console.error(`❌ Erreur lors de la suppression du canal ${r}:`,s)}else console.log(`⚠️ Canal ${r} non trouvé pour suppression`)}const BN=()=>{const[r,t]=x.useState("grid"),{user:s}=mn(),{bookings:n,loading:a,refreshing:i,error:o,handleUpdateStatus:l,handleRefresh:c,handleDeleteBooking:u}=ib();x.useEffect(()=>{(async()=>{try{s||k.error("Vous devez être connecté pour accéder à cette page")}catch(m){console.error("Error checking admin access:",m)}})()},[s]),x.useEffect(()=>{const h=m=>{console.log("Changement détecté dans les réservations:",m),k.info("Nouvelle mise à jour des réservations, rafraîchissement..."),c()};return jp("admin_bookings_global","bookings",h),jp("admin_spaces_global","spaces",h),()=>{wp("admin_bookings_global"),wp("admin_spaces_global")}},[]);const d=async(h,m)=>{await l(h,m)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ab,{refreshing:i,onRefresh:c}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Liste des réservations"}),e.jsx(we,{children:"Gérez les réservations des utilisateurs"})]}),e.jsxs(W,{children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(kr,{value:r,onValueChange:h=>t(h),className:"w-auto",children:e.jsxs(Dr,{children:[e.jsxs(ce,{value:"grid",className:"flex items-center gap-1",children:[e.jsx(Fp,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Grille"})]}),e.jsxs(ce,{value:"table",className:"flex items-center gap-1",children:[e.jsx($p,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Tableau"})]}),e.jsxs(ce,{value:"calendar",className:"flex items-center gap-1",children:[e.jsx(gr,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Calendrier"})]})]})})}),a?e.jsx("p",{children:"Chargement des réservations..."}):o?e.jsx("div",{className:"text-red-500",children:o}):n.length===0?e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{children:"Aucune réservation trouvée"})}):r==="grid"?e.jsx(lb,{bookings:n,loading:a,onUpdateStatus:d,onDelete:u}):r==="table"?e.jsx(nb,{bookings:n,loading:a,onUpdateStatus:d,onDelete:u}):e.jsx(zN,{bookings:n,loading:a,onUpdateStatus:d})]})]})]})};async function HN(r,t,s){try{console.log(`💰 Remboursement du paiement: ${r}`);const n=await B.post(`/stripe/payments/${r}/refund`,{amount:t,reason:s||"requested_by_customer"});if(!n.success)throw console.error("❌ Erreur lors du remboursement:",n.error),new Error(n.error||"Erreur lors du remboursement");return console.log(`✅ Remboursement réussi: ${n.data.refund_id}`),!0}catch(n){throw console.error("❌ Erreur lors du remboursement:",n),n}}const WN=()=>{var ne,le,M;const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState("all"),[o,l]=x.useState("all"),[c,u]=x.useState(""),[d,h]=x.useState(""),[m,p]=x.useState(""),[f,v]=x.useState(""),[y,j]=x.useState(""),[g,_]=x.useState(null),[b,N]=x.useState(!1),[w,E]=x.useState(!1),[S,C]=x.useState(null);x.useEffect(()=>{D()},[]);const D=async()=>{try{n(!0);const F=await B.get("/stripe/payments");if(F.success&&F.data){const de=Array.isArray(F.data)?F.data.map(re=>{var Me,Ve,Xe,Lr,jt,Fr,wt,Yr,_t,oe,ur,ae,sr;console.log("🔍 Debug paiement Stripe:",{id:re.id,status:re.status,charges:((Ve=(Me=re.charges)==null?void 0:Me.data)==null?void 0:Ve.length)||0,chargesData:(Xe=re.charges)==null?void 0:Xe.data});let Pe=!1;if(re.has_refunds===!0)Pe=!0,console.log("✅ Remboursements détectés via has_refunds:",re.id);else if((Lr=re.charges)!=null&&Lr.data)for(const Ce of re.charges.data){if(console.log("🔍 Debug charge:",{id:Ce.id,refunded:Ce.refunded,refunds:((Fr=(jt=Ce.refunds)==null?void 0:jt.data)==null?void 0:Fr.length)||0,refundsData:(wt=Ce.refunds)==null?void 0:wt.data}),Ce.refunded===!0){Pe=!0;break}if(Ce.refunds&&Ce.refunds.data&&Ce.refunds.data.length>0){Pe=!0;break}}let he=re.status;return Pe&&(he="refunded",console.log("✅ Paiement remboursé détecté:",re.id)),{id:re.id,booking_id:((Yr=re.metadata)==null?void 0:Yr.booking_id)||"",amount:re.amount/100,status:he,payment_method:((_t=re.payment_method_types)==null?void 0:_t[0])||"card",payment_intent_id:re.id,invoice_url:((ae=(ur=(oe=re.charges)==null?void 0:oe.data)==null?void 0:ur[0])==null?void 0:ae.receipt_url)||null,created_at:new Date(re.created*1e3).toISOString(),updated_at:new Date(re.created*1e3).toISOString(),currency:re.currency,mode:"test",user_email:((sr=re.customer)==null?void 0:sr.email)||"",description:re.description||"",metadata:re.metadata}}):[];t(de),console.log(`✅ ${de.length} paiements Stripe récupérés`)}else console.error("Error fetching payments:",F.error),k.error("Impossible de récupérer les paiements"),t([])}catch(F){console.error("Error fetching payments:",F),k.error("Impossible de récupérer les paiements"),t([])}finally{n(!1)}},R=F=>new Date(F).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=F=>{switch(F){case"succeeded":return e.jsx("span",{className:"px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium",children:"Réussi"});case"failed":return e.jsx("span",{className:"px-2 py-1 rounded bg-red-100 text-red-800 text-xs font-medium",children:"Échoué"});case"processing":return e.jsx("span",{className:"px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium",children:"En cours"});case"refunded":return e.jsx("span",{className:"px-2 py-1 rounded bg-purple-100 text-purple-800 text-xs font-medium",children:"Remboursé"});default:return e.jsx("span",{className:"px-2 py-1 rounded bg-yellow-100 text-yellow-800 text-xs font-medium",children:"En attente"})}},T=(Array.isArray(r)?r:[]).filter(F=>!(a!=="all"&&F.mode!==a||o!=="all"&&F.status!==o||c&&!(F.user_email||"").toLowerCase().includes(c.toLowerCase())||d&&Number(F.amount)<Number(d)||m&&Number(F.amount)>Number(m)||f&&new Date(F.created_at)<new Date(f)||y&&new Date(F.created_at)>new Date(y))),q=F=>{_(F),N(!0)},$=F=>{C(F),E(!0)},z=async()=>{if(S)try{S.status==="succeeded"?(await HN(S.payment_intent_id||S.id),k.success("Paiement remboursé avec succès !"),D()):k.info("Ce paiement ne peut pas être remboursé (statut: "+S.status+")"),E(!1),C(null)}catch(F){k.error("Erreur lors du remboursement: "+(F instanceof Error?F.message:String(F)))}},J=()=>{const F=["Date","Client","Email","Réservation","Montant","Devise","Méthode","Status","Mode"],de=T.map(he=>{var Me,Ve;return[he.created_at,((Me=he.booking)==null?void 0:Me.user_name)||"",he.user_email||"",((Ve=he.booking)==null?void 0:Ve.space_name)||"",he.amount,he.currency||"",he.payment_method||"",he.status,he.mode]}),re=[F,...de].map(he=>he.map(Me=>`"${Me??""}"`).join(",")).join(`
`),Pe=new Blob([re],{type:"text/csv;charset=utf-8;"});Df.saveAs(Pe,`paiements_${new Date().toISOString().slice(0,10)}.csv`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des paiements"}),e.jsxs("div",{className:"flex gap-2 items-center mt-2 flex-wrap",children:[e.jsx("span",{children:"Filtrer par mode :"}),e.jsx(P,{variant:a==="all"?"default":"outline",onClick:()=>i("all"),children:"Tous"}),e.jsx(P,{variant:a==="live"?"default":"outline",onClick:()=>i("live"),children:"Production"}),e.jsx(P,{variant:a==="test"?"default":"outline",onClick:()=>i("test"),children:"Test"})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-2 flex-wrap",children:[e.jsx("span",{children:"Filtrer par statut :"}),e.jsx(P,{variant:o==="all"?"default":"outline",onClick:()=>l("all"),children:"Tous"}),e.jsx(P,{variant:o==="succeeded"?"default":"outline",onClick:()=>l("succeeded"),children:"Réussi"}),e.jsx(P,{variant:o==="failed"?"default":"outline",onClick:()=>l("failed"),children:"Échoué"}),e.jsx(P,{variant:o==="processing"?"default":"outline",onClick:()=>l("processing"),children:"En cours"}),e.jsx(P,{variant:o==="refunded"?"default":"outline",onClick:()=>l("refunded"),children:"Remboursé"}),e.jsx(P,{variant:o==="pending"?"default":"outline",onClick:()=>l("pending"),children:"En attente"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[e.jsx(I,{type:"text",placeholder:"Email client",value:c,onChange:F=>u(F.target.value),className:"w-36"}),e.jsx(I,{type:"number",placeholder:"Montant min",value:d,onChange:F=>h(F.target.value),className:"w-28"}),e.jsx(I,{type:"number",placeholder:"Montant max",value:m,onChange:F=>p(F.target.value),className:"w-28"}),e.jsx(I,{type:"date",placeholder:"Date de début",value:f,onChange:F=>v(F.target.value),className:"w-36"}),e.jsx(I,{type:"date",placeholder:"Date de fin",value:y,onChange:F=>j(F.target.value),className:"w-36"}),e.jsx(P,{variant:"outline",onClick:D,disabled:s,children:s?"Chargement...":"Actualiser"}),e.jsx(P,{variant:"secondary",onClick:J,children:"Exporter CSV"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Liste des paiements"}),e.jsx(we,{children:"Suivez tous les paiements du système"})]}),e.jsx(W,{children:s?e.jsx("p",{className:"text-center py-4",children:"Chargement des paiements..."}):T.length===0?e.jsx("p",{className:"text-center py-4",children:"Aucun paiement trouvé."}):e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Client"}),e.jsx(Q,{children:"Email"}),e.jsx(Q,{children:"Réservation"}),e.jsx(Q,{children:"Montant"}),e.jsx(Q,{children:"Devise"}),e.jsx(Q,{children:"Méthode"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Mode"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:T.map(F=>{var de;return e.jsxs(Ee,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:R(F.created_at)})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:((de=F.booking)==null?void 0:de.user_name)||"Inconnu"})]})}),e.jsx(X,{children:F.user_email||""}),e.jsx(X,{children:F.booking?e.jsx("span",{className:"text-sm",children:F.booking.space_name}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx(X,{children:e.jsxs("span",{className:"font-semibold",children:[F.amount," €"]})}),e.jsx(X,{children:F.currency||""}),e.jsx(X,{children:F.payment_method||""}),e.jsx(X,{children:O(F.status)}),e.jsx(X,{children:e.jsx(fe,{color:F.mode==="live"?"green":"yellow",children:F.mode==="live"?"Production":"Test"})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>q(F),children:[e.jsx(nt,{className:"h-4 w-4 mr-1"}),"Voir"]}),F.status==="succeeded"&&e.jsxs(P,{variant:"destructive",size:"sm",onClick:()=>$(F),children:[e.jsx(mr,{className:"h-4 w-4 mr-1"}),"Rembourser"]}),F.invoice_url&&e.jsx("a",{href:F.invoice_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(Eg,{className:"h-4 w-4"})})})]})})]},F.id)})})]})})]}),g&&e.jsx($e,{open:b,onOpenChange:N,children:e.jsxs(ze,{className:"sm:max-w-[600px]",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Détails du paiement"}),e.jsxs(He,{children:["Informations complètes sur le paiement #",(ne=g.id)==null?void 0:ne.slice(0,8)]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"ID:"}),e.jsx("span",{className:"col-span-3 text-sm font-mono",children:g.id})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Date:"}),e.jsx("span",{className:"col-span-3 text-sm",children:R(g.created_at)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Client:"}),e.jsx("span",{className:"col-span-3 text-sm",children:((le=g.booking)==null?void 0:le.user_name)||"Inconnu"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Email:"}),e.jsx("span",{className:"col-span-3 text-sm",children:g.user_email||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Montant:"}),e.jsxs("span",{className:"col-span-3 text-sm font-semibold",children:[g.amount," €"]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Devise:"}),e.jsx("span",{className:"col-span-3 text-sm",children:g.currency||"EUR"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Méthode:"}),e.jsx("span",{className:"col-span-3 text-sm",children:g.payment_method||"Carte"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Statut:"}),e.jsx("span",{className:"col-span-3 text-sm",children:O(g.status)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Mode:"}),e.jsx("span",{className:"col-span-3 text-sm",children:e.jsx(fe,{color:g.mode==="live"?"green":"yellow",children:g.mode==="live"?"Production":"Test"})})]}),g.booking&&e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Réservation:"}),e.jsx("span",{className:"col-span-3 text-sm",children:g.booking.space_name})]}),g.description&&e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Description:"}),e.jsx("span",{className:"col-span-3 text-sm",children:g.description})]})]}),e.jsx(rt,{children:e.jsx(P,{onClick:()=>N(!1),children:"Fermer"})})]})}),S&&e.jsx($e,{open:w,onOpenChange:E,children:e.jsxs(ze,{children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Confirmer le remboursement"}),e.jsxs(He,{children:["Êtes-vous sûr de vouloir rembourser le paiement #",(M=S.id)==null?void 0:M.slice(0,8)," ?",e.jsx("br",{}),e.jsx("strong",{children:"Montant :"})," ",S.amount," €",e.jsx("br",{}),e.jsx("strong",{children:"Attention :"})," Cette action est irréversible et remboursera le client."]})]}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:()=>E(!1),children:"Annuler"}),e.jsx(P,{variant:"destructive",onClick:z,children:"Confirmer le remboursement"})]})]})})]})};function GN(r,t,s=!0){return x.useEffect(()=>{if(s)try{const a=localStorage.getItem(`form-${t}`);if(a){const i=JSON.parse(a);console.log(`🔄 Restauration du formulaire ${t}:`,i),r.reset(i)}}catch(a){console.warn(`Erreur lors de la restauration du formulaire ${t}:`,a)}},[r,t,s]),x.useEffect(()=>{if(!s)return;const a=r.watch(i=>{try{localStorage.setItem(`form-${t}`,JSON.stringify(i)),console.log(`💾 Sauvegarde automatique du formulaire ${t}`)}catch(o){console.warn(`Erreur lors de la sauvegarde du formulaire ${t}:`,o)}});return()=>a.unsubscribe()},[r,t,s]),{clearPersistedData:()=>{if(s)try{localStorage.removeItem(`form-${t}`),console.log(`🗑️ Nettoyage des données persistées pour ${t}`)}catch(a){console.warn(`Erreur lors du nettoyage du formulaire ${t}:`,a)}}}}function KN(){const[r,t]=x.useState(!0),[s,n]=x.useState(!1),[a,i]=x.useState(!1),[o,l]=x.useState(!1),c=yt({defaultValues:{homepage:{title:"",description:"",hero_title:"",hero_subtitle:"",hero_background_image:"",cta_text:"",features_title:"",features_subtitle:"",cta_section_title:"",cta_section_subtitle:"",cta_secondary_button_text:"",is_published:!1},company:{name:"",email:"",phone:"",address:"",website:"",description:"",logo_url:"",siret:"",vat_number:""},stripe:{mode:"test",test_publishable_key:"",test_secret_key:"",webhook_secret:"",live_publishable_key:"",live_secret_key:"",live_webhook_secret:""},google_reviews:{api_key:"",place_id:"",max_reviews:10,min_rating:4}}}),{clearPersistedData:u}=GN(c,"admin-settings",!0),d=x.useCallback(async()=>{var m,p,f,v;try{t(!0),console.log("🔄 Chargement des paramètres...");const y=await B.getCurrentUser();if(y.success&&y.data&&y.data.user&&i(y.data.user.is_admin||!1),o)console.log("📋 Utilisation des données persistées localement");else{console.log("📡 Récupération des paramètres depuis l'API...");const j=await B.get("/admin/settings");if(console.log("📡 Résultat settings:",j),j.success&&Array.isArray(j.data)){console.log("✅ Données reçues:",j.data);const g=((m=j.data.find(E=>E.key==="homepage"))==null?void 0:m.value)||{},_=((p=j.data.find(E=>E.key==="company"))==null?void 0:p.value)||{},b=((f=j.data.find(E=>E.key==="stripe"))==null?void 0:f.value)||{},N=((v=j.data.find(E=>E.key==="google_reviews"))==null?void 0:v.value)||{};console.log("🏠 Données homepage:",g),console.log("🏢 Données company:",_);const w={homepage:{title:g.title||"",description:g.description||"",hero_title:g.hero_title||"",hero_subtitle:g.hero_subtitle||"",hero_background_image:g.hero_background_image||"",cta_text:g.cta_text||"",features_title:g.features_title||"",features_subtitle:g.features_subtitle||"",cta_section_title:g.cta_section_title||"",cta_section_subtitle:g.cta_section_subtitle||"",cta_secondary_button_text:g.cta_secondary_button_text||"",is_published:g.is_published||!1},company:{name:_.name||"",email:_.email||"",phone:_.phone||"",address:_.address||"",website:_.website||"",description:_.description||"",logo_url:_.logo_url||"",siret:_.siret||"",vat_number:_.vat_number||""},stripe:{mode:b.mode||"test",test_publishable_key:b.test_publishable_key||"",test_secret_key:b.test_secret_key||"",webhook_secret:b.webhook_secret||"",live_publishable_key:b.live_publishable_key||"",live_secret_key:b.live_secret_key||"",live_webhook_secret:b.live_webhook_secret||""},google_reviews:{api_key:N.api_key||"",place_id:N.place_id||"",max_reviews:N.max_reviews||10,min_rating:N.min_rating||4}};console.log("📝 Données du formulaire:",w),c.reset(w),l(!0)}}}catch(y){console.error("Erreur lors du chargement des paramètres:",y),k.error("Impossible de charger les paramètres")}finally{t(!1)}},[o,u]);return{form:c,isLoading:r,isSaving:s,isAdmin:a,loadSettings:d,saveSettings:async m=>{try{n(!0);const p=[{key:"homepage",value:m.homepage},{key:"company",value:m.company},{key:"stripe",value:m.stripe},{key:"google_reviews",value:m.google_reviews}];if(console.log("[ADMIN_SETTINGS UPSERT]",p),m.homepage){const v=await B.post("/homepage-settings",m.homepage);if(!v.success)throw console.error("[HOMEPAGE_SETTINGS SAVE ERROR]",v.error),new Error(v.error||"Erreur lors de la sauvegarde des paramètres homepage");console.log("✅ Paramètres homepage sauvegardés:",v.data)}if(m.company){const v=await B.post("/company-settings",m.company);if(!v.success)throw console.error("[COMPANY_SETTINGS SAVE ERROR]",v.error),new Error(v.error||"Erreur lors de la sauvegarde des paramètres company");console.log("✅ Paramètres company sauvegardés:",v.data)}const f=p.filter(v=>v.key!=="homepage"&&v.key!=="company");for(const v of f){const y=await B.post("/admin/settings",{key:v.key,value:v.value});if(!y.success)throw console.error("[ADMIN_SETTINGS SAVE ERROR]",y.error),new Error(y.error||"Erreur lors de la sauvegarde")}k.success("Paramètres enregistrés avec succès"),u()}catch(p){console.error("Erreur lors de la sauvegarde des paramètres:",p),k.error("Erreur lors de l'enregistrement des paramètres")}finally{n(!1)}}}}function YN({onImageUploaded:r}){const[t,s]=x.useState(null),[n,a]=x.useState(""),[i,o]=x.useState(!1),l=h=>new Promise((m,p)=>{const f=new FileReader;f.onload=v=>{var b,N;const y=(b=v.target)==null?void 0:b.result,j=(N=h.name.split(".").pop())==null?void 0:N.toLowerCase();let g="image/jpeg";switch(j){case"png":g="image/png";break;case"jpg":case"jpeg":g="image/jpeg";break;case"webp":g="image/webp";break;case"gif":g="image/gif";break}console.log("🔄 Reconstruction du fichier carrousel:",{originalName:h.name,originalType:h.type,newType:g,size:y.byteLength});const _=new File([y],h.name,{type:g,lastModified:Date.now()});m(_)},f.onerror=()=>p(new Error("Erreur lecture fichier")),f.readAsArrayBuffer(h)}),c=async h=>{try{console.log("📁 Upload carrousel - Fichier original:",{name:h.name,size:h.size,type:h.type});const m=await l(h);return console.log("📁 Upload carrousel - Fichier reconstruit:",{name:m.name,size:m.size,type:m.type}),new Promise((p,f)=>{const v=new FileReader;v.onload=y=>{var g;const j=(g=y.target)==null?void 0:g.result;j?(console.log("🔗 URL carrousel générée (base64):",j.substring(0,50)+"..."),p(j)):f(new Error("Impossible de lire le fichier"))},v.onerror=()=>{f(new Error("Erreur lors de la lecture du fichier"))},v.readAsDataURL(m)})}catch(m){throw console.error("❌ Erreur upload carrousel complète:",m),m}},u=h=>{var p,f;const m=(p=h.target.files)==null?void 0:p[0];if(m){console.log("🔍 Fichier carrousel sélectionné:",m);const v=(f=m.name.split(".").pop())==null?void 0:f.toLowerCase();if(!["jpg","jpeg","png","webp","gif"].includes(v||"")){k.error("Extension de fichier non supportée");return}if(m.size>5*1024*1024){k.error("L'image doit faire moins de 5MB");return}s(m);const j=new FileReader;j.onload=g=>{var _;a((_=g.target)==null?void 0:_.result)},j.readAsDataURL(m)}},d=async()=>{if(t)try{o(!0);const h=await c(t);await r(h),s(null),a("");const m=document.getElementById("carousel-image-upload");m&&(m.value=""),k.success("Image ajoutée au carrousel !")}catch(h){console.error("❌ Erreur ajout image carrousel:",h),k.error("Erreur lors de l'ajout de l'image")}finally{o(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.webp,.gif",onChange:u,className:"hidden",id:"carousel-image-upload"}),e.jsxs("label",{htmlFor:"carousel-image-upload",className:"cursor-pointer inline-flex items-center gap-2 px-4 py-2 bg-secondary text-secondary-foreground hover:bg-secondary/80 rounded-md",children:[e.jsx(Rr,{className:"h-4 w-4"}),"Sélectionner une image"]}),n&&e.jsxs(P,{onClick:d,disabled:i,children:[i&&e.jsx(je,{className:"mr-2 h-4 w-4 animate-spin"}),"Ajouter au carrousel"]})]}),n&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:n,alt:"Aperçu",className:"max-w-xs rounded-md"})})]})}function VN({images:r,onReorder:t,onDelete:s}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map((n,a)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:n.image_url,alt:`Carousel image ${a+1}`,className:"w-full h-48 object-cover rounded-md"}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx(P,{variant:"destructive",size:"icon",onClick:()=>s(n.id),children:e.jsx(mr,{className:"h-4 w-4"})}),e.jsx(P,{variant:"secondary",size:"icon",onClick:()=>t(n.id,"up"),disabled:a===0,children:e.jsx(Vg,{className:"h-4 w-4"})}),e.jsx(P,{variant:"secondary",size:"icon",onClick:()=>t(n.id,"down"),disabled:a===r.length-1,children:e.jsx(Kg,{className:"h-4 w-4"})})]})]},n.id))})}function XN(){const r=vg(),{data:t=[],isLoading:s,refetch:n}=Ag({queryKey:["carousel-images"],queryFn:async()=>{console.log("🔄 Chargement des images du carrousel...");const l=await B.get("/carousel-images");return l.success&&l.data?(console.log("✅ Images chargées:",l.data.length),l.data):(console.log("📝 Aucune image trouvée, utilisation d'une liste vide"),[])},staleTime:5*60*1e3}),a=async l=>{try{console.log("🔄 Ajout d'une nouvelle image:",l);const c=await B.post("/carousel-images",{image_url:l,display_order:t.length});if(c.success)console.log("✅ Image ajoutée à la DB"),k.success("Image ajoutée avec succès"),await r.invalidateQueries({queryKey:["carousel-images"]}),console.log("✅ Cache React Query invalidé");else throw new Error(c.error||"Erreur lors de l'ajout")}catch(c){console.error("❌ Erreur lors de l'ajout de l'image:",c),k.error("Impossible d'ajouter l'image")}},i=async l=>{try{console.log("🗑️ Suppression de l'image:",l);const c=await B.delete(`/carousel-images/${l}`);if(c.success)console.log("✅ Image supprimée de la DB"),k.success("Image supprimée avec succès"),await r.invalidateQueries({queryKey:["carousel-images"]}),console.log("✅ Cache React Query invalidé");else throw new Error(c.error||"Erreur lors de la suppression")}catch(c){console.error("❌ Erreur lors de la suppression:",c),k.error("Impossible de supprimer l'image")}},o=async(l,c)=>{const u=t.findIndex(m=>m.id===l);if(c==="up"&&u===0||c==="down"&&u===t.length-1)return;const d=[...t],h=c==="up"?u-1:u+1;try{console.log("🔄 Réorganisation des images...");const[m]=d.splice(u,1);d.splice(h,0,m);const p=d.map((v,y)=>({id:v.id,display_order:y,image_url:v.image_url})),f=await B.put("/carousel-images/reorder",{images:p});if(!f.success)throw new Error(f.error||"Erreur lors de la mise à jour");console.log("✅ Ordre mis à jour dans la DB"),await r.invalidateQueries({queryKey:["carousel-images"]}),console.log("✅ Cache React Query invalidé")}catch(m){console.error("❌ Erreur lors de la réorganisation:",m),k.error("Impossible de réorganiser les images")}};return s?e.jsx("div",{children:"Chargement des images..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(YN,{onImageUploaded:a}),e.jsx(VN,{images:t,onReorder:o,onDelete:i})]})}function QN({control:r}){return e.jsx(Z,{control:r,name:"max_reviews",render:({field:{value:t,onChange:s}})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nombre maximum d'avis à afficher"}),e.jsx(Y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(xn,{min:1,max:100,step:1,value:[t],onValueChange:n=>s(n[0])}),e.jsxs("div",{className:"text-center font-medium",children:[t," avis"]})]})}),e.jsx(ee,{})]})})}function JN({control:r}){return e.jsx(Z,{control:r,name:"min_rating",render:({field:{value:t,onChange:s}})=>e.jsxs(G,{children:[e.jsx(H,{children:"Note minimale requise"}),e.jsx(Y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(xn,{min:1,max:5,step:1,value:[t],onValueChange:n=>s(n[0])}),e.jsxs("div",{className:"text-center font-medium",children:[t," ",t===1?"étoile":"étoiles"]})]})}),e.jsx(ee,{})]})})}function ZN({control:r}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(QN,{control:r}),e.jsx(JN,{control:r})]})}const e1=ct({api_key:me().min(1,"La clé API est requise"),place_id:me().min(1,"L'ID du lieu est requis")});function r1(){const{toast:r}=Lp(),t=yt({resolver:It(e1),defaultValues:{api_key:"",place_id:""}}),s=async n=>{try{const{error:a}=await tt.from("google_api_keys").upsert({api_key:n.api_key,place_id:n.place_id});if(a)throw a;r({title:"Succès",description:"Les clés API ont été enregistrées avec succès."})}catch(a){console.error("Erreur lors de l'enregistrement des clés:",a),r({title:"Erreur",description:"Une erreur est survenue lors de l'enregistrement des clés.",variant:"destructive"})}};return e.jsx(Ot,{...t,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{control:t.control,name:"api_key",render:({field:n})=>e.jsxs(G,{children:[e.jsx(H,{children:"Clé API Google"}),e.jsx(Y,{children:e.jsx(I,{type:"password",placeholder:"Entrez votre clé API Google",...n})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:t.control,name:"place_id",render:({field:n})=>e.jsxs(G,{children:[e.jsx(H,{children:"ID du lieu Google"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Entrez l'ID de votre lieu Google",...n})}),e.jsx(ee,{})]})}),e.jsx(P,{type:"button",onClick:t.handleSubmit(s),children:"Enregistrer les clés"})]})})}const t1=ct({api_key:me().min(1,"La clé API est requise"),place_id:me().min(1,"L'ID du lieu est requis"),max_reviews:ar().min(1).max(100),min_rating:ar().min(1).max(5)});function s1(){return{form:yt({resolver:It(t1),defaultValues:{api_key:"",place_id:"",max_reviews:10,min_rating:4}})}}function n1({isDisabled:r}){const{form:t}=s1(),[s,n]=vn("google-reviews","keys");return e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Connexion à Google Avis"}),e.jsx(we,{children:"Configurez la connexion à l'API Google My Business pour afficher les avis clients"})]}),e.jsx(W,{children:e.jsxs(kr,{value:s,onValueChange:n,className:"w-full",children:[e.jsxs(Dr,{className:"grid w-full grid-cols-2",children:[e.jsx(ce,{value:"keys",children:"Clés API"}),e.jsx(ce,{value:"settings",children:"Paramètres"})]}),e.jsx(ge,{value:"keys",className:"mt-4",children:e.jsx(r1,{})}),e.jsx(ge,{value:"settings",className:"mt-4",children:e.jsx(ZN,{control:t.control})})]})})]})}const Vs=[{id:"vps-postgresql",name:"VPS PostgreSQL (Production)",type:"postgresql",host:"147.93.58.155",port:5432,database:"coworkmy",username:"vpshostinger",password:"Fethi@2025!",ssl:!1},{id:"supabase",name:"Supabase (Cloud)",type:"supabase",url:"https://exffryodynkyizbeesbt.supabase.co",database:"postgres",username:"postgres",password:""},{id:"o2switch",name:"O2Switch PostgreSQL",type:"postgresql",host:"109.234.166.71",port:5432,database:"sc2rafi0640_coworkmy",username:"sc2rafi0640_rafi0640",password:"Hla2025Cowork*",ssl:!1},{id:"mysql-local",name:"MySQL Local",type:"mysql",host:"localhost",port:3306,database:"coworkmy",username:"root",password:"",ssl:!1},{id:"mysql-production",name:"MySQL Production",type:"mysql",host:"localhost",port:parseInt("3306"),database:"coworkmy",username:"root",password:"",ssl:!1}],a1=()=>{const r=localStorage.getItem("selected_database")||"vps-postgresql",t=Vs.find(s=>s.id===r);return t||Vs.find(s=>s.id==="vps-postgresql")||Vs[0]},i1=r=>{localStorage.setItem("selected_database",r)},o1=()=>{const[r,t]=x.useState(a1().id);return x.useEffect(()=>{i1(r)},[r]),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Configuration de la base de données"}),e.jsx(we,{children:"Sélectionnez la base de données à utiliser pour l'application"})]}),e.jsxs(W,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"db-select",children:"Base de données actuelle"}),e.jsxs(Nr,{value:r,onValueChange:t,children:[e.jsx(Er,{children:e.jsx(Cr,{placeholder:"Sélectionner une base de données"})}),e.jsx(Tr,{children:Vs.map(s=>e.jsx(pe,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs(Ge,{children:[e.jsx(Zs,{className:"h-4 w-4"}),e.jsx(Ke,{children:"Le changement de base de données sera appliqué au prochain rechargement de l'application. Redémarrez l'application pour que les modifications prennent effet."})]})]})]})};function l1({isDisabled:r}){return r?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 flex items-start gap-2",children:[e.jsx(Zs,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-yellow-700",children:[e.jsx("p",{className:"font-medium",children:"Mode lecture seule"}),e.jsx("p",{children:"Vous pouvez visualiser les paramètres, mais vous n'avez pas les droits nécessaires pour les modifier."})]})]}):null}function c1({form:r,isDisabled:t}){return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Paramètres généraux"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configurez les informations générales de votre espace de coworking."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:e.jsx(Z,{control:r.control,name:"homepage.title",render:({field:s})=>{const n="homepage_title";return e.jsxs(G,{children:[e.jsx(H,{htmlFor:n,children:"Titre de la page d'accueil"}),e.jsx(Y,{children:e.jsx(I,{id:n,...s,value:s.value??"",placeholder:"Bienvenue sur Co Work My",disabled:t})}),e.jsx(Ie,{children:"Ce titre apparaîtra sur la page d'accueil du site."}),e.jsx(ee,{})]})}})})]})}function rg(r){const[t,s]=x.useState(!1),[n,a]=x.useState(r.value||""),i=async o=>{var c;const l=(c=o.target.files)==null?void 0:c[0];if(l){if(l.size>5*1024*1024){k.error("L'image ne doit pas dépasser 5MB");return}s(!0);try{const u=new FileReader;u.onload=d=>{var m;const h=(m=d.target)==null?void 0:m.result;h&&(a(h),r.onChange(h),k.success("Image sélectionnée avec succès"))},u.onerror=()=>{k.error("Erreur lors de la lecture de l'image"),s(!1)},u.readAsDataURL(l)}catch(u){console.error("Erreur upload image:",u),k.error("Erreur lors de l'upload de l'image")}finally{s(!1)}}};return e.jsxs("div",{children:[e.jsx("input",{id:r.id,type:"file",accept:"image/*",disabled:r.disabled||t,onChange:i}),n&&e.jsx("img",{src:n,alt:"Aperçu",className:"mt-2 max-h-32 rounded"}),t&&e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Upload en cours..."})]})}function u1({form:r,isDisabled:t}){const s=x.useId(),n=x.useId(),a=x.useId(),i=x.useId(),o=x.useId(),l=x.useId(),c=x.useId(),u=x.useId(),d=x.useId(),h=x.useId(),m=x.useId(),p=x.useId();return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Page d'accueil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Personnalisez le contenu de la page d'accueil."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{control:r.control,name:"homepage.title",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:s,children:"Titre de la page"}),e.jsx(Y,{children:e.jsx(I,{id:s,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.description",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:n,children:"Description"}),e.jsx(Y,{children:e.jsx(_e,{id:n,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.hero_title",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:a,children:"Titre principal"}),e.jsx(Y,{children:e.jsx(I,{id:a,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.hero_subtitle",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:i,children:"Sous-titre principal"}),e.jsx(Y,{children:e.jsx(_e,{id:i,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.hero_background_image",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:o,children:"Image d'arrière-plan"}),e.jsx(Y,{children:e.jsx(rg,{id:o,value:f.value??"",onChange:f.onChange,label:"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.cta_text",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:l,children:"Texte du CTA"}),e.jsx(Y,{children:e.jsx(I,{id:l,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.features_title",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:c,children:"Titre des fonctionnalités"}),e.jsx(Y,{children:e.jsx(I,{id:c,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.features_subtitle",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:u,children:"Sous-titre des fonctionnalités"}),e.jsx(Y,{children:e.jsx(_e,{id:u,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.cta_section_title",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:d,children:"Titre de la section CTA"}),e.jsx(Y,{children:e.jsx(I,{id:d,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.cta_section_subtitle",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:h,children:"Sous-titre de la section CTA"}),e.jsx(Y,{children:e.jsx(_e,{id:h,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.cta_secondary_button_text",render:({field:f})=>e.jsxs(G,{children:[e.jsx(H,{htmlFor:m,children:"Texte du bouton secondaire"}),e.jsx(Y,{children:e.jsx(I,{id:m,...f,autoComplete:"off",value:f.value??"",disabled:t})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"homepage.is_published",render:({field:f})=>e.jsxs(G,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(H,{htmlFor:p,className:"text-base",children:"Publication"}),e.jsx(Ie,{children:"Publier les modifications sur la page d'accueil"})]}),e.jsx(Y,{children:e.jsx(Nt,{id:p,checked:f.value,onCheckedChange:f.onChange,disabled:t})})]})})]})]})}function d1({form:r,isDisabled:t}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Informations de l'entreprise"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configurez les informations de votre entreprise qui apparaîtront dans le footer et sur le site."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Z,{control:r.control,name:"company.name",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nom de l'entreprise"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"Votre Entreprise",disabled:t})}),e.jsx(Ie,{children:"Le nom de votre entreprise qui apparaîtra dans le footer."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.email",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Email de contact"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"contact@votre-entreprise.com",disabled:t})}),e.jsx(Ie,{children:"Email de contact affiché dans le footer."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.phone",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Téléphone"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"+33 1 23 45 67 89",disabled:t})}),e.jsx(Ie,{children:"Numéro de téléphone affiché dans le footer."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.address",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Adresse"}),e.jsx(Y,{children:e.jsx(_e,{...s,value:s.value||"",placeholder:`123 Rue de la Paix
75001 Paris, France`,disabled:t,rows:3})}),e.jsx(Ie,{children:"Adresse complète de votre entreprise."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.website",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Site web"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"https://www.votre-entreprise.com",disabled:t})}),e.jsx(Ie,{children:"URL de votre site web principal."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.description",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Description de l'entreprise"}),e.jsx(Y,{children:e.jsx(_e,{...s,value:s.value||"",placeholder:"Une brève description de votre entreprise...",disabled:t,rows:4})}),e.jsx(Ie,{children:"Description courte de votre entreprise."}),e.jsx(ee,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium",children:"Logo de l'entreprise"}),e.jsx(Z,{control:r.control,name:"company.logo_url",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Logo"}),e.jsx(Y,{children:e.jsx(rg,{id:"company-logo",value:s.value||"",onChange:s.onChange,label:"Télécharger le logo de l'entreprise",disabled:t})}),e.jsx(Ie,{children:"Logo de votre entreprise qui apparaîtra dans le footer et sur le site."}),e.jsx(ee,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium",children:"Informations légales"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Z,{control:r.control,name:"company.siret",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"SIRET"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"12345678901234",disabled:t})}),e.jsx(Ie,{children:"Numéro SIRET de votre entreprise."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"company.vat_number",render:({field:s})=>e.jsxs(G,{children:[e.jsx(H,{children:"Numéro de TVA"}),e.jsx(Y,{children:e.jsx(I,{...s,value:s.value||"",placeholder:"FR12345678901",disabled:t})}),e.jsx(Ie,{children:"Numéro de TVA intracommunautaire."}),e.jsx(ee,{})]})})]})]})]})}function m1({form:r,onSubmit:t,isSaving:s,isDisabled:n=!1}){const[a,i]=vn("settings","general");return e.jsxs(kr,{value:a,onValueChange:i,children:[e.jsxs(Dr,{className:"mb-6",children:[e.jsx(ce,{value:"general",children:"Général"}),e.jsx(ce,{value:"homepage",children:"Page d'accueil"}),e.jsx(ce,{value:"company",children:"Entreprise"}),e.jsx(ce,{value:"carousel",children:"Carrousel"}),e.jsx(ce,{value:"google-reviews",children:"Avis Google"}),e.jsx(ce,{value:"database",children:"Base de données"})]}),e.jsx(Ot,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(t),className:"space-y-8",children:[e.jsx(l1,{isDisabled:n}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{value:"carousel",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Images du carrousel"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gérez les images qui apparaissent dans le carrousel de la page d'accueil."})]}),e.jsx(XN,{})]}),e.jsx(ge,{value:"general",children:e.jsx(c1,{form:r,isDisabled:n})}),e.jsx(ge,{value:"homepage",children:e.jsx(u1,{form:r,isDisabled:n})}),e.jsx(ge,{value:"company",children:e.jsx(d1,{form:r,isDisabled:n})}),e.jsx(ge,{value:"google-reviews",children:e.jsx(n1,{isDisabled:n})}),e.jsx(ge,{value:"database",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Configuration de la base de données"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Gérez vos bases de données et migrez vos données entre Supabase, O2Switch et MySQL."}),e.jsx(o1,{})]})})]}),e.jsx(P,{type:"submit",disabled:s||n,className:"mt-4 px-6 w-full sm:w-auto",children:s?"Enregistrement...":"Enregistrer les modifications"}),n&&e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:"Contactez un administrateur pour obtenir les droits nécessaires."})]})})]})}const h1=()=>{const{form:r,isLoading:t,isSaving:s,isAdmin:n,loadSettings:a,saveSettings:i}=KN();return x.useEffect(()=>{a()},[a]),t?e.jsx("div",{className:"flex items-center justify-center p-4",children:"Chargement des paramètres..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Paramètres de l'administration"})]}),n&&e.jsxs(fe,{variant:"outline",className:"flex items-center gap-1 bg-green-50 text-green-700 border-green-200 px-3 py-1",children:[e.jsx(ox,{className:"h-4 w-4"}),"Administrateur"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Paramètres généraux"}),e.jsx(we,{children:"Configuration de la plateforme"})]}),e.jsx(W,{children:e.jsx(m1,{form:r,onSubmit:i,isSaving:s,isDisabled:!1})})]})}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Aide"}),e.jsx(we,{children:"Guide de configuration"})]}),e.jsxs(W,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Les paramètres définis ici seront utilisés dans toute l'application. Assurez-vous que les informations sont correctes car elles seront visibles par les utilisateurs."}),n&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded-md text-sm text-blue-700 border border-blue-100",children:[e.jsx("p",{className:"font-medium",children:"Statut Administrateur"}),e.jsx("p",{className:"mt-1",children:"Vous disposez de tous les droits nécessaires pour modifier les paramètres du site."})]})]}),e.jsx(Pp,{children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Dernière mise à jour : ",new Date().toLocaleDateString()]})})]})})]})]})},p1=ct({id:me().optional(),label:me().min(2,"Le libellé doit comporter au moins 2 caractères"),start_time:me().min(1,"L'heure de début est requise"),end_time:me().min(1,"L'heure de fin est requise"),space_id:me().optional(),display_order:ar().optional()});function f1({timeSlot:r,isEditing:t,onSubmit:s,onCancel:n}){const a=yt({resolver:It(p1),defaultValues:{id:(r==null?void 0:r.id)||void 0,label:(r==null?void 0:r.label)||"",start_time:(r==null?void 0:r.start_time)||"",end_time:(r==null?void 0:r.end_time)||"",display_order:(r==null?void 0:r.display_order)||void 0}}),i=o=>{o==="morning"?(a.setValue("label","Matin (9h-13h)"),a.setValue("start_time","09:00"),a.setValue("end_time","13:00")):o==="afternoon"?(a.setValue("label","Après-midi (14h-18h)"),a.setValue("start_time","14:00"),a.setValue("end_time","18:00")):o==="full"&&(a.setValue("label","Journée complète (9h-18h)"),a.setValue("start_time","09:00"),a.setValue("end_time","18:00"))};return e.jsx(Ot,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(s),className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(P,{type:"button",variant:"secondary",onClick:()=>i("morning"),children:"Matin"}),e.jsx(P,{type:"button",variant:"secondary",onClick:()=>i("afternoon"),children:"Après-midi"}),e.jsx(P,{type:"button",variant:"secondary",onClick:()=>i("full"),children:"Journée entière"})]}),e.jsx(Z,{control:a.control,name:"label",render:({field:o})=>e.jsxs(G,{children:[e.jsx(H,{children:"Libellé"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"ex: Journée complète (9h-18h)",...o})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:a.control,name:"start_time",render:({field:o})=>e.jsxs(G,{children:[e.jsx(H,{children:"Heure de début"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"ex: 09:00",...o})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:a.control,name:"end_time",render:({field:o})=>e.jsxs(G,{children:[e.jsx(H,{children:"Heure de fin"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"ex: 18:00",...o})}),e.jsx(ee,{})]})}),e.jsxs(rt,{children:[e.jsx(P,{type:"button",variant:"outline",onClick:n,children:"Annuler"}),e.jsx(P,{type:"submit",children:t?"Mettre à jour":"Ajouter"})]})]})})}async function v1(){try{const r=await B.get("/time-slots");return r.success&&r.data?r.data:(console.error("Error fetching time slots:",r.error),k.error("Impossible de récupérer les créneaux horaires"),[])}catch(r){return console.error("Error fetching time slots:",r),k.error("Impossible de récupérer les créneaux horaires"),[]}}async function g1(r){try{const t=await B.post("/time-slots",r);return t.success&&t.data?t.data:(console.error("Error creating time slot:",t.error),k.error("Impossible de créer le créneau horaire"),null)}catch(t){return console.error("Error creating time slot:",t),k.error("Impossible de créer le créneau horaire"),null}}async function Kt(r,t){try{const s=await B.put(`/time-slots/${r}`,t);return s.success&&s.data?s.data:(console.error("Error updating time slot:",s.error),k.error("Impossible de mettre à jour le créneau horaire"),null)}catch(s){return console.error("Error updating time slot:",s),k.error("Impossible de mettre à jour le créneau horaire"),null}}async function x1(r){try{const t=await B.delete(`/time-slots/${r}`);return t.success?!0:(console.error("Error deleting time slot:",t.error),k.error("Impossible de supprimer le créneau horaire"),!1)}catch(t){return console.error("Error deleting time slot:",t),k.error("Impossible de supprimer le créneau horaire"),!1}}function _p(r,t){const[s,n]=r.split(":").map(Number),[a,i]=t.split(":").map(Number);let o=a*60+i-(s*60+n);return o<0&&(o+=24*60),o}function y1(){const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(!1),[c,u]=x.useState(void 0),d=async()=>{n(!0);const g=await v1();t(g),n(!1)};return x.useEffect(()=>{d()},[]),{timeSlots:r,loading:s,dialogOpen:a,isEditing:o,currentTimeSlot:c,setDialogOpen:i,handleSubmit:async g=>{if(o&&g.id)await Kt(g.id,{label:g.label,start_time:g.start_time,end_time:g.end_time,duration:_p(g.start_time,g.end_time)})&&(k.success("Créneau horaire mis à jour avec succès"),i(!1),d());else{const _=r.length>0?Math.max(...r.map(w=>w.display_order))+1:1,b={label:g.label,start_time:g.start_time,end_time:g.end_time,duration:_p(g.start_time,g.end_time),display_order:_,is_available:!0,price:0};g.space_id&&g.space_id!==""&&(b.space_id=g.space_id),await g1(b)&&(k.success("Créneau horaire créé avec succès"),i(!1),d())}},handleEdit:g=>{u(g),l(!0),i(!0)},handleAddNew:()=>{u(void 0),l(!1),i(!0)},handleDelete:async g=>{window.confirm("Êtes-vous sûr de vouloir supprimer ce créneau horaire ?")&&await x1(g)&&(k.success("Créneau horaire supprimé avec succès"),d())},handleMoveUp:async g=>{const _=r.findIndex(b=>b.id===g);if(_>0){const b=r[_],N=r[_-1],w=await Kt(b.id,{display_order:N.display_order}),E=await Kt(N.id,{display_order:b.display_order});w&&E&&d()}},handleMoveDown:async g=>{const _=r.findIndex(b=>b.id===g);if(_<r.length-1){const b=r[_],N=r[_+1],w=await Kt(b.id,{display_order:N.display_order}),E=await Kt(N.id,{display_order:b.display_order});w&&E&&d()}},handleCloseDialog:()=>{i(!1),u(void 0),l(!1)}}}const b1=()=>{const{timeSlots:r,loading:t,dialogOpen:s,isEditing:n,currentTimeSlot:a,handleSubmit:i,handleEdit:o,handleAddNew:l,handleDelete:c,handleMoveUp:u,handleMoveDown:d,handleCloseDialog:h}=y1(),p={...{id:"",start_time:"",end_time:"",is_available:!0,price:0,space_id:"",label:"",display_order:0,created_at:"",updated_at:""},...a};return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx(V,{children:"Créneaux horaires"}),e.jsxs(P,{onClick:l,size:"sm",children:[e.jsx(Rr,{className:"mr-2 h-4 w-4"}),"Ajouter un créneau"]})]}),e.jsx(W,{children:t?e.jsx("div",{className:"text-center py-4",children:"Chargement..."}):r.length===0?e.jsx("div",{className:"text-center py-4",children:"Aucun créneau horaire défini"}):e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Libellé"}),e.jsx(Q,{children:"Début"}),e.jsx(Q,{children:"Fin"}),e.jsx(Q,{children:"Durée"}),e.jsx(Q,{children:"Ordre"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:r.sort((f,v)=>f.display_order-v.display_order).map(f=>e.jsxs(Ee,{children:[e.jsx(X,{children:f.label}),e.jsx(X,{children:f.start_time}),e.jsx(X,{children:f.end_time}),e.jsxs(X,{children:[f.duration," min"]}),e.jsx(X,{children:f.display_order}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(P,{variant:"outline",size:"icon",onClick:()=>u(f.id),children:e.jsx(Xg,{className:"h-4 w-4"})}),e.jsx(P,{variant:"outline",size:"icon",onClick:()=>d(f.id),children:e.jsx(Yg,{className:"h-4 w-4"})}),e.jsx(P,{variant:"outline",size:"icon",onClick:()=>o(f),children:e.jsx(xt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"outline",size:"icon",onClick:()=>c(f.id),children:e.jsx(Jl,{className:"h-4 w-4"})})]})})]},f.id))})]})})]}),e.jsx($e,{open:s,onOpenChange:h,children:e.jsxs(ze,{children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:n?"Modifier le créneau horaire":"Ajouter un créneau horaire"}),e.jsx(He,{children:n?"Modifiez les informations du créneau horaire.":"Ajoutez un nouveau créneau horaire pour la réservation d'espaces."})]}),e.jsx(f1,{timeSlot:p,isEditing:n,onSubmit:i,onCancel:h})]})})]})},j1=ct({type:me().min(1,"Le type est requis"),name:me().min(1,"Le nom est requis"),subject:me().min(1,"Le sujet est requis"),content:me().min(1,"Le contenu est requis")}),tg=({mode:r="create",initialValues:t,onSuccess:s,onCancel:n})=>{const[a,i]=x.useState(!1),o=yt({resolver:It(j1),defaultValues:{type:(t==null?void 0:t.type)||"",name:(t==null?void 0:t.name)||"",subject:(t==null?void 0:t.subject)||"",content:(t==null?void 0:t.content)||""}});x.useEffect(()=>{t&&o.reset({type:t.type,name:t.name,subject:t.subject,content:t.content})},[t,o]);const l=async u=>{i(!0);try{if(r==="edit"&&(t!=null&&t.id)){const d=await B.put(`/email-templates/${t.id}`,{type:u.type,name:u.name,subject:u.subject,content:u.content});if(!d.success)throw new Error(d.message||"Erreur lors de la modification");k.success("Modèle d'email modifié avec succès")}else{if(r==="create"){const h=await B.get("/email-templates");if(h.success&&Array.isArray(h.data)&&h.data.find(p=>p.type===u.type)){k.error("Un modèle avec ce type existe déjà. Modifiez-le ou choisissez un autre type."),i(!1);return}}const d=await B.post("/email-templates",{type:u.type,name:u.name,subject:u.subject,content:u.content});if(!d.success)throw new Error(d.message||"Erreur lors de la création");k.success(r==="duplicate"?"Modèle d'email dupliqué avec succès":"Modèle d'email créé avec succès")}s&&s(),r==="create"&&o.reset()}catch(d){console.error("Erreur lors de l'opération:",d),k.error("Erreur lors de l'opération")}finally{i(!1)}},c=()=>{switch(r){case"edit":return a?"Modification...":"Modifier le modèle";case"duplicate":return a?"Duplication...":"Dupliquer le modèle";default:return a?"Création...":"Créer le modèle"}};return e.jsx(Ot,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(l),className:"space-y-4",children:[e.jsx(Z,{control:o.control,name:"type",render:({field:u})=>e.jsxs(G,{children:[e.jsx(H,{children:"Type du modèle"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Ex: booking_confirmation, welcome_email...",...u,disabled:r==="edit"})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:o.control,name:"name",render:({field:u})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nom du modèle"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Ex: Newsletter mensuelle",...u})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:o.control,name:"subject",render:({field:u})=>e.jsxs(G,{children:[e.jsx(H,{children:"Sujet"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"Sujet de l'email",...u})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:o.control,name:"content",render:({field:u})=>e.jsxs(G,{children:[e.jsx(H,{children:"Contenu HTML"}),e.jsx(Y,{children:e.jsx(_e,{placeholder:"<h1>Titre</h1><p>Contenu de l'email...</p>",className:"min-h-[200px] font-mono",...u})}),e.jsx(ee,{})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{type:"submit",disabled:a,children:c()}),n&&e.jsx(P,{type:"button",variant:"outline",onClick:n,children:"Annuler"})]})]})})},w1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("edit"),d=async()=>{try{const y=await B.get("/email-templates");y.success&&y.data?t(y.data):(console.error("Erreur lors de la récupération des modèles:",y.error),k.error("Erreur lors de la récupération des modèles"),t([]))}catch(y){console.error("Erreur lors de la récupération des modèles:",y),k.error("Erreur lors de la récupération des modèles"),t([])}finally{n(!1)}};x.useEffect(()=>{d()},[]);const h=async y=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce modèle ?"))try{const j=await B.delete(`/email-templates/${y}`);if(!j.success)throw new Error(j.message||"Erreur lors de la suppression");k.success("Modèle supprimé avec succès"),d()}catch(j){console.error("Erreur lors de la suppression:",j),k.error("Erreur lors de la suppression du modèle")}},m=y=>{l(y),u("edit"),i(!0)},p=y=>{l(y),u("duplicate"),i(!0)},f=()=>{i(!1),l(null)},v=()=>{d(),f()};return s?e.jsx("div",{children:"Chargement des modèles..."}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Modèles d'emails"}),e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Nom"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Sujet"}),e.jsx(Q,{children:"Date de création"}),e.jsx(Q,{children:"Actions"})]})}),e.jsx(Ir,{children:r.map(y=>e.jsxs(Ee,{children:[e.jsx(X,{children:y.name}),e.jsx(X,{className:"font-mono text-sm",children:y.type}),e.jsx(X,{children:y.subject}),e.jsx(X,{children:new Date(y.created_at).toLocaleString()}),e.jsx(X,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>m(y),children:"Modifier"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>p(y),children:"Dupliquer"}),e.jsx(P,{variant:"destructive",size:"sm",onClick:()=>h(y.id),children:"Supprimer"})]})})]},y.id))})]}),e.jsx($e,{open:a,onOpenChange:i,children:e.jsxs(ze,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:c==="edit"?"Modifier le modèle":"Dupliquer le modèle"}),e.jsx(He,{children:c==="edit"?"Modifiez les détails de votre modèle d'email. Le type ne peut pas être modifié.":"Créez une copie de ce modèle d'email. Vous pouvez modifier tous les champs."})]}),o&&e.jsx(tg,{mode:c,initialValues:c==="duplicate"?{type:`${o.type}_copy`,name:`${o.name} (copie)`,subject:o.subject,content:o.content}:o,onSuccess:v,onCancel:f})]})})]})},_1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!0);return x.useEffect(()=>{(async()=>{try{const i=await B.get("/email-history");i.success&&Array.isArray(i.data)?t(i.data):console.error("Erreur lors de la récupération de l'historique:",i.message)}catch(i){console.error("Erreur lors de la récupération de l'historique:",i)}finally{n(!1)}})()},[]),s?e.jsx("div",{children:"Chargement de l'historique..."}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Historique des envois"}),e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Destinataire"}),e.jsx(Q,{children:"Sujet"}),e.jsx(Q,{children:"Statut"}),e.jsx(Q,{children:"Date d'envoi"}),e.jsx(Q,{children:"Message d'erreur"})]})}),e.jsx(Ir,{children:r.map(a=>e.jsxs(Ee,{children:[e.jsx(X,{children:a.recipient}),e.jsx(X,{children:a.subject}),e.jsx(X,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${a.status==="sent"?"bg-green-100 text-green-800":a.status==="error"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a.status})}),e.jsx(X,{children:a.sent_at?new Date(a.sent_at).toLocaleString():"Non envoyé"}),e.jsx(X,{children:a.error_message||"-"})]},a.id))})]})]})},S1=({description:r,isSubmitting:t,submitLabel:s,children:n,onSubmit:a,footer:i})=>(console.log("EmailFormLayout utilisé"),e.jsxs(e.Fragment,{children:[e.jsxs(Ge,{className:"mb-6",children:[e.jsx(Pr,{className:"h-4 w-4"}),e.jsx(Ke,{children:r})]}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[n,e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(P,{type:"submit",disabled:t,children:t?"Enregistrement...":s}),i]})]})]})),N1=ct({host:me().min(1,"Le serveur SMTP est requis"),port:Wg.number().int().min(1,"Le port est requis"),username:me().min(1,"Le nom d'utilisateur est requis"),password:me().min(1,"Le mot de passe est requis"),from_email:me().email("Format d'email invalide")}),E1=()=>{const[r,t]=x.useState(!1),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(null),c={host:"",port:587,username:"",password:"",from_email:""},u=yt({resolver:It(N1),defaultValues:c,mode:"onChange"}),d=async()=>{n(!0);try{console.log("🔄 Chargement de la configuration email...");const m=await B.get("/email-config");if(!m.success){console.error("❌ Erreur lors de la récupération de la configuration:",m.message),u.reset(c);return}if(m.data){console.log("✅ Configuration trouvée:",m.data.id),i(!0),l(m.data.id);const p={host:m.data.smtp_host||"",port:m.data.smtp_port||587,username:m.data.smtp_username||"",password:m.data.smtp_password||"",from_email:m.data.from_email||""};u.reset(p)}else console.log("ℹ️ Aucune configuration trouvée, utilisation des valeurs par défaut"),i(!1),l(null),u.reset(c)}catch(m){console.error("❌ Erreur lors de la récupération de la configuration:",m),u.reset(c)}finally{n(!1)}},h=async m=>{t(!0);try{console.log("💾 Sauvegarde de la configuration...");const p={smtp_host:m.host,smtp_port:m.port,smtp_username:m.username,smtp_password:m.password,from_email:m.from_email,smtp_secure:!0,from_name:"Application Coworking",is_active:!0};let f;if(a&&o?(console.log("🔄 Mise à jour de la configuration existante..."),f=await B.put(`/email-config/${o}`,p)):(console.log("➕ Création d'une nouvelle configuration..."),f=await B.post("/email-config",p),f.success&&f.data&&(l(f.data.id),i(!0))),!f.success)throw new Error(f.message||"Erreur lors de la sauvegarde");console.log("✅ Configuration sauvegardée avec succès"),k.success("Configuration email enregistrée avec succès")}catch(p){console.error("❌ Erreur lors de l'enregistrement de la configuration:",p),k.error(`Erreur: ${p.message||"Erreur lors de l'enregistrement"}`)}finally{t(!1)}};return x.useEffect(()=>{d()},[]),{form:u,isLoading:s,isSubmitting:r,configExists:a,saveConfig:h}},C1=()=>{const{form:r,isLoading:t,isSubmitting:s,configExists:n,saveConfig:a}=E1(),[i,o]=x.useState(null),[l,c]=x.useState(!1),u=async()=>{o(null),c(!0);try{const h=r.getValues().from_email,m=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:h,subject:"Test SMTP - Coworking",html:`<b>Ceci est un test SMTP depuis Coworking</b><br>Expéditeur : ${h}`})});let p={};try{p=await m.json()}catch{}if(!m.ok){o(`❌ Erreur lors de l'envoi : ${p.error||m.statusText} (code ${m.status})`);return}p.success?o("✅ Email de test envoyé avec succès !"):o(`❌ Erreur lors de l'envoi : ${p.error||m.statusText}`)}catch(d){o(`❌ Erreur lors de l'envoi : ${d.message}`)}finally{c(!1)}};return t?e.jsx("div",{children:"Chargement de la configuration..."}):e.jsx(e.Fragment,{children:e.jsx(S1,{description:"Cette configuration sera utilisée pour envoyer des emails depuis l'application. Assurez-vous que les informations SMTP sont correctes.",isSubmitting:s,submitLabel:n?"Mettre à jour":"Enregistrer",onSubmit:r.handleSubmit(a),footer:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",onClick:u,disabled:l,children:l?"Test en cours...":"Tester la connexion SMTP"}),i&&e.jsx("div",{className:"mt-2 text-sm",children:i})]}),children:e.jsxs(Ot,{...r,children:[e.jsx(Z,{control:r.control,name:"host",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Serveur SMTP"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"smtp.example.com",...d})}),e.jsx(Ie,{children:"Le nom d'hôte ou l'adresse IP du serveur SMTP."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"port",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Port SMTP"}),e.jsx(Y,{children:e.jsx(I,{type:"number",placeholder:"587",...d})}),e.jsx(Ie,{children:"Le port du serveur SMTP (généralement 25, 465 ou 587)."}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"username",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Nom d'utilisateur"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"utilisateur@exemple.com",...d})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"password",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Mot de passe"}),e.jsx(Y,{children:e.jsx(I,{type:"password",placeholder:"••••••••",...d})}),e.jsx(ee,{})]})}),e.jsx(Z,{control:r.control,name:"from_email",render:({field:d})=>e.jsxs(G,{children:[e.jsx(H,{children:"Email d'expédition"}),e.jsx(Y,{children:e.jsx(I,{placeholder:"no-reply@exemple.com",...d})}),e.jsx(Ie,{children:"L'adresse qui apparaîtra comme expéditeur des emails."}),e.jsx(ee,{})]})})]})})})},T1=()=>{const[r,t]=vn("emails","templates");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des emails"}),e.jsx("p",{className:"text-gray-500",children:"Gérez vos modèles d'emails et consultez l'historique des envois"})]})}),e.jsxs(kr,{value:r,onValueChange:t,className:"w-full",children:[e.jsxs(Dr,{className:"grid w-full grid-cols-4",children:[e.jsx(ce,{value:"templates",children:"Modèles"}),e.jsx(ce,{value:"create",children:"Nouveau modèle"}),e.jsx(ce,{value:"history",children:"Historique"}),e.jsx(ce,{value:"config",children:"Configuration"})]}),e.jsx(ge,{value:"templates",children:e.jsx(U,{className:"p-6",children:e.jsx(w1,{})})}),e.jsx(ge,{value:"create",children:e.jsxs(U,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Créer un modèle"}),e.jsx(tg,{mode:"create"})]})}),e.jsx(ge,{value:"history",children:e.jsx(U,{className:"p-6",children:e.jsx(_1,{})})}),e.jsx(ge,{value:"config",children:e.jsxs(U,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuration SMTP"}),e.jsx(C1,{})]})})]})]})},Sp=({defaultType:r})=>{const[t,s]=x.useState(!1),[n,a]=x.useState({type:r,host:"",port:r==="postgresql"?"5432":"3306",database:"",username:"",password:""}),i=(c,u)=>{a(d=>({...d,[c]:u}))},o=async()=>{s(!0);try{const{error:c}=await tt.functions.invoke("test-database-connection",{body:{config:n}});if(c)throw c;k.success("Connexion à la base de données réussie")}catch(c){console.error("Erreur de connexion:",c),k.error("Impossible de se connecter à la base de données")}finally{s(!1)}},l=async()=>{s(!0);try{const{error:c}=await tt.functions.invoke("initialize-database",{body:{config:n}});if(c)throw c;k.success("Base de données initialisée avec succès")}catch(c){console.error("Erreur d'initialisation:",c),k.error("Impossible d'initialiser la base de données")}finally{s(!1)}};return e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Configuration de la base de données"}),e.jsx(we,{children:"Configurez votre base de données pour stocker les données de l'application"})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"Type de base de données"}),e.jsxs(qp,{value:n.type,onValueChange:c=>i("type",c),className:"flex space-x-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Sr,{value:"postgresql",id:"postgresql"}),e.jsx(te,{htmlFor:"postgresql",children:"PostgreSQL"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Sr,{value:"mysql",id:"mysql"}),e.jsx(te,{htmlFor:"mysql",children:"MySQL"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"host",children:"Hôte"}),e.jsx(I,{id:"host",placeholder:"localhost",value:n.host,onChange:c=>i("host",c.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"port",children:"Port"}),e.jsx(I,{id:"port",placeholder:n.type==="postgresql"?"5432":"3306",value:n.port,onChange:c=>i("port",c.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"database",children:"Nom de la base de données"}),e.jsx(I,{id:"database",placeholder:"coworkspace",value:n.database,onChange:c=>i("database",c.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"username",children:"Nom d'utilisateur"}),e.jsx(I,{id:"username",value:n.username,onChange:c=>i("username",c.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",children:"Mot de passe"}),e.jsx(I,{id:"password",type:"password",value:n.password,onChange:c=>i("password",c.target.value)})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(P,{variant:"outline",onClick:o,disabled:t,children:"Tester la connexion"}),e.jsx(P,{onClick:l,disabled:t,children:"Initialiser la base de données"})]})]})]})},R1=()=>{const[r,t]=x.useState(!1),[s,n]=x.useState({url:"",key:""}),a=(l,c)=>{n(u=>({...u,[l]:c}))},i=async()=>{t(!0);try{const{error:l}=await tt.from("admin_settings").select("*").limit(1);if(l)throw l;k.success("Connexion Supabase réussie")}catch(l){console.error("Erreur de connexion Supabase:",l),k.error("Impossible de se connecter à Supabase")}finally{t(!1)}},o=async()=>{t(!0);try{localStorage.setItem("supabase_url",s.url),localStorage.setItem("supabase_key",s.key),k.success("Configuration Supabase sauvegardée")}catch(l){console.error("Erreur de sauvegarde:",l),k.error("Impossible de sauvegarder la configuration")}finally{t(!1)}};return e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Configuration Supabase"}),e.jsx(we,{children:"Configurez votre connexion à Supabase"})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"supabase_url",children:"URL Supabase"}),e.jsx(I,{id:"supabase_url",placeholder:"https://votre-projet.supabase.co",value:s.url,onChange:l=>a("url",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"supabase_key",children:"Clé d'API Supabase"}),e.jsx(I,{id:"supabase_key",type:"password",value:s.key,onChange:l=>a("key",l.target.value)})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(P,{variant:"outline",onClick:i,disabled:r,children:"Tester la connexion"}),e.jsx(P,{onClick:o,disabled:r,children:"Sauvegarder"})]})]})]})},A1=()=>{const[r,t]=x.useState("supabase");return e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"Base de données"}),e.jsx(we,{children:"Gérez les connexions aux bases de données et initialisez les tables nécessaires"})]}),e.jsx(W,{children:e.jsxs(kr,{value:r,onValueChange:t,children:[e.jsxs(Dr,{className:"grid w-full grid-cols-3",children:[e.jsx(ce,{value:"supabase",children:"Supabase"}),e.jsx(ce,{value:"postgresql",children:"PostgreSQL"}),e.jsx(ce,{value:"mysql",children:"MySQL"})]}),e.jsx(ge,{value:"supabase",children:e.jsx("div",{className:"mt-6",children:e.jsx(R1,{})})}),e.jsx(ge,{value:"postgresql",children:e.jsx("div",{className:"mt-6",children:e.jsx(Sp,{defaultType:"postgresql"},"postgresql")})}),e.jsx(ge,{value:"mysql",children:e.jsx("div",{className:"mt-6",children:e.jsx(Sp,{defaultType:"mysql"},"mysql")})})]})})]})},k1=()=>{const{toast:r}=Lp(),[t,s]=x.useState("idle"),[n,a]=x.useState(""),[i,o]=x.useState("test"),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[h,m]=x.useState({test_publishable_key:"",test_secret_key:"",webhook_secret:"",live_publishable_key:"",live_secret_key:"",live_webhook_secret:"",mode:"test"}),p=async()=>{try{c(!0);const b=await B.get("/admin/settings");if(b.success&&b.data){const w=(Array.isArray(b.data)?b.data:[]).find(E=>E.key==="stripe");if(w!=null&&w.value){const E=w.value;m({test_publishable_key:E.test_publishable_key||"",test_secret_key:E.test_secret_key||"",webhook_secret:E.webhook_secret||"",live_publishable_key:E.live_publishable_key||"",live_secret_key:E.live_secret_key||"",live_webhook_secret:E.live_webhook_secret||"",mode:E.mode||"test"})}}}catch(b){console.error("Erreur inattendue:",b)}finally{c(!1)}},f=async()=>{try{c(!0);const b=await B.post("/admin/settings",{key:"stripe",value:JSON.stringify(h)});if(b.success)r({title:"Succès",description:"Les paramètres Stripe ont été mis à jour avec succès"});else throw new Error(b.error||"Erreur de sauvegarde")}catch(b){console.error("Erreur sauvegarde:",b),r({variant:"destructive",title:"Erreur",description:"Une erreur est survenue lors de la sauvegarde"})}finally{c(!1)}},v=(b,N)=>{m(w=>({...w,[b]:N}))};x.useEffect(()=>{p()},[]);const y=async b=>{b.preventDefault();try{r({title:"Information",description:"Les clés API Stripe doivent être configurées dans les variables d'environnement"}),r({title:"Instructions",description:"Ajoutez VITE_STRIPE_PUBLISHABLE_KEY dans .env.local et STRIPE_SECRET_KEY dans les variables d'environnement Supabase",duration:5e3}),await f()}catch{r({variant:"destructive",title:"Erreur",description:"Une erreur est survenue lors de la sauvegarde"})}},j=async b=>{d(!0);try{const{error:N}=await supabase.from("admin_settings").update({value:{...h,mode:b}}).eq("key","stripe");N?r({variant:"destructive",title:"Erreur",description:`Impossible de basculer en mode ${b}`}):(m(w=>({...w,mode:b})),r({title:"Mode Stripe mis à jour",description:`Le mode Stripe est maintenant : ${b==="live"?"Production":"Test"}`,duration:3e3}),setTimeout(()=>{window.location.reload()},3e3))}catch{r({variant:"destructive",title:"Erreur",description:"Erreur inattendue lors du changement de mode"})}finally{d(!1)}},g=async b=>{s("loading"),a("");try{const N=b==="live"?h.live_secret_key:h.test_secret_key;if(!N){s("error"),a("Veuillez entrer la clé secrète Stripe avant de tester la connexion.");return}const E=await(await fetch("https://exffryodynkyizbeesbt.functions.supabase.co/stripe-public-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secretKey:N})})).json();E.success?(s("success"),a(`Connexion à Stripe (${b==="live"?"production":"test"}) réussie ! Compte : ${E.account.id}`)):(s("error"),a(`Erreur Stripe : ${E.error}`))}catch(N){s("error"),a("Erreur lors du test de connexion à Stripe."),console.error("Error testing Stripe connection:",N)}},_=()=>{m(b=>({...b,test_publishable_key:"",test_secret_key:"",webhook_secret:""}))};return e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Op,{className:"h-6 w-6"}),"Configuration des paiements"]}),e.jsx(we,{children:"Configurez les informations de votre passerelle de paiement"})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(fe,{color:h.mode==="live"?"green":"yellow",children:h.mode==="live"?"Production":"Test"}),e.jsx(P,{variant:h.mode==="test"?"default":"outline",onClick:()=>j("test"),disabled:u,children:"Mode Test"}),e.jsx(P,{variant:h.mode==="live"?"default":"outline",onClick:()=>j("live"),className:"ml-2",disabled:u,children:"Mode Production"}),e.jsx(P,{variant:"secondary",onClick:()=>g("test"),className:"ml-4",children:"Tester la connexion Test"}),e.jsx(P,{variant:"secondary",onClick:()=>g("live"),className:"ml-2",children:"Tester la connexion Production"})]}),t==="success"&&e.jsxs(Ge,{className:"bg-green-50 border-green-200",children:[e.jsx(Ct,{className:"h-4 w-4 text-green-600"}),e.jsx(st,{className:"text-green-800",children:"Connexion réussie"}),e.jsx(Ke,{className:"text-green-700",children:n})]}),t==="error"&&e.jsxs(Ge,{variant:"destructive",children:[e.jsx(Pr,{className:"h-4 w-4"}),e.jsx(st,{children:"Erreur de connexion"}),e.jsx(Ke,{children:n})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs(kr,{value:i,onValueChange:b=>o(b),children:[e.jsxs(Dr,{className:"grid w-full grid-cols-2",children:[e.jsx(ce,{value:"test",children:"Mode Test"}),e.jsx(ce,{value:"live",className:"text-foreground",children:"Mode Production"})]}),e.jsx(ge,{value:"test",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Clé Publishable Test"}),e.jsx(I,{type:"text",placeholder:"pk_test_...",value:h.test_publishable_key,onChange:b=>v("test_publishable_key",b.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Clé Secrète Test"}),e.jsx(I,{type:"text",placeholder:"sk_test_...",value:h.test_secret_key,onChange:b=>v("test_secret_key",b.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Webhook Secret Test"}),e.jsx(I,{type:"text",placeholder:"whsec_...",value:h.webhook_secret,onChange:b=>v("webhook_secret",b.target.value),className:"mt-2"})]})]})}),e.jsxs(ge,{value:"live",className:"space-y-4 mt-4",children:[e.jsxs(Ge,{children:[e.jsx(st,{children:"Mode Production"}),e.jsx(Ke,{children:"Attention : En mode production, des frais réels seront facturés aux clients. Assurez-vous que votre configuration est correcte."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Clé Publishable Live"}),e.jsx(I,{type:"text",placeholder:"pk_live_...",value:h.live_publishable_key,onChange:b=>v("live_publishable_key",b.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Clé Secrète Live"}),e.jsx(I,{type:"text",placeholder:"sk_live_...",value:h.live_secret_key,onChange:b=>v("live_secret_key",b.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Webhook Secret Live"}),e.jsx(I,{type:"text",placeholder:"whsec_...",value:h.live_webhook_secret,onChange:b=>v("live_webhook_secret",b.target.value),className:"mt-2"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[e.jsx(P,{type:"button",variant:"secondary",onClick:_,children:"Réinitialiser les clés de test"}),e.jsx(P,{type:"submit",disabled:l,children:l?"Sauvegarde...":"Sauvegarder la configuration"})]})]})]})]})},D1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!0),[a,i]=x.useState(!1),[o,l]=x.useState(""),[c,u]=x.useState("all"),[d,h]=x.useState("all"),[m,p]=x.useState(!1),[f,v]=x.useState(!1),[y,j]=x.useState(!1),[g,_]=x.useState(!1),[b,N]=x.useState(null),[w,E]=x.useState({title:"",content:"",type:"custom",is_active:!0}),S=async()=>{try{n(!0);const M=await B.get("/legal-pages");M.success&&Array.isArray(M.data)?t(M.data):(console.error("Erreur lors du chargement des pages:",M.error),k.error("Erreur lors du chargement des pages légales"))}catch(M){console.error("Erreur lors du chargement des pages:",M),k.error("Erreur lors du chargement des pages légales")}finally{n(!1)}},C=async()=>{try{i(!0);const M=await B.post("/legal-pages",w);M.success?(k.success("Page légale créée avec succès"),p(!1),E({title:"",content:"",type:"custom",is_active:!0}),await S()):k.error(M.error||"Erreur lors de la création")}catch(M){console.error("Erreur lors de la création:",M),k.error("Erreur lors de la création de la page")}finally{i(!1)}},D=async()=>{if(b)try{i(!0);const M=await B.put(`/legal-pages/${b.id}`,w);M.success?(k.success("Page légale modifiée avec succès"),v(!1),N(null),E({title:"",content:"",type:"custom",is_active:!0}),await S()):k.error(M.error||"Erreur lors de la modification")}catch(M){console.error("Erreur lors de la modification:",M),k.error("Erreur lors de la modification de la page")}finally{i(!1)}},R=async()=>{if(b)try{i(!0);const M=await B.delete(`/legal-pages/${b.id}`);M.success?(k.success("Page légale supprimée avec succès"),j(!1),N(null),await S()):k.error(M.error||"Erreur lors de la suppression")}catch(M){console.error("Erreur lors de la suppression:",M),k.error("Erreur lors de la suppression de la page")}finally{i(!1)}},O=async M=>{try{i(!0);const F=await B.put(`/legal-pages/${M.id}`,{...M,is_archived:!M.is_archived});F.success?(k.success(M.is_archived?"Page désarchivée":"Page archivée"),await S()):k.error(F.error||"Erreur lors de l'archivage")}catch(F){console.error("Erreur lors de l'archivage:",F),k.error("Erreur lors de l'archivage de la page")}finally{i(!1)}},T=async M=>{try{i(!0);const F=await B.put(`/legal-pages/${M.id}`,{...M,is_active:!M.is_active});F.success?(k.success(M.is_active?"Page désactivée":"Page activée"),await S()):k.error(F.error||"Erreur lors du changement de statut")}catch(F){console.error("Erreur lors du changement de statut:",F),k.error("Erreur lors du changement de statut")}finally{i(!1)}},q=M=>{N(M),E({title:M.title,content:M.content,type:M.type,is_active:M.is_active}),v(!0)},$=M=>{N(M),j(!0)},z=M=>{N(M),_(!0)},J=r.filter(M=>{const F=M.title.toLowerCase().includes(o.toLowerCase())||M.content.toLowerCase().includes(o.toLowerCase()),de=c==="all"||M.type===c,re=d==="all"||d==="active"&&M.is_active&&!M.is_archived||d==="inactive"&&!M.is_active&&!M.is_archived||d==="archived"&&M.is_archived;return F&&de&&re});x.useEffect(()=>{S()},[]);const ne=M=>{switch(M){case"terms":return"Conditions Générales";case"privacy":return"Politique de Confidentialité";case"legal":return"Mentions Légales";case"custom":return"Page Personnalisée";default:return M}},le=M=>new Date(M).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?e.jsx("div",{className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(V,{children:"Gestion des Pages Légales"})}),e.jsx(W,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Chargement des pages légales..."})]})})})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-5 w-5"}),"Gestion des Pages Légales"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Créez, modifiez et gérez les pages légales de votre site"})]}),e.jsxs(P,{onClick:()=>p(!0),className:"flex items-center gap-2",children:[e.jsx(Rr,{className:"h-4 w-4"}),"Nouvelle Page"]})]})}),e.jsxs(W,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ix,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(I,{placeholder:"Rechercher dans les pages...",value:o,onChange:M=>l(M.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nr,{value:c,onValueChange:u,children:[e.jsx(Er,{className:"w-48",children:e.jsx(Cr,{placeholder:"Type de page"})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"all",children:"Tous les types"}),e.jsx(pe,{value:"terms",children:"Conditions Générales"}),e.jsx(pe,{value:"privacy",children:"Politique de Confidentialité"}),e.jsx(pe,{value:"legal",children:"Mentions Légales"}),e.jsx(pe,{value:"custom",children:"Pages Personnalisées"})]})]}),e.jsxs(Nr,{value:d,onValueChange:h,children:[e.jsx(Er,{className:"w-48",children:e.jsx(Cr,{placeholder:"Statut"})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"all",children:"Tous les statuts"}),e.jsx(pe,{value:"active",children:"Actives"}),e.jsx(pe,{value:"inactive",children:"Inactives"}),e.jsx(pe,{value:"archived",children:"Archivées"})]})]})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Mr,{children:[e.jsx(Or,{children:e.jsxs(Ee,{children:[e.jsx(Q,{children:"Titre"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Statut"}),e.jsx(Q,{children:"Dernière modification"}),e.jsx(Q,{children:"Auteur"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Ir,{children:J.length===0?e.jsx(Ee,{children:e.jsx(X,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"Aucune page trouvée"})}):J.map(M=>e.jsxs(Ee,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:M.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[M.content.substring(0,100),"..."]})]})]})}),e.jsx(X,{children:e.jsx(fe,{variant:"outline",children:ne(M.type)})}),e.jsx(X,{children:e.jsxs("div",{className:"flex gap-1",children:[M.is_active?e.jsxs(fe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(nt,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(fe,{variant:"secondary",children:[e.jsx(Js,{className:"h-3 w-3 mr-1"}),"Inactive"]}),M.is_archived&&e.jsxs(fe,{variant:"outline",className:"border-orange-200 text-orange-800",children:[e.jsx(Xc,{className:"h-3 w-3 mr-1"}),"Archivée"]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(gr,{className:"h-4 w-4"}),le(M.updated_at)]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ot,{className:"h-4 w-4"}),M.author_name||"Système"]})}),e.jsx(X,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>z(M),title:"Prévisualiser",children:e.jsx(nt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>q(M),title:"Modifier",children:e.jsx(xt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>T(M),title:M.is_active?"Désactiver":"Activer",children:M.is_active?e.jsx(Js,{className:"h-4 w-4"}):e.jsx(nt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>O(M),title:M.is_archived?"Désarchiver":"Archiver",children:M.is_archived?e.jsx(Gg,{className:"h-4 w-4"}):e.jsx(Xc,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>$(M),title:"Supprimer",className:"text-red-600 hover:text-red-700",children:e.jsx(mr,{className:"h-4 w-4"})})]})})]},M.id))})]})})]})]}),e.jsx($e,{open:m,onOpenChange:p,children:e.jsxs(ze,{className:"max-w-2xl",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Créer une nouvelle page légale"}),e.jsx(He,{children:"Remplissez les informations pour créer une nouvelle page légale."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Titre"}),e.jsx(I,{value:w.title,onChange:M=>E({...w,title:M.target.value}),placeholder:"Titre de la page"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Type"}),e.jsxs(Nr,{value:w.type,onValueChange:M=>E({...w,type:M}),children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"terms",children:"Conditions Générales"}),e.jsx(pe,{value:"privacy",children:"Politique de Confidentialité"}),e.jsx(pe,{value:"legal",children:"Mentions Légales"}),e.jsx(pe,{value:"custom",children:"Page Personnalisée"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Contenu"}),e.jsx(_e,{value:w.content,onChange:M=>E({...w,content:M.target.value}),placeholder:"Contenu de la page (HTML autorisé)",rows:10})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:w.is_active,onChange:M=>E({...w,is_active:M.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium",children:"Page active"})]})]}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:()=>p(!1),children:"Annuler"}),e.jsx(P,{onClick:C,disabled:a,children:a?"Création...":"Créer"})]})]})}),e.jsx($e,{open:f,onOpenChange:v,children:e.jsxs(ze,{className:"max-w-2xl",children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Modifier la page légale"}),e.jsx(He,{children:"Modifiez les informations de la page légale."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Titre"}),e.jsx(I,{value:w.title,onChange:M=>E({...w,title:M.target.value}),placeholder:"Titre de la page"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Type"}),e.jsxs(Nr,{value:w.type,onValueChange:M=>E({...w,type:M}),children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsxs(Tr,{children:[e.jsx(pe,{value:"terms",children:"Conditions Générales"}),e.jsx(pe,{value:"privacy",children:"Politique de Confidentialité"}),e.jsx(pe,{value:"legal",children:"Mentions Légales"}),e.jsx(pe,{value:"custom",children:"Page Personnalisée"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Contenu"}),e.jsx(_e,{value:w.content,onChange:M=>E({...w,content:M.target.value}),placeholder:"Contenu de la page (HTML autorisé)",rows:10})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"is_active_edit",checked:w.is_active,onChange:M=>E({...w,is_active:M.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_active_edit",className:"text-sm font-medium",children:"Page active"})]})]}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:()=>v(!1),children:"Annuler"}),e.jsx(P,{onClick:D,disabled:a,children:a?"Sauvegarde...":"Sauvegarder"})]})]})}),e.jsx($e,{open:y,onOpenChange:j,children:e.jsxs(ze,{children:[e.jsxs(Ue,{children:[e.jsx(Be,{children:"Supprimer la page légale"}),e.jsx(He,{children:"Cette action est irréversible. La page sera définitivement supprimée."})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer la page ",e.jsxs("strong",{children:['"',b==null?void 0:b.title,'"']})," ?"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Cette action est irréversible."})]}),e.jsxs(rt,{children:[e.jsx(P,{variant:"outline",onClick:()=>j(!1),children:"Annuler"}),e.jsx(P,{variant:"destructive",onClick:R,disabled:a,children:a?"Suppression...":"Supprimer"})]})]})}),e.jsx($e,{open:g,onOpenChange:_,children:e.jsxs(ze,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Ue,{children:[e.jsxs(Be,{children:["Prévisualisation - ",b==null?void 0:b.title]}),e.jsx(He,{children:"Aperçu du contenu de la page légale."})]}),e.jsx("div",{className:"py-4",children:b&&e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:b.content}})})}),e.jsx(rt,{children:e.jsx(P,{variant:"outline",onClick:()=>_(!1),children:"Fermer"})})]})})]})},P1=()=>e.jsx(D1,{});class et{static async getTickets(){try{console.log("🔍 AdminSupportService: Utilisation de l'endpoint temporaire /admin/support/tickets-no-auth");const t=await fetch("http://localhost:5000/api/admin/support/tickets-no-auth",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();if(console.log("📝 Tickets API admin:",s),!s.success)throw new Error(s.error||"Erreur lors de la récupération des tickets");return s.data||[]}catch(t){throw console.error("Erreur récupération tickets admin:",t),t}}static async getTicketResponses(t){try{console.log("🔍 AdminSupportService: Utilisation de l'endpoint temporaire /admin/support/tickets/:id/responses-no-auth"),console.log("📝 Ticket ID:",t);const s=await fetch(`http://localhost:5000/api/admin/support/tickets/${t}/responses-no-auth`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();if(console.log("📝 Réponses ticket API admin:",n),!n.success)throw new Error(n.error||"Erreur lors de la récupération des réponses");return n.data||[]}catch(s){throw console.error("Erreur récupération réponses ticket admin:",s),s}}static async addTicketResponse(t,s){try{console.log("🔍 AdminSupportService: Utilisation de l'endpoint temporaire /admin/support/tickets/:id/responses-no-auth"),console.log("📝 Données envoyées:",{ticketId:t,message:s});const n=await fetch(`http://localhost:5000/api/admin/support/tickets/${t}/responses-no-auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const a=await n.json();if(console.log("📝 Réponse admin ajoutée API:",a),!a.success)throw new Error(a.error||"Erreur lors de l'ajout de la réponse");return a.data}catch(n){throw console.error("Erreur ajout réponse admin:",n),n}}static async getKBArticles(){try{console.log("🔍 AdminSupportService: Récupération des articles de la base de connaissances");const t=await fetch("http://localhost:5000/api/admin/support/kb-articles",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();if(console.log("📝 Articles KB API admin:",s),!s.success)throw new Error(s.error||"Erreur lors de la récupération des articles");return s.data||[]}catch(t){throw console.error("Erreur récupération articles KB admin:",t),t}}static async getFAQs(){try{console.log("🔍 AdminSupportService: Récupération des FAQ");const t=await fetch("http://localhost:5000/api/admin/support/faqs",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();if(console.log("📝 FAQ API admin:",s),!s.success)throw new Error(s.error||"Erreur lors de la récupération des FAQ");return s.data||[]}catch(t){throw console.error("Erreur récupération FAQ admin:",t),t}}}const Jt=({channelName:r,table:t,event:s,onMessage:n,onError:a,onStatusChange:i,retryAttempts:o=3,retryDelay:l=2e3})=>{const c=x.useRef(null),u=x.useRef(!1),d=x.useRef(0),h=x.useRef(null),m=x.useCallback(()=>{if(h.current&&(clearTimeout(h.current),h.current=null),c.current){try{tt.removeChannel(c.current)}catch(f){console.log(`[useRealtimeSubscription] Erreur lors du nettoyage du canal ${r}:`,f)}c.current=null}u.current=!1},[r]),p=x.useCallback(()=>{if(u.current){console.log(`[useRealtimeSubscription] Canal ${r} déjà actif, skip...`);return}m();try{if(console.log(`[useRealtimeSubscription] Création du canal ${r}...`),!gg()||!tt){console.log(`[useRealtimeSubscription] Supabase non configuré - souscription temps réel désactivée pour ${r}`),i&&i("disconnected");return}c.current=tt.channel(r,{config:{presence:{key:r}}}).on("postgres_changes",{event:s,schema:"public",table:t},f=>{console.log(`[useRealtimeSubscription] Message reçu sur ${r}:`,f),n(f)}).on("presence",{event:"sync"},()=>{console.log(`[useRealtimeSubscription] Presence sync pour ${r}`)}).on("presence",{event:"join"},({key:f,newPresences:v})=>{console.log(`[useRealtimeSubscription] Presence join pour ${r}:`,f,v)}).on("presence",{event:"leave"},({key:f,leftPresences:v})=>{console.log(`[useRealtimeSubscription] Presence leave pour ${r}:`,f,v)}).subscribe(f=>{console.log(`[useRealtimeSubscription] Statut canal ${r}:`,f),i&&i(f),f==="SUBSCRIBED"?(console.log(`[useRealtimeSubscription] ✅ Canal ${r} actif`),u.current=!0,d.current=0):f==="CHANNEL_ERROR"||f==="TIMED_OUT"?(console.error(`[useRealtimeSubscription] ❌ Erreur canal ${r}:`,f),u.current=!1,d.current<o?(d.current++,console.log(`[useRealtimeSubscription] Tentative de reconnexion ${d.current}/${o} pour ${r}...`),h.current=setTimeout(()=>{p()},l*d.current)):(console.error(`[useRealtimeSubscription] Nombre maximum de tentatives atteint pour ${r}`),a&&a(new Error(`Impossible de se connecter au canal ${r}`)))):f==="CLOSED"&&(console.log(`[useRealtimeSubscription] Canal ${r} fermé`),u.current=!1)})}catch(f){console.error(`[useRealtimeSubscription] Erreur lors de la configuration du canal ${r}:`,f),a&&a(f),u.current=!1}},[r,t,s,n,a,i,o,l,m]);return x.useEffect(()=>(console.log(`[useRealtimeSubscription] Initialisation du canal ${r}...`),h.current=setTimeout(()=>{p()},1e3),()=>{console.log(`[useRealtimeSubscription] Nettoyage du canal ${r}...`),m()}),[r,p,m]),{isSubscribed:u.current,channel:c.current,retryCount:d.current}},M1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(null),[a,i]=x.useState([]),[o,l]=x.useState(""),[c,u]=x.useState(!1),[d,h]=x.useState("open"),[m,p]=x.useState(!1),[f,v]=x.useState(null),[y,j]=x.useState(null),[g,_]=x.useState(!1),[b,N]=x.useState(!1),w=x.useRef(null),E=x.useRef(null),S=x.useCallback(async()=>{try{_(!0),v(null),console.log("[AdminSupportTickets] Chargement des tickets");const T=await et.getTickets();console.log("[AdminSupportTickets] Tickets récupérés:",T),t(T)}catch(T){console.error("[AdminSupportTickets] Erreur inattendue:",T),v(`Erreur inattendue: ${T instanceof Error?T.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{_(!1)}},[]),C=x.useCallback(async T=>{try{N(!0),v(null),console.log("[AdminSupportTickets] Chargement des réponses pour ticket:",T);const q=await et.getTicketResponses(T);console.log("[AdminSupportTickets] Réponses récupérées:",q),i(q)}catch(q){console.error("[AdminSupportTickets] Erreur inattendue:",q),v(`Erreur inattendue: ${q instanceof Error?q.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{N(!1)}},[]);x.useEffect(()=>{S()},[S]),x.useEffect(()=>{s&&C(s.id)},[s,C]);const D=async T=>{if(T.preventDefault(),!(!o.trim()||!s)){p(!0);try{v(null),console.log("[AdminSupportTickets] Envoi de réponse pour ticket:",s.id),await et.addTicketResponse(s.id,o),l(""),k.success("Réponse envoyée avec succès"),console.log("[AdminSupportTickets] Réponse envoyée avec succès");const q=await et.getTicketResponses(s.id);i(q)}catch(q){console.error("[AdminSupportTickets] Erreur inattendue lors de l'envoi de la réponse:",q),v(`Erreur inattendue: ${q instanceof Error?q.message:"Erreur inconnue"}`),k.error("Impossible d'envoyer la réponse")}finally{p(!1)}}},R=async T=>{if(s){u(!0);try{v(null),console.log("[AdminSupportTickets] Changement de statut pour ticket:",s.id,"->",T),await et.updateTicketStatus(s.id,T),h(T),k.success("Statut mis à jour avec succès"),console.log("[AdminSupportTickets] Statut mis à jour avec succès")}catch(q){console.error("[AdminSupportTickets] Erreur inattendue lors du changement de statut:",q),v(`Erreur inattendue: ${q instanceof Error?q.message:"Erreur inconnue"}`),k.error("Erreur lors du changement de statut")}finally{u(!1)}}},O=()=>f?e.jsxs(Ge,{className:"mb-4 border-red-200 bg-red-50",children:[e.jsx(Pr,{className:"h-4 w-4 text-red-600"}),e.jsxs(Ke,{className:"text-red-800",children:[e.jsx("strong",{children:"Erreur :"})," ",f,y&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"cursor-pointer text-sm",children:"Détails techniques"}),e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:JSON.stringify(y,null,2)})]})]})]}):null;return Jt({channelName:"realtime_tickets_admin",table:"support_tickets",event:"INSERT",onMessage:T=>{console.log("[AdminSupportTickets] Nouveau ticket reçu:",T.new),k.info("🎫 Nouveau ticket reçu !",{description:`Sujet: ${T.new.subject}`,duration:0,action:{label:"Voir",onClick:()=>{S()}}})},onError:T=>{console.error("[AdminSupportTickets] Erreur abonnement tickets:",T),k.error("Erreur de configuration des notifications tickets")},onStatusChange:T=>{console.log("[AdminSupportTickets] Statut abonnement tickets:",T)}}),Jt({channelName:"realtime_tickets_update_admin",table:"support_tickets",event:"UPDATE",onMessage:T=>{console.log("[AdminSupportTickets] Ticket mis à jour:",T.new),k.info("📝 Ticket mis à jour",{description:`Statut: ${T.new.status}`,duration:0,action:{label:"Actualiser",onClick:()=>{S()}}})},onError:T=>{console.error("[AdminSupportTickets] Erreur abonnement mises à jour tickets:",T)},onStatusChange:T=>{console.log("[AdminSupportTickets] Statut abonnement mises à jour tickets:",T)}}),Jt({channelName:"realtime_ticket_responses_admin",table:"support_ticket_responses",event:"INSERT",onMessage:T=>{if(console.log("[AdminSupportTickets] Nouvelle réponse reçue:",T.new),T.new.is_admin){console.log("[AdminSupportTickets] Réponse admin - pas de notification");return}k.info("💬 Nouvelle réponse utilisateur !",{description:`Ticket: ${T.new.ticket_id}`,duration:0,action:{label:"Voir",onClick:()=>{s&&T.new.ticket_id===s.id&&(console.log("[AdminSupportTickets] Rechargement des réponses pour le ticket sélectionné"),C(s.id))}}})},onError:T=>{console.error("[AdminSupportTickets] Erreur abonnement réponses:",T),k.error("Erreur de configuration des notifications réponses")},onStatusChange:T=>{console.log("[AdminSupportTickets] Statut abonnement réponses:",T)}}),Jt({channelName:s?`admin_ticket_responses_${s.id}`:"admin_ticket_responses_none",table:"support_ticket_responses",event:"INSERT",onMessage:T=>{s&&(C(s.id),w.current&&(w.current.currentTime=0,w.current.play()))}}),x.useEffect(()=>{E.current&&E.current.scrollIntoView({behavior:"smooth"})},[a]),e.jsxs("div",{className:"space-y-4",children:[O(),e.jsxs("div",{className:"flex h-[600px] border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r bg-gray-50 overflow-y-auto",children:[e.jsx("h2",{className:"p-4 font-bold text-lg",children:"Tickets"}),g?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Chargement..."})]})}):r.length===0?e.jsxs("div",{className:"p-4 text-gray-500",children:[e.jsx("p",{children:"Aucun ticket trouvé"}),e.jsx("p",{className:"text-sm mt-2",children:"Les tickets apparaîtront ici une fois créés par les utilisateurs."})]}):e.jsx("ul",{children:r.map(T=>e.jsxs("li",{className:`p-4 border-b cursor-pointer hover:bg-gray-100 ${(s==null?void 0:s.id)===T.id?"bg-gray-200":""}`,onClick:()=>{n(T),h(T.status)},children:[e.jsx("div",{className:"font-medium",children:T.subject}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:T.message}),e.jsx("div",{className:"text-xs text-blue-600 font-medium",children:T.user_email}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(T.created_at).toLocaleString("fr-FR")}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${T.status==="open"?"bg-blue-50 text-blue-700 border-blue-200":T.status==="in_progress"?"bg-yellow-50 text-yellow-700 border-yellow-200":T.status==="resolved"?"bg-green-50 text-green-700 border-green-200":"bg-gray-50 text-gray-700 border-gray-200"}`,children:T.status==="open"?"Ouvert":T.status==="in_progress"?"En cours":T.status==="resolved"?"Résolu":T.status==="closed"?"Fermé":T.status})]},T.id))})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white",children:c?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Chargement..."})]})}):s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.subject}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${d==="open"?"bg-blue-50 text-blue-700 border-blue-200":d==="in_progress"?"bg-yellow-50 text-yellow-700 border-yellow-200":d==="resolved"?"bg-green-50 text-green-700 border-green-200":"bg-gray-50 text-gray-700 border-gray-200"}`,children:d==="open"?"Ouvert":d==="in_progress"?"En cours":d==="resolved"?"Résolu":d==="closed"?"Fermé":d})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:new Date(s.created_at).toLocaleString("fr-FR")}),e.jsx("div",{className:"bg-gray-100 rounded-lg px-4 py-2 mt-2",children:e.jsx("p",{className:"whitespace-pre-wrap text-gray-700",children:s.message})}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(P,{size:"sm",variant:d==="open"?"default":"outline",onClick:()=>R("open"),children:"Ouvrir"}),e.jsx(P,{size:"sm",variant:d==="in_progress"?"default":"outline",onClick:()=>R("in_progress"),children:"En cours"}),e.jsx(P,{size:"sm",variant:d==="resolved"?"default":"outline",onClick:()=>R("resolved"),children:"Résolu"}),e.jsx(P,{size:"sm",variant:d==="closed"?"default":"outline",onClick:()=>R("closed"),children:"Fermer"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4",children:b?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Chargement des réponses..."})]})}):a.length===0?e.jsx("div",{className:"text-center text-gray-500 py-8",children:e.jsx("p",{children:"Aucune réponse pour ce ticket"})}):e.jsxs("div",{className:"my-4 space-y-3",style:{maxHeight:400,overflowY:"auto"},children:[a.map(T=>e.jsxs("div",{className:`${T.is_admin?"bg-primary text-white":"bg-gray-100"} rounded-lg px-4 py-2 ml-${T.is_admin?"0":"4"}`,children:[e.jsx("p",{className:"whitespace-pre-wrap",children:T.message}),e.jsxs("p",{className:"text-xs mt-1 text-opacity-80",children:[T.is_admin?"Support":"Utilisateur"," - ",new Date(T.created_at).toLocaleString("fr-FR")]})]},T.id)),e.jsx("div",{ref:E})]})}),e.jsxs("form",{onSubmit:D,className:"flex gap-2 mt-2",children:[e.jsx(_e,{value:o,onChange:T=>l(T.target.value),placeholder:"Votre réponse...",rows:2,className:"flex-1",disabled:m}),e.jsx(P,{type:"submit",disabled:m||!o.trim(),children:m?e.jsx(je,{className:"h-4 w-4 animate-spin"}):"Envoyer"})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{children:"Sélectionnez un ticket pour voir les détails"})})})})]}),e.jsx("audio",{ref:w,src:"/notification.mp3",preload:"auto",style:{display:"none"}})]})},El=[{value:"general",label:"Général"},{value:"reservation",label:"Réservation"},{value:"paiement",label:"Paiement"},{value:"acces",label:"Accès"},{value:"services",label:"Services"},{value:"compte",label:"Compte"},{value:"technique",label:"Technique"}],O1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!1),[a,i]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,h]=x.useState({question:"",answer:"",category:"general",order_index:0,is_active:!0}),m=x.useCallback(async()=>{n(!0),i(null);try{const g=await et.getFAQs();t(g)}catch(g){i(`Erreur inattendue: ${g instanceof Error?g.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{n(!1)}},[]);x.useEffect(()=>{m()},[m]),Jt({channelName:"realtime_faqs_admin",table:"support_faqs",event:"*",onMessage:g=>{console.log("[AdminSupportFaqs] Changement FAQ reçu:",g),k.info("📝 FAQ mise à jour",{description:"Les FAQ ont été modifiées",duration:3e3,action:{label:"Actualiser",onClick:()=>{m()}}})},onError:g=>{console.error("[AdminSupportFaqs] Erreur abonnement FAQ:",g)},onStatusChange:g=>{console.log("[AdminSupportFaqs] Statut abonnement FAQ:",g)}});const p=async g=>{if(g.preventDefault(),!d.question.trim()||!d.answer.trim()){k.error("Question et réponse obligatoires");return}n(!0);try{const{error:_}=await supabase.from("support_faqs").insert([{question:d.question.trim(),answer:d.answer.trim(),category:d.category,order_index:d.order_index,is_active:d.is_active}]);if(_){i(`Erreur lors de la création: ${_.message}`),k.error("Erreur lors de la création de la FAQ");return}k.success("✅ FAQ créée avec succès !",{description:"La nouvelle FAQ est maintenant disponible",duration:3e3}),h({question:"",answer:"",category:"general",order_index:0,is_active:!0}),u(!1),await m()}catch(_){i(`Erreur inattendue: ${_ instanceof Error?_.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{n(!1)}},f=async g=>{if(g.preventDefault(),!o||!o.question.trim()||!o.answer.trim()){k.error("Question et réponse obligatoires");return}n(!0);try{const{error:_}=await supabase.from("support_faqs").update({question:o.question.trim(),answer:o.answer.trim(),category:o.category,order_index:o.order_index,is_active:o.is_active}).eq("id",o.id);if(_){i(`Erreur lors de la mise à jour: ${_.message}`),k.error("Erreur lors de la mise à jour de la FAQ");return}k.success("✅ FAQ mise à jour avec succès !",{description:"Les modifications ont été enregistrées",duration:3e3}),l(null),await m()}catch(_){i(`Erreur inattendue: ${_ instanceof Error?_.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{n(!1)}},v=async g=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette FAQ ?")){n(!0);try{const{error:_}=await supabase.from("support_faqs").delete().eq("id",g);if(_){i(`Erreur lors de la suppression: ${_.message}`),k.error("Erreur lors de la suppression de la FAQ");return}k.success("🗑️ FAQ supprimée avec succès !",{description:"La FAQ a été définitivement supprimée",duration:3e3}),await m()}catch(_){i(`Erreur inattendue: ${_ instanceof Error?_.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{n(!1)}}},y=async g=>{n(!0);try{const{error:_}=await supabase.from("support_faqs").update({is_active:!g.is_active}).eq("id",g.id);if(_){i(`Erreur lors du changement de statut: ${_.message}`),k.error("Erreur lors du changement de statut");return}k.success(`✅ FAQ ${g.is_active?"désactivée":"activée"} !`,{description:`La FAQ est maintenant ${g.is_active?"invisible":"visible"} pour les utilisateurs`,duration:3e3}),await m()}catch(_){i(`Erreur inattendue: ${_ instanceof Error?_.message:"Erreur inconnue"}`),k.error("Erreur inattendue")}finally{n(!1)}},j=()=>a?e.jsxs(Ge,{className:"mb-4 border-red-200 bg-red-50",children:[e.jsx(Pr,{className:"h-4 w-4 text-red-600"}),e.jsxs(Ke,{className:"text-red-800",children:[e.jsx("strong",{children:"Erreur :"})," ",a]})]}):null;return e.jsxs("div",{className:"space-y-4",children:[j(),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des FAQ"}),e.jsx("p",{className:"text-gray-600",children:"Gérez les questions fréquemment posées"})]}),e.jsxs(P,{onClick:()=>u(!0),className:"flex items-center gap-2",disabled:s,children:[e.jsx(Rr,{className:"h-4 w-4"}),"Nouvelle FAQ"]})]}),c&&e.jsxs(U,{className:"border-blue-200 bg-blue-50",children:[e.jsxs(K,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Kc,{className:"h-5 w-5"}),"Nouvelle FAQ"]}),e.jsx(we,{children:"Créez une nouvelle question fréquemment posée"})]}),e.jsx(W,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Question"}),e.jsx(I,{value:d.question,onChange:g=>h({...d,question:g.target.value}),placeholder:"Votre question...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Catégorie"}),e.jsx("select",{value:d.category,onChange:g=>h({...d,category:g.target.value}),className:"w-full p-2 border rounded-md",children:El.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Réponse"}),e.jsx(_e,{value:d.answer,onChange:g=>h({...d,answer:g.target.value}),placeholder:"Votre réponse...",rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Ordre d'affichage"}),e.jsx(I,{type:"number",value:d.order_index,onChange:g=>h({...d,order_index:parseInt(g.target.value)||0}),min:"0"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"new-active",checked:d.is_active,onChange:g=>h({...d,is_active:g.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"new-active",className:"text-sm font-medium",children:"FAQ active (visible pour les utilisateurs)"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{type:"submit",disabled:s,children:s?e.jsx(je,{className:"h-4 w-4 animate-spin"}):"Créer la FAQ"}),e.jsxs(P,{type:"button",variant:"outline",onClick:()=>u(!1),disabled:s,children:[e.jsx(or,{className:"h-4 w-4"}),"Annuler"]})]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(V,{children:["FAQ existantes (",r.length,")"]}),e.jsx(we,{children:"Gérez les questions et réponses disponibles pour les utilisateurs"})]}),e.jsx(W,{children:s?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Chargement des FAQ..."})]})}):r.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(Kc,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Aucune FAQ trouvée"}),e.jsx("p",{className:"text-sm mt-2",children:"Créez votre première FAQ pour aider les utilisateurs."})]}):e.jsx("div",{className:"space-y-4",children:r.map(g=>{var _;return e.jsx("div",{className:"border rounded-lg p-4",children:(o==null?void 0:o.id)===g.id?e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Question"}),e.jsx(I,{value:o.question,onChange:b=>l({...o,question:b.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Catégorie"}),e.jsx("select",{value:o.category,onChange:b=>l({...o,category:b.target.value}),className:"w-full p-2 border rounded-md",children:El.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Réponse"}),e.jsx(_e,{value:o.answer,onChange:b=>l({...o,answer:b.target.value}),rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Ordre d'affichage"}),e.jsx(I,{type:"number",value:o.order_index,onChange:b=>l({...o,order_index:parseInt(b.target.value)||0}),min:"0"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`active-${g.id}`,checked:o.is_active,onChange:b=>l({...o,is_active:b.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:`active-${g.id}`,className:"text-sm font-medium",children:"FAQ active"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{type:"submit",disabled:s,children:[s?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsx(Ql,{className:"h-4 w-4"}),"Sauvegarder"]}),e.jsxs(P,{type:"button",variant:"outline",onClick:()=>l(null),disabled:s,children:[e.jsx(or,{className:"h-4 w-4"}),"Annuler"]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:g.question}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.is_active?"Active":"Inactive"}),e.jsx("span",{className:"text-xs text-gray-500",children:((_=El.find(b=>b.value===g.category))==null?void 0:_.label)||g.category}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Ordre: ",g.order_index]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{size:"sm",variant:"outline",onClick:()=>l(g),disabled:s,children:e.jsx(xt,{className:"h-4 w-4"})}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>y(g),disabled:s,children:g.is_active?"Désactiver":"Activer"}),e.jsx(P,{size:"sm",variant:"destructive",onClick:()=>v(g.id),disabled:s,children:e.jsx(mr,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"bg-gray-50 rounded p-3",children:e.jsx("p",{className:"whitespace-pre-wrap text-gray-700",children:g.answer})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Créée le ",new Date(g.created_at).toLocaleDateString("fr-FR"),g.updated_at!==g.created_at&&` • Modifiée le ${new Date(g.updated_at).toLocaleDateString("fr-FR")}`]})]})},g.id)})})})]})]})},Cl=[{value:"general",label:"Général"},{value:"utilisation",label:"Utilisation"},{value:"tarifs",label:"Tarifs"},{value:"technique",label:"Technique"},{value:"services",label:"Services"},{value:"autre",label:"Autre"}],Np=({onImageChange:r,imagePreview:t})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{id:"imageUpload",type:"file",accept:"image/*",onChange:r,className:"cursor-pointer"}),t&&e.jsx("div",{className:"relative w-full h-40 rounded-md overflow-hidden border",children:e.jsx("img",{src:t,alt:"Prévisualisation",className:"w-full h-full object-cover"})})]}),I1=()=>{const[r,t]=x.useState([]),[s,n]=x.useState(!1),[a,i]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,h]=x.useState({title:"",content:"",category:"general",order_index:0,is_active:!0}),[m,p]=x.useState(!1),[f,v]=x.useState(null),y=x.useCallback(async()=>{n(!0),i(null);try{console.log("[AdminSupportKnowledgeBase] Chargement des articles...");const w=await et.getKBArticles();console.log("[AdminSupportKnowledgeBase] Articles chargés:",(w==null?void 0:w.length)||0),t(w||[])}catch(w){console.error("[AdminSupportKnowledgeBase] Erreur inattendue:",w),i(w instanceof Error?w.message:"Erreur inconnue"),k.error("Erreur inattendue")}finally{n(!1)}},[]);x.useEffect(()=>{y()},[y]);const j=async w=>{if(w.preventDefault(),!d.title.trim()||!d.content.trim()){k.error("Titre et contenu obligatoires");return}n(!0);try{console.log("[AdminSupportKnowledgeBase] Création article:",d);const E=await B.post("/admin/support/kb-articles",{...d,title:d.title.trim(),content:d.content.trim()});if(!E.success){console.error("[AdminSupportKnowledgeBase] Erreur création:",E.error),i(E.error||"Erreur lors de la création"),k.error("Erreur lors de la création");return}k.success("Article créé avec succès"),u(!1),h({title:"",content:"",category:"general",order_index:0,is_active:!0}),await y()}catch(E){console.error("[AdminSupportKnowledgeBase] Erreur inattendue création:",E),i(E instanceof Error?E.message:"Erreur inconnue"),k.error("Erreur inattendue")}finally{n(!1)}},g=async w=>{if(w.preventDefault(),!o||!o.title.trim()||!o.content.trim()){k.error("Titre et contenu obligatoires");return}n(!0);try{console.log("[AdminSupportKnowledgeBase] Mise à jour article:",o.id);const E=await B.put(`/admin/support/kb-articles/${o.id}`,{title:o.title.trim(),content:o.content.trim(),category:o.category,order_index:o.order_index,is_active:o.is_active});if(!E.success){console.error("[AdminSupportKnowledgeBase] Erreur mise à jour:",E.error),i(E.error||"Erreur lors de la mise à jour"),k.error("Erreur lors de la mise à jour");return}k.success("Article mis à jour avec succès"),l(null),await y()}catch(E){console.error("[AdminSupportKnowledgeBase] Erreur inattendue mise à jour:",E),i(E instanceof Error?E.message:"Erreur inconnue"),k.error("Erreur inattendue")}finally{n(!1)}},_=async w=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet article ?")){n(!0);try{console.log("[AdminSupportKnowledgeBase] Suppression article:",w);const E=await B.delete(`/admin/support/kb-articles/${w}`);if(!E.success){console.error("[AdminSupportKnowledgeBase] Erreur suppression:",E.error),i(E.error||"Erreur lors de la suppression"),k.error("Erreur lors de la suppression");return}k.success("Article supprimé avec succès"),await y()}catch(E){console.error("[AdminSupportKnowledgeBase] Erreur inattendue suppression:",E),i(E instanceof Error?E.message:"Erreur inconnue"),k.error("Erreur inattendue")}finally{n(!1)}}},b=async w=>{n(!0);try{console.log("[AdminSupportKnowledgeBase] Changement statut article:",w.id);const E=await B.put(`/admin/support/kb-articles/${w.id}`,{is_active:!w.is_active});if(!E.success){console.error("[AdminSupportKnowledgeBase] Erreur changement statut:",E.error),i(E.error||"Erreur lors du changement de statut"),k.error("Erreur lors du changement de statut");return}k.success(`Article ${w.is_active?"désactivé":"activé"} avec succès`),await y()}catch(E){console.error("[AdminSupportKnowledgeBase] Erreur inattendue changement statut:",E),i(E instanceof Error?E.message:"Erreur inconnue"),k.error("Erreur inattendue")}finally{n(!1)}},N=async(w,E=!1)=>{var C;const S=(C=w.target.files)==null?void 0:C[0];if(S){p(!0);try{const D=S.name.split(".").pop(),O=`${Date.now()}-${Math.random().toString(36).substring(2,8)}.${D}`,T=createStorageClient(),{error:q}=await T.storage.from("kb-articles").upload(O,S,{upsert:!0});if(q){k.error("Erreur lors de l'upload de l'image"),p(!1);return}const{data:$}=T.storage.from("kb-articles").getPublicUrl(O);if(!($!=null&&$.publicUrl)){k.error("Impossible de récupérer l'URL de l'image"),p(!1);return}v($.publicUrl);const z=`![image](${$.publicUrl})`;E&&o?l({...o,content:o.content+`
`+z}):E||h({...d,content:d.content+`
`+z}),k.success("Image uploadée et insérée dans le contenu")}catch{k.error("Erreur inattendue lors de l'upload")}finally{p(!1)}}};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ir,{className:"h-6 w-6"})," Base de connaissances"]})}),e.jsxs(U,{className:"border-red-200 bg-red-50",children:[e.jsx(K,{children:e.jsx(V,{className:"text-red-800",children:"Erreur de chargement"})}),e.jsxs(W,{children:[e.jsx("p",{className:"text-red-700 mb-4",children:a}),e.jsx(P,{onClick:y,disabled:s,children:s?e.jsx(je,{className:"h-4 w-4 animate-spin"}):"Réessayer"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ir,{className:"h-6 w-6"})," Base de connaissances"]}),e.jsxs(P,{onClick:()=>{u(!0),l(null)},disabled:s,children:[e.jsx(Rr,{className:"h-4 w-4 mr-2"}),"Nouvel article"]})]}),c&&e.jsxs(U,{className:"mb-4 border-blue-200 bg-blue-50",children:[e.jsx(K,{children:e.jsx(V,{className:"text-blue-800",children:"Nouvel article"})}),e.jsx(W,{children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre *"}),e.jsx(I,{placeholder:"Titre de l'article",value:d.title,onChange:w=>h({...d,title:w.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contenu *"}),e.jsx(_e,{placeholder:"Contenu de l'article (supporte le markdown)",value:d.content,onChange:w=>h({...d,content:w.target.value}),rows:8,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Catégorie"}),e.jsxs(Nr,{value:d.category,onValueChange:w=>h({...d,category:w}),children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsx(Tr,{children:Cl.map(w=>e.jsx(pe,{value:w.value,children:w.label},w.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ordre d'affichage"}),e.jsx(I,{type:"number",min:0,value:d.order_index,onChange:w=>h({...d,order_index:parseInt(w.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"new-active",checked:d.is_active,onChange:w=>h({...d,is_active:w.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"new-active",className:"text-sm font-medium",children:"Article actif"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image/GIF"}),e.jsx(Np,{onImageChange:w=>N(w,!1),imagePreview:f}),m&&e.jsx(je,{className:"h-4 w-4 animate-spin ml-2 inline"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Après upload, le markdown de l'image sera inséré automatiquement dans le contenu."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{type:"submit",disabled:s,children:s?e.jsx(je,{className:"h-4 w-4 animate-spin"}):"Créer l'article"}),e.jsxs(P,{type:"button",variant:"outline",onClick:()=>u(!1),disabled:s,children:[e.jsx(or,{className:"h-4 w-4 mr-2"}),"Annuler"]})]})]})})]}),o&&e.jsxs(U,{className:"mb-4 border-orange-200 bg-orange-50",children:[e.jsx(K,{children:e.jsx(V,{className:"text-orange-800",children:"Éditer l'article"})}),e.jsx(W,{children:e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre *"}),e.jsx(I,{placeholder:"Titre de l'article",value:o.title,onChange:w=>l({...o,title:w.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contenu *"}),e.jsx(_e,{placeholder:"Contenu de l'article (supporte le markdown)",value:o.content,onChange:w=>l({...o,content:w.target.value}),rows:8,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Catégorie"}),e.jsxs(Nr,{value:o.category,onValueChange:w=>l({...o,category:w}),children:[e.jsx(Er,{children:e.jsx(Cr,{})}),e.jsx(Tr,{children:Cl.map(w=>e.jsx(pe,{value:w.value,children:w.label},w.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ordre d'affichage"}),e.jsx(I,{type:"number",min:0,value:o.order_index,onChange:w=>l({...o,order_index:parseInt(w.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"edit-active",checked:o.is_active,onChange:w=>l({...o,is_active:w.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"edit-active",className:"text-sm font-medium",children:"Article actif"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image/GIF"}),e.jsx(Np,{onImageChange:w=>N(w,!0),imagePreview:f}),m&&e.jsx(je,{className:"h-4 w-4 animate-spin ml-2 inline"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Après upload, le markdown de l'image sera inséré automatiquement dans le contenu."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{type:"submit",disabled:s,children:s?e.jsx(je,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Ql,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]})}),e.jsxs(P,{type:"button",variant:"outline",onClick:()=>l(null),disabled:s,children:[e.jsx(or,{className:"h-4 w-4 mr-2"}),"Annuler"]})]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(V,{children:["Articles (",r.length,")"]}),e.jsx(we,{children:"Gérez les articles de la base de connaissances affichés aux utilisateurs."})]}),e.jsx(W,{children:s?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx(je,{className:"h-6 w-6 animate-spin"})}):r.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(ir,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"Aucun article trouvé"}),e.jsx("p",{className:"text-sm mt-2",children:"Ajoutez votre premier article pour aider les utilisateurs."}),e.jsxs(P,{onClick:()=>u(!0),className:"mt-4",disabled:s,children:[e.jsx(Rr,{className:"h-4 w-4 mr-2"}),"Créer le premier article"]})]}):e.jsx("div",{className:"space-y-4",children:r.map(w=>{var E;return e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:w.title}),!w.is_active&&e.jsxs(fe,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(Js,{className:"h-3 w-3"}),"Inactif"]}),w.is_active&&e.jsxs(fe,{variant:"default",className:"flex items-center gap-1",children:[e.jsx(nt,{className:"h-3 w-3"}),"Actif"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:((E=Cl.find(S=>S.value===w.category))==null?void 0:E.label)||w.category}),e.jsxs("span",{children:["Ordre: ",w.order_index]}),e.jsxs("span",{children:["Créé le ",new Date(w.created_at).toLocaleDateString("fr-FR")]}),w.updated_at!==w.created_at&&e.jsxs("span",{children:["• Modifié le ",new Date(w.updated_at).toLocaleDateString("fr-FR")]})]}),e.jsx("div",{className:"bg-gray-50 rounded p-3 text-sm text-gray-700 max-h-24 overflow-hidden",children:e.jsx("div",{className:"line-clamp-3",children:w.content})})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>l(w),disabled:s,children:[e.jsx(xt,{className:"h-4 w-4 mr-1"}),"Modifier"]}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>b(w),disabled:s,children:w.is_active?e.jsxs(e.Fragment,{children:[e.jsx(Js,{className:"h-4 w-4 mr-1"}),"Désactiver"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-4 w-4 mr-1"}),"Activer"]})}),e.jsxs(P,{size:"sm",variant:"destructive",onClick:()=>_(w.id),disabled:s,children:[e.jsx(mr,{className:"h-4 w-4 mr-1"}),"Supprimer"]})]})]})},w.id)})})})]})]})},q1=()=>{const[r,t]=x.useState("tickets");return e.jsxs(e.Fragment,{children:[e.jsxs(xg,{children:[e.jsx("title",{children:"Support Admin - CoWorkMy"}),e.jsx("meta",{name:"description",content:"Interface d'administration pour gérer les tickets de support utilisateur."})]}),e.jsx("main",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Gestion du support"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Gérez les conversations, tickets et la base de connaissances de vos utilisateurs."}),e.jsxs(U,{className:"mb-8",children:[e.jsxs(K,{className:"pb-2",children:[e.jsx(V,{children:"Support"}),e.jsx(we,{children:"Outils de gestion du support client en temps réel."})]}),e.jsx(W,{children:e.jsxs(kr,{value:r,onValueChange:t,className:"w-full",children:[e.jsxs(Dr,{className:"mb-6 w-full grid grid-cols-4",children:[e.jsx(ce,{value:"tickets",children:"Tickets"}),e.jsx(ce,{value:"faq",children:"FAQ"}),e.jsx(ce,{value:"kb",children:"Base de connaissances"})]}),e.jsx(ge,{value:"tickets",children:e.jsx(M1,{})}),e.jsx(ge,{value:"faq",children:e.jsx(O1,{})}),e.jsx(ge,{value:"kb",children:e.jsx(I1,{})})]})})]})]})})]})},uE=()=>{const[r,t]=x.useState("overview"),{user:s,loading:n,isAdmin:a}=mn(),i=()=>{switch(r){case"overview":return"Tableau de bord";case"overview-dual":return"Vue Dual (Test/Production)";case"spaces":return"Gestion des espaces";case"users":return"Gestion des utilisateurs";case"bookings":return"Gestion des réservations";case"payments":return"Gestion des paiements";case"payment-config":return"Configuration des paiements";case"timeslots":return"Gestion des créneaux horaires";case"emails":return"Gestion des emails";case"database":return"Gestion de la base de données";case"legal-pages":return"Pages légales";case"cookie-settings":return"Paramètres des cookies";case"settings":return"Paramètres";case"support":return"Support";default:return"Tableau de bord"}},o=()=>{switch(r){case"overview":return e.jsx(Zc,{});case"overview-dual":return e.jsx(Hx,{});case"spaces":return e.jsx(Zy,{});case"users":return e.jsx(ry,{});case"bookings":return e.jsx(BN,{});case"payments":return e.jsx(WN,{});case"timeslots":return e.jsx(b1,{});case"emails":return e.jsx(T1,{});case"database":return e.jsx(A1,{});case"payment-config":return e.jsx(k1,{});case"legal-pages":return e.jsx(P1,{});case"cookie-settings":return e.jsx(Ux,{});case"settings":return e.jsx(h1,{});case"support":return e.jsx(q1,{});default:return e.jsx(Zc,{})}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Chargement de l'interface d'administration..."})]})}):!s||!a?null:e.jsx($x,{title:i(),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(zx,{activeView:r,onViewChange:t}),e.jsx("div",{className:"mt-6",children:o()})]})})};export{uE as default};
