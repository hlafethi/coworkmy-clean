import{r as L,k as b,l as w,j as e,I as c,B as y,n as C,L as A,u as n}from"./index-Cce3lADS.js";import{u as F}from"./index.esm-BLo4dc4Z.js";import{F as z,a as m,b as d,c as u,d as p,e as h}from"./form-DFID5UDB.js";import{A as M}from"./AuthLayout-Dw1YRotO.js";import"./Footer-DmynJHoT.js";import"./settings-3aIIbpxO.js";import"./client-BAyFyFAZ.js";import"./useHomepageSettings-CJ86T6QY.js";import"./user-CuhW9aOA.js";import"./log-out-DywJhjMF.js";import"./useLegalPages-Cgu1k7ZV.js";function S(){const[o,x]=L.useState(!1),j=b(),{signUp:f}=w(),a=F({defaultValues:{email:"",password:"",confirmPassword:"",fullName:""}}),g=r=>{const s=/[a-z]/.test(r),i=/[A-Z]/.test(r),l=/\d/.test(r),t=r.length>=8;return s&&i&&l&&t},v=r=>{if(r.length===0)return"";if(r.length<8)return"Trop court (minimum 8 caractères)";const s=[];return/[a-z]/.test(r)||s.push("minuscule"),/[A-Z]/.test(r)||s.push("majuscule"),/\d/.test(r)||s.push("chiffre"),s.length>0?`Manque : ${s.join(", ")}`:"Mot de passe fort ✓"},N=async r=>{var s,i,l;if(!g(r.password)){n.error("Le mot de passe doit contenir au moins 8 caractères avec des majuscules, minuscules et chiffres.");return}if(r.password!==r.confirmPassword){n.error("Les mots de passe ne correspondent pas.");return}x(!0);try{const t=await f(r.email,r.password,r.fullName||r.email.split("@")[0]);t.user&&!t.error?(n.success("Compte créé avec succès ! Vous pouvez maintenant vous connecter."),j("/auth/login")):(s=t.error)!=null&&s.includes("already")||(i=t.error)!=null&&i.includes("registered")?n.error("Cette adresse email est déjà utilisée."):(l=t.error)!=null&&l.includes("Invalid email")?n.error("Adresse email invalide."):n.error(t.error||"Erreur lors de la création du compte.")}catch(t){console.error("Erreur d'inscription:",t),n.error("Erreur lors de la création du compte.")}finally{x(!1)}};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Créer un compte"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Rejoignez CoworkMy pour commencer"})]}),e.jsx(z,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(N),className:"space-y-4",children:[e.jsx(m,{control:a.control,name:"fullName",render:({field:r})=>e.jsxs(d,{children:[e.jsx(u,{children:"Nom complet (optionnel)"}),e.jsx(p,{children:e.jsx(c,{...r,placeholder:"Votre nom complet",disabled:o})}),e.jsx(h,{})]})}),e.jsx(m,{control:a.control,name:"email",rules:{required:"L'email est requis",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Adresse email invalide"}},render:({field:r})=>e.jsxs(d,{children:[e.jsx(u,{children:"Email"}),e.jsx(p,{children:e.jsx(c,{...r,type:"email",placeholder:"votre@email.com",disabled:o})}),e.jsx(h,{})]})}),e.jsx(m,{control:a.control,name:"password",rules:{required:"Le mot de passe est requis",minLength:{value:8,message:"Le mot de passe doit contenir au moins 8 caractères"}},render:({field:r})=>e.jsxs(d,{children:[e.jsx(u,{children:"Mot de passe"}),e.jsx(p,{children:e.jsx(c,{...r,type:"password",placeholder:"••••••••",disabled:o})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:v(r.value)}),e.jsx(h,{})]})}),e.jsx(m,{control:a.control,name:"confirmPassword",rules:{required:"Confirmez votre mot de passe",validate:r=>r===a.getValues("password")||"Les mots de passe ne correspondent pas"},render:({field:r})=>e.jsxs(d,{children:[e.jsx(u,{children:"Confirmer le mot de passe"}),e.jsx(p,{children:e.jsx(c,{...r,type:"password",placeholder:"••••••••",disabled:o})}),e.jsx(h,{})]})}),e.jsxs(y,{type:"submit",className:"w-full",disabled:o,children:[o&&e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Création du compte...":"Créer un compte"]})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Vous avez déjà un compte ?"," ",e.jsx(A,{to:"/auth/login",className:"text-primary hover:underline",children:"Se connecter"})]})})]})}const T=()=>e.jsx(M,{title:"Créer un compte",subtitle:"Rejoignez CoWorkMy et commencez à réserver vos espaces de travail.",children:e.jsx(S,{})});export{T as default};
